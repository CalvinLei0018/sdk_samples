/*! For license information please see sdk.js.LICENSE.txt */
module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./node_modules/asap/browser-raw.js":function(e,t,r){"use strict";(function(t){function r(e){i.length||(n(),!0),i[i.length]=e}e.exports=r;var n,i=[],o=0;function a(){for(;o<i.length;){var e=o;if(o+=1,i[e].call(),o>1024){for(var t=0,r=i.length-o;t<r;t++)i[t]=i[t+o];i.length-=o,o=0}}i.length=0,o=0,!1}var s,c,d,u=void 0!==t?t:self,p=u.MutationObserver||u.WebKitMutationObserver;function l(e){return function(){var t=setTimeout(n,0),r=setInterval(n,50);function n(){clearTimeout(t),clearInterval(r),e()}}}"function"==typeof p?(s=1,c=new p(a),d=document.createTextNode(""),c.observe(d,{characterData:!0}),n=function(){s=-s,d.data=s}):n=l(a),r.requestFlush=n,r.makeRequestCallFromTimer=l}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/bowser/es5.js":function(e,t,r){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),a=Math.max(i,o),s=0,c=e.map([t,r],(function(t){var r=a-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var s=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=o.length;t<r;t+=1)s();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){}var t,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,(r=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&a(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=c(r(92)),i=c(r(93)),o=c(r(94)),a=c(r(95)),s=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(i[t]=a,o+=1):"object"==typeof a&&(r[t]=a,n+=1)})),n>0){var a=Object.keys(r),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var d=this.satisfies(r[c]);if(void 0!==d)return d}var u=s.default.find(a,(function(e){return t.isPlatform(e)}));if(u){var p=this.satisfies(r[u]);if(void 0!==p)return p}}if(o>0){var l=Object.keys(i),f=s.default.find(l,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(s.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e){return this.isBrowser(e)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=d,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(e){var t=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return{name:o.OS_MAP.iOS,version:t}}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=a,e.exports=t.default}})},"./node_modules/immutability-helper/index.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./node_modules/invariant/browser.js"),i=Object.prototype.hasOwnProperty,o=Array.prototype.splice,a=Object.prototype.toString;function s(e){return a.call(e).slice(8,-1)}var c=Object.assign||function(e,t){return d(t).forEach((function(r){i.call(t,r)&&(e[r]=t[r])})),e},d="function"==typeof Object.getOwnPropertySymbols?function(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.keys(e)};function u(e){return Array.isArray(e)?c(e.constructor(e.length),e):"Map"===s(e)?new Map(e):"Set"===s(e)?new Set(e):e&&"object"==typeof e?c(Object.create(Object.getPrototypeOf(e)),e):e}var p=function(){function e(){this.commands=c({},l),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(e,t){return e===t},this.update.newContext=function(){return(new e).update}}return Object.defineProperty(e.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(e){this.update.isEquals=e},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this.commands[e]=t},e.prototype.update=function(e,t){var r=this,o="function"==typeof t?{$apply:t}:t;Array.isArray(e)&&Array.isArray(o)||n(!Array.isArray(o),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),n("object"==typeof o&&null!==o,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(this.commands).join(", "));var a=e;return d(o).forEach((function(t){if(i.call(r.commands,t)){var n=e===a;a=r.commands[t](o[t],a,o,e),n&&r.isEquals(a,e)&&(a=e)}else{var c="Map"===s(e)?r.update(e.get(t),o[t]):r.update(e[t],o[t]),d="Map"===s(a)?a.get(t):a[t];r.isEquals(c,d)&&(void 0!==c||i.call(e,t))||(a===e&&(a=u(e)),"Map"===s(a)?a.set(t,c):a[t]=c)}})),a},e}();t.Context=p;var l={$push:function(e,t,r){return h(t,r,"$push"),e.length?t.concat(e):t},$unshift:function(e,t,r){return h(t,r,"$unshift"),e.length?e.concat(t):t},$splice:function(e,t,r,i){return function(e,t){n(Array.isArray(e),"Expected $splice target to be an array; got %s",e),y(t.$splice)}(t,r),e.forEach((function(e){y(e),t===i&&e.length&&(t=u(i)),o.apply(t,e)})),t},$set:function(e,t,r){return function(e){n(1===Object.keys(e).length,"Cannot have more than one key in an object with $set")}(r),e},$toggle:function(e,t){m(e,"$toggle");var r=e.length?u(t):t;return e.forEach((function(e){r[e]=!t[e]})),r},$unset:function(e,t,r,n){return m(e,"$unset"),e.forEach((function(e){Object.hasOwnProperty.call(t,e)&&(t===n&&(t=u(n)),delete t[e])})),t},$add:function(e,t,r,n){return g(t,"$add"),m(e,"$add"),"Map"===s(t)?e.forEach((function(e){var r=e[0],i=e[1];t===n&&t.get(r)!==i&&(t=u(n)),t.set(r,i)})):e.forEach((function(e){t!==n||t.has(e)||(t=u(n)),t.add(e)})),t},$remove:function(e,t,r,n){return g(t,"$remove"),m(e,"$remove"),e.forEach((function(e){t===n&&t.has(e)&&(t=u(n)),t.delete(e)})),t},$merge:function(e,t,r,i){var o,a;return o=t,n((a=e)&&"object"==typeof a,"update(): $merge expects a spec of type 'object'; got %s",a),n(o&&"object"==typeof o,"update(): $merge expects a target of type 'object'; got %s",o),d(e).forEach((function(r){e[r]!==t[r]&&(t===i&&(t=u(i)),t[r]=e[r])})),t},$apply:function(e,t){var r;return n("function"==typeof(r=e),"update(): expected spec of $apply to be a function; got %s.",r),e(t)}},f=new p;function h(e,t,r){n(Array.isArray(e),"update(): expected target of %s to be an array; got %s.",r,e),m(t[r],r)}function m(e,t){n(Array.isArray(e),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",t,e)}function y(e){n(Array.isArray(e),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",e)}function g(e,t){var r=s(e);n("Map"===r||"Set"===r,"update(): %s expects a target of type Set or Map; got %s",t,r)}t.isEquals=f.update.isEquals,t.extend=f.extend,t.default=f.update,t.default.default=e.exports=c(t.default,t)},"./node_modules/invariant/browser.js":function(e,t,r){"use strict";e.exports=function(e,t,r,n,i,o,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[r,n,i,o,a,s],u=0;(c=new Error(t.replace(/%s/g,(function(){return d[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},"./node_modules/lodash.get/index.js":function(e,t,r){(function(t){var r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/,i=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,s=/^\[object .+?Constructor\]$/,c="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")();var p,l=Array.prototype,f=Function.prototype,h=Object.prototype,m=u["__core-js_shared__"],y=(p=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",g=f.toString,v=h.hasOwnProperty,E=h.toString,S=RegExp("^"+g.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_=u.Symbol,b=l.splice,T=D(u,"Map"),C=D(Object,"create"),R=_?_.prototype:void 0,A=R?R.toString:void 0;function O(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function I(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function P(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function w(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function k(e,t){for(var i,o=0,a=(t=function(e,t){if(j(e))return!1;var i=typeof e;if("number"==i||"symbol"==i||"boolean"==i||null==e||F(e))return!0;return n.test(e)||!r.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:j(i=t)?i:x(i)).length;null!=e&&o<a;)e=e[L(t[o++])];return o&&o==a?e:void 0}function M(e){return!(!B(e)||(t=e,y&&y in t))&&(function(e){var t=B(e)?E.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?S:s).test(function(e){if(null!=e){try{return g.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function N(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function D(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return M(r)?r:void 0}O.prototype.clear=function(){this.__data__=C?C(null):{}},O.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},O.prototype.get=function(e){var t=this.__data__;if(C){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return v.call(t,e)?t[e]:void 0},O.prototype.has=function(e){var t=this.__data__;return C?void 0!==t[e]:v.call(t,e)},O.prototype.set=function(e,t){return this.__data__[e]=C&&void 0===t?"__lodash_hash_undefined__":t,this},I.prototype.clear=function(){this.__data__=[]},I.prototype.delete=function(e){var t=this.__data__,r=w(t,e);return!(r<0)&&(r==t.length-1?t.pop():b.call(t,r,1),!0)},I.prototype.get=function(e){var t=this.__data__,r=w(t,e);return r<0?void 0:t[r][1]},I.prototype.has=function(e){return w(this.__data__,e)>-1},I.prototype.set=function(e,t){var r=this.__data__,n=w(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},P.prototype.clear=function(){this.__data__={hash:new O,map:new(T||I),string:new O}},P.prototype.delete=function(e){return N(this,e).delete(e)},P.prototype.get=function(e){return N(this,e).get(e)},P.prototype.has=function(e){return N(this,e).has(e)},P.prototype.set=function(e,t){return N(this,e).set(e,t),this};var x=U((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(F(e))return A?A.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}(t);var r=[];return i.test(e)&&r.push(""),e.replace(o,(function(e,t,n,i){r.push(n?i.replace(a,"$1"):t||e)})),r}));function L(e){if("string"==typeof e||F(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function U(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a),a};return r.cache=new(U.Cache||P),r}U.Cache=P;var j=Array.isArray;function B(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function F(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==E.call(e)}e.exports=function(e,t,r){var n=null==e?void 0:k(e,t);return void 0===n?r:n}}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash.omit/index.js":function(e,t,r){(function(t){var r=/^\[object .+?Constructor\]$/,n=/^(?:0|[1-9]\d*)$/,i="object"==typeof t&&t&&t.Object===Object&&t,o="object"==typeof self&&self&&self.Object===Object&&self,a=i||o||Function("return this")();function s(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function c(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,n){var i=e.length,o=r+(n?1:-1);for(;n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,l,r);var n=r-1,i=e.length;for(;++n<i;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function d(e,t,r){for(var n=-1,i=e?e.length:0;++n<i;)if(r(t,e[n]))return!0;return!1}function u(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function p(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function l(e){return e!=e}function f(e,t){return e.has(t)}function h(e,t){return function(r){return e(t(r))}}var m,y=Array.prototype,g=Function.prototype,v=Object.prototype,E=a["__core-js_shared__"],S=(m=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",_=g.toString,b=v.hasOwnProperty,T=v.toString,C=RegExp("^"+_.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=a.Symbol,A=h(Object.getPrototypeOf,Object),O=v.propertyIsEnumerable,I=y.splice,P=R?R.isConcatSpreadable:void 0,w=Object.getOwnPropertySymbols,k=Math.max,M=z(a,"Map"),N=z(Object,"create");function D(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function x(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function L(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function U(e){var t=-1,r=e?e.length:0;for(this.__data__=new L;++t<r;)this.add(e[t])}function j(e,t){var r=J(e)||K(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var o in e)!t&&!b.call(e,o)||i&&("length"==o||Y(o,n))||r.push(o);return r}function B(e,t){for(var r,n,i=e.length;i--;)if((r=e[i][0])===(n=t)||r!=r&&n!=n)return i;return-1}function F(e){return!(!ee(e)||(t=e,S&&S in t))&&(Z(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?C:r).test(function(e){if(null!=e){try{return _.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function V(e){if(!ee(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t,r,n,i=(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||v,t===n),o=[];for(var a in e)("constructor"!=a||!i&&b.call(e,a))&&o.push(a);return o}function G(e){return function(e,t,r){var n=t(e);return J(e)?n:p(n,r(e))}(e,re,H)}function q(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function z(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return F(r)?r:void 0}D.prototype.clear=function(){this.__data__=N?N(null):{}},D.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},D.prototype.get=function(e){var t=this.__data__;if(N){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return b.call(t,e)?t[e]:void 0},D.prototype.has=function(e){var t=this.__data__;return N?void 0!==t[e]:b.call(t,e)},D.prototype.set=function(e,t){return this.__data__[e]=N&&void 0===t?"__lodash_hash_undefined__":t,this},x.prototype.clear=function(){this.__data__=[]},x.prototype.delete=function(e){var t=this.__data__,r=B(t,e);return!(r<0)&&(r==t.length-1?t.pop():I.call(t,r,1),!0)},x.prototype.get=function(e){var t=this.__data__,r=B(t,e);return r<0?void 0:t[r][1]},x.prototype.has=function(e){return B(this.__data__,e)>-1},x.prototype.set=function(e,t){var r=this.__data__,n=B(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},L.prototype.clear=function(){this.__data__={hash:new D,map:new(M||x),string:new D}},L.prototype.delete=function(e){return q(this,e).delete(e)},L.prototype.get=function(e){return q(this,e).get(e)},L.prototype.has=function(e){return q(this,e).has(e)},L.prototype.set=function(e,t){return q(this,e).set(e,t),this},U.prototype.add=U.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},U.prototype.has=function(e){return this.__data__.has(e)};var W=w?h(w,Object):ae,H=w?function(e){for(var t=[];e;)p(t,W(e)),e=A(e);return t}:ae;function $(e){return J(e)||K(e)||!!(P&&e&&e[P])}function Y(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}function Q(e){if("string"==typeof e||function(e){return"symbol"==typeof e||te(e)&&"[object Symbol]"==T.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function K(e){return function(e){return te(e)&&X(e)}(e)&&b.call(e,"callee")&&(!O.call(e,"callee")||"[object Arguments]"==T.call(e))}var J=Array.isArray;function X(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!Z(e)}function Z(e){var t=ee(e)?T.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function ee(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function te(e){return!!e&&"object"==typeof e}function re(e){return X(e)?j(e,!0):V(e)}var ne,ie,oe=(ne=function(e,t){return null==e?{}:(t=u(function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=$),o||(o=[]);++a<s;){var c=t[a];r>0&&n(c)?r>1?e(c,r-1,n,i,o):p(o,c):i||(o[o.length]=c)}return o}(t,1),Q),function(e,t){return function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=e[a];r(s,a)&&(o[a]=s)}return o}(e=Object(e),t,(function(t,r){return r in e}))}(e,function(e,t,r,n){var i,o=-1,a=c,s=!0,p=e.length,l=[],h=t.length;if(!p)return l;r&&(t=u(t,(i=r,function(e){return i(e)}))),n?(a=d,s=!1):t.length>=200&&(a=f,s=!1,t=new U(t));e:for(;++o<p;){var m=e[o],y=r?r(m):m;if(m=n||0!==m?m:0,s&&y==y){for(var g=h;g--;)if(t[g]===y)continue e;l.push(m)}else a(t,y,n)||l.push(m)}return l}(G(e),t)))},ie=k(void 0===ie?ne.length-1:ie,0),function(){for(var e=arguments,t=-1,r=k(e.length-ie,0),n=Array(r);++t<r;)n[t]=e[ie+t];t=-1;for(var i=Array(ie+1);++t<ie;)i[t]=e[t];return i[ie]=n,s(ne,this,i)});function ae(){return[]}e.exports=oe}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/object-assign/index.js":function(e,t,r){"use strict";var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,s,c=a(e),d=1;d<arguments.length;d++){for(var u in r=Object(arguments[d]))i.call(r,u)&&(c[u]=r[u]);if(n){s=n(r);for(var p=0;p<s.length;p++)o.call(r,s[p])&&(c[s[p]]=r[s[p]])}}return c}},"./node_modules/performance-now/lib/performance-now.js":function(e,t,r){(function(t){(function(){var r,n,i,o,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(r()-a)/1e6},n=t.hrtime,o=(r=function(){var e;return 1e9*(e=n())[0]+e[1]})(),s=1e9*t.uptime(),a=o-s):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,r("./node_modules/process/browser.js"))},"./node_modules/process/browser.js":function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,d=[],u=!1,p=-1;function l(){u&&c&&(u=!1,c.length?d=c.concat(d):p=-1,d.length&&f())}function f(){if(!u){var e=s(l);u=!0;for(var t=d.length;t;){for(c=d,d=[];++p<t;)c&&c[p].run();p=-1,t=d.length}c=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new h(e,t)),1!==d.length||u||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/promise/lib/core.js":function(e,t,r){"use strict";var n=r("./node_modules/asap/browser-raw.js");function i(){}var o=null,a={};function s(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._h=0,this._i=0,this._j=null,this._k=null,e!==i&&f(e,this)}function c(e,t){for(;3===e._i;)e=e._j;if(s._l&&s._l(e),0===e._i)return 0===e._h?(e._h=1,void(e._k=t)):1===e._h?(e._h=2,void(e._k=[e._k,t])):void e._k.push(t);!function(e,t){n((function(){var r=1===e._i?t.onFulfilled:t.onRejected;if(null!==r){var n=function(e,t){try{return e(t)}catch(e){return o=e,a}}(r,e._j);n===a?u(t.promise,o):d(t.promise,n)}else 1===e._i?d(t.promise,e._j):u(t.promise,e._j)}))}(e,t)}function d(e,t){if(t===e)return u(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var r=function(e){try{return e.then}catch(e){return o=e,a}}(t);if(r===a)return u(e,o);if(r===e.then&&t instanceof s)return e._i=3,e._j=t,void p(e);if("function"==typeof r)return void f(r.bind(t),e)}e._i=1,e._j=t,p(e)}function u(e,t){e._i=2,e._j=t,s._m&&s._m(e,t),p(e)}function p(e){if(1===e._h&&(c(e,e._k),e._k=null),2===e._h){for(var t=0;t<e._k.length;t++)c(e,e._k[t]);e._k=null}}function l(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function f(e,t){var r=!1,n=function(e,t,r){try{e(t,r)}catch(e){return o=e,a}}(e,(function(e){r||(r=!0,d(t,e))}),(function(e){r||(r=!0,u(t,e))}));r||n!==a||(r=!0,u(t,o))}e.exports=s,s._l=null,s._m=null,s._n=i,s.prototype.then=function(e,t){if(this.constructor!==s)return function(e,t,r){return new e.constructor((function(n,o){var a=new s(i);a.then(n,o),c(e,new l(t,r,a))}))}(this,e,t);var r=new s(i);return c(this,new l(e,t,r)),r}},"./node_modules/promise/lib/es6-extensions.js":function(e,t,r){"use strict";var n=r("./node_modules/promise/lib/core.js");e.exports=n;var i=u(!0),o=u(!1),a=u(null),s=u(void 0),c=u(0),d=u("");function u(e){var t=new n(n._n);return t._i=1,t._j=e,t}n.resolve=function(e){if(e instanceof n)return e;if(null===e)return a;if(void 0===e)return s;if(!0===e)return i;if(!1===e)return o;if(0===e)return c;if(""===e)return d;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new n(t.bind(e))}catch(e){return new n((function(t,r){r(e)}))}return u(e)},n.all=function(e){var t=Array.prototype.slice.call(e);return new n((function(e,r){if(0===t.length)return e([]);var i=t.length;function o(a,s){if(s&&("object"==typeof s||"function"==typeof s)){if(s instanceof n&&s.then===n.prototype.then){for(;3===s._i;)s=s._j;return 1===s._i?o(a,s._j):(2===s._i&&r(s._j),void s.then((function(e){o(a,e)}),r))}var c=s.then;if("function"==typeof c)return void new n(c.bind(s)).then((function(e){o(a,e)}),r)}t[a]=s,0==--i&&e(t)}for(var a=0;a<t.length;a++)o(a,t[a])}))},n.reject=function(e){return new n((function(t,r){r(e)}))},n.race=function(e){return new n((function(t,r){e.forEach((function(e){n.resolve(e).then(t,r)}))}))},n.prototype.catch=function(e){return this.then(null,e)}},"./node_modules/promise/lib/rejection-tracking.js":function(e,t,r){"use strict";var n=r("./node_modules/promise/lib/core.js"),i=[ReferenceError,TypeError,RangeError],o=!1;function a(){o=!1,n._l=null,n._m=null}function s(e,t){return t.some((function(t){return e instanceof t}))}t.disable=a,t.enable=function(e){e=e||{},o&&a();o=!0;var t=0,r=0,c={};function d(t){(e.allRejections||s(c[t].error,e.whitelist||i))&&(c[t].displayId=r++,e.onUnhandled?(c[t].logged=!0,e.onUnhandled(c[t].displayId,c[t].error)):(c[t].logged=!0,function(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach((function(e){console.warn("  "+e)}))}(c[t].displayId,c[t].error)))}n._l=function(t){2===t._i&&c[t._o]&&(c[t._o].logged?function(t){c[t].logged&&(e.onHandled?e.onHandled(c[t].displayId,c[t].error):c[t].onUnhandled||(console.warn("Promise Rejection Handled (id: "+c[t].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+c[t].displayId+".")))}(t._o):clearTimeout(c[t._o].timeout),delete c[t._o])},n._m=function(e,r){0===e._h&&(e._o=t++,c[e._o]={displayId:null,error:r,timeout:setTimeout(d.bind(null,e._o),s(r,i)?100:2e3),logged:!1})}}},"./node_modules/raf/index.js":function(e,t,r){(function(t){for(var n=r("./node_modules/performance-now/lib/performance-now.js"),i="undefined"==typeof window?t:window,o=["moz","webkit"],a="AnimationFrame",s=i["request"+a],c=i["cancel"+a]||i["cancelRequest"+a],d=0;!s&&d<o.length;d++)s=i[o[d]+"Request"+a],c=i[o[d]+"Cancel"+a]||i[o[d]+"CancelRequest"+a];if(!s||!c){var u=0,p=0,l=[];s=function(e){if(0===l.length){var t=n(),r=Math.max(0,1e3/60-(t-u));u=r+t,setTimeout((function(){var e=l.slice(0);l.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(r))}return l.push({handle:++p,callback:e,cancelled:!1}),p},c=function(e){for(var t=0;t<l.length;t++)l[t].handle===e&&(l[t].cancelled=!0)}}e.exports=function(e){return s.call(i,e)},e.exports.cancel=function(){c.apply(i,arguments)},e.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=s,e.cancelAnimationFrame=c}}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/raf/polyfill.js":function(e,t,r){r("./node_modules/raf/index.js").polyfill()},"./node_modules/symbol-observable/es/index.js":function(e,t,r){"use strict";(function(e,n){var i,o=r("./node_modules/symbol-observable/es/ponyfill.js");i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(o.a)(i);t.a=a}).call(this,r("./node_modules/webpack/buildin/global.js"),r("./node_modules/webpack/buildin/harmony-module.js")(e))},"./node_modules/symbol-observable/es/ponyfill.js":function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",(function(){return n}))},"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./node_modules/webpack/buildin/harmony-module.js":function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"./node_modules/whatwg-fetch/fetch.js":function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return f})),r.d(t,"Request",(function(){return S})),r.d(t,"Response",(function(){return b})),r.d(t,"DOMException",(function(){return C})),r.d(t,"fetch",(function(){return R}));var n="URLSearchParams"in self,i="Symbol"in self&&"iterator"in Symbol,o="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in self,s="ArrayBuffer"in self;if(s)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function p(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=m(t);return t.readAsArrayBuffer(e),r}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||d(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,r,n=h(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=m(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=p(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=p(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),l(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),l(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),l(e)},i&&(f.prototype[Symbol.iterator]=f.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function S(e,t){var r,n,i=(t=t||{}).body;if(e instanceof S){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),E.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function b(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})},v.call(S.prototype),v.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];b.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};var C=self.DOMException;try{new C}catch(e){(C=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),C.prototype.constructor=C}function R(e,t){return new Promise((function(r,n){var i=new S(e,t);if(i.signal&&i.signal.aborted)return n(new C("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new b(i,n))},a.onerror=function(){n(new TypeError("Network request failed"))},a.ontimeout=function(){n(new TypeError("Network request failed"))},a.onabort=function(){n(new C("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),i.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",s)}),a.send(void 0===i._bodyInit?null:i._bodyInit)}))}R.polyfill=!0,self.fetch||(self.fetch=R,self.Headers=f,self.Request=S,self.Response=b)},"./package.json":function(e){e.exports=JSON.parse('{"name":"teevid","version":"5.2.1","description":"","main":"middleware/app.js","author":"","license":"Copyright (c) 2014 CloudAYI, Inc. All Rights Reserved.","dependencies":{"@babel/core":"^7.6.4","@babel/preset-env":"^7.6.3","@babel/runtime":"^7.6.3","@fortawesome/fontawesome-svg-core":"^1.2.25","@fortawesome/free-solid-svg-icons":"^5.11.2","@fortawesome/react-fontawesome":"^0.1.6","@material-ui/core":"^4.5.1","@material-ui/icons":"^4.5.1","@material-ui/lab":"^4.0.0-alpha.29","animejs":"^3.1.0","apidoc":"^0.17.6","autoprefixer":"^9.6.5","babel-eslint":"^10.0.3","babel-jest":"^24.9.0","babel-loader":"^8.0.6","babel-preset-env":"^1.7.0","babel-preset-react-app":"^9.0.2","base-64":"^0.1.0","bcrypt":"^3.0.6","body-parser":"^1.19.0","bowser":"^2.7.0","btoa":"^1.2.1","case-sensitive-paths-webpack-plugin":"^2.2.0","chalk":"^2.4.2","chart.js":"^2.7.2","classnames":"^2.2.5","connected-react-router":"^6.5.2","cpu-stat":"^2.0.1","css-element-queries":"^1.2.1","css-loader":"^3.2.0","decode-tiff":"^0.2.1","detectrtc":"^1.3.6","documentation":"^12.1.2","domhandler":"^3.0.0","dotenv":"^8.1.0","drachtio-srf":"^4.4.18","email-templates":"^6.0.3","eslint":"^6.5.1","eslint-config-react-app":"^5.0.2","eslint-loader":"^3.0.2","eslint-plugin-flowtype":"^4.3.0","eslint-plugin-import":"^2.18.2","eslint-plugin-jsx-a11y":"^6.2.3","eslint-plugin-react":"^7.16.0","eslint-plugin-react-hooks":"^2.1.2","express":"^4.17.1","express-useragent":"^1.0.13","fabric":"^3.5.0","file-loader":"^4.2.0","file-type":"^12.3.0","fs-extra":"^8.1.0","gaugeJS":"^1.3.7","geoip-lite":"^1.3.8","gif-engine-js":"^1.0.1","git-revision-webpack-plugin":"^3.0.3","google-translate":"^2.3.0","google-translate-api":"^2.3.0","gsap":"^2.1.3","haikunator":"^2.1.1","hark":"^1.2.3","history":"^4.10.1","html-webpack-plugin":"^4.0.0-beta.8","image-decode":"^1.2.2","immutability-helper":"^3.0.1","interactjs":"^1.7.0","is-electron":"^2.2.0","javascript-obfuscator":"^0.21.0","json-refs":"^3.0.13","jsonschema":"^1.2.5","jsonwebtoken":"^8.5.1","jszip":"^3.2.2","l20n":"^6.0.0","leaflet":"^1.5.1","libxmljs":"^0.19.7","loaders.css":"^0.1.2","lodash.clonedeep":"^4.5.0","lodash.compact":"^3.0.1","lodash.debounce":"^4.0.8","lodash.difference":"^4.5.0","lodash.filter":"^4.6.0","lodash.find":"^4.6.0","lodash.findindex":"^4.6.0","lodash.flatten":"^4.4.0","lodash.flattendeep":"^4.4.0","lodash.flow":"^3.5.0","lodash.foreach":"^4.5.0","lodash.get":"^4.4.2","lodash.includes":"^4.3.0","lodash.isarray":"^4.0.0","lodash.isequal":"^4.5.0","lodash.isobject":"^3.0.2","lodash.map":"^4.6.0","lodash.omit":"^4.5.0","lodash.sortby":"^4.7.0","lodash.toarray":"^4.4.0","lodash.uniq":"^4.5.0","lodash.values":"^4.3.0","log4js":"^5.2.2","material-ui-color-picker":"3.2.0","md5":"^2.2.1","mediaelement":"^4.2.14","microsoft-cognitiveservices-speech-sdk":"^1.12.0","mini-css-extract-plugin":"^0.8.0","moment":"^2.21.0","moment-duration-format":"^2.3.2","moment-timezone":"^0.5.26","mongodb":"^3.3.2","mongoose":"^5.7.5","ms":"^2.1.2","multer":"^1.4.2","node-mailjet":"^3.2.1","node-sass":"^4.13.0","normalizr":"^3.4.1","object-assign":"4.1.1","pngjs":"^3.4.0","postcss-flexbugs-fixes":"^4.1.0","postcss-loader":"^3.0.0","promise":"^8.0.1","prop-types":"^15.6.0","psl":"^1.8.0","raf":"^3.4.0","raw-loader":"^3.1.0","react":"^16.10.2","react-chartjs-2":"^2.7.4","react-contenteditable":"^3.2.6","react-dev-utils":"^9.1.0","react-dnd":"^9.4.0","react-dnd-html5-backend":"^9.4.0","react-dom":"^16.10.2","react-draggable":"^4.0.3","react-dropzone":"^10.1.10","react-event-listener":"^0.6.6","react-facebook-login":"^4.1.1","react-favicon":"0.0.17","react-grid-layout":"^0.16.2","react-helmet":"^5.2.1","react-hls":"0.0.8","react-l20n-u":"^0.2.0","react-leaflet":"^2.0.1","react-loaders":"^3.0.1","react-player":"^1.15.2","react-redux":"^7.1.1","react-resizable":"^1.7.5","react-router":"^5.1.2","react-router-dom":"^5.1.2","react-scripts":"2.0.3","react-select":"^3.0.8","react-svg-loader":"^3.0.3","react-transition-group":"^4.3.0","react-youtube":"^7.9.0","redux":"^4.0.4","redux-form":"^8.2.6","redux-notifications":"^4.0.1","redux-thunk":"^2.2.0","request-promise-native":"^1.0.4","reselect":"^4.0.0","sass-loader":"^8.0.0","standardized-audio-context":"^22.0.2","style-loader":"^1.0.0","svgo":"^1.3.2","sw-precache-webpack-plugin":"^0.11.5","swagger-node-express":"^2.1.3","swagger-ui-express":"^4.1.2","systeminformation":"^4.14.12","typedoc-plugin-external-module-name":"^2.0.0","typedoc-plugin-internal-external":"^2.0.2","typeface-roboto":"0.0.75","typeit":"^6.0.2","uniqid":"^5.0.3","urijs":"^1.19.1","url-loader":"^2.2.0","uuid":"^3.3.3","webpack":"^4.41.1","webpack-bundle-analyzer":"^3.5.2","webpack-cli":"^3.3.9","redux-saga":"^1.1.1","webpack-dev-server":"^3.8.2","webpack-manifest-plugin":"^2.2.0","webpack-shell-plugin":"^0.5.0","webrtc-adapter":"^7.5.1","webrtc-utilities":"^1.0.10","whatwg-fetch":"^3.0.0","worker-loader":"^2.0.0","ws":"^7.1.2","youdao-translate":"^1.0.0"},"scripts":{"start":"nodemon","start:ui":"NODE_ENV=development webpack-dev-server --config ./config/webpack.config.dev.js","start:mw":"sh -c ./node_modules/.bin/nodemon app.js","start:docker":"sh scripts/docker/dockerStart.sh licode_dev","clean":"find ./uploads/ -maxdepth 2 -type f -delete","sdk:import":"cp middleware/public/libs/sdk.js ui/src/lib/sdk.js","cleanup":"sh scripts/cleanup.sh","build":"sh -c \'npm run build:mw && npm run build:ui\'","build:mw":"sh scripts/middleware/build.sh","build:dev":"sh -c \'sh scripts/middleware/buildDev.sh && npm run build:ui\'","build:ui":"node scripts/ui/build.js","build:swagger":"node doc/swagger/buildJson.js","build:sdk":"RLC=true webpack --config ./sdk/webpack.config.js","test":"jest","test:ui":"jest","test:watch:ui":"jest --watch","test:coverage:ui":"jest -- --coverage","posttest_":"./node_modules/.bin/eslint ./ui/**","lint:ui":"eslint ui/src --ext .jsx --ext .js ","lint:fix:ui":"eslint ./ui/src --ext .jsx --ext .js --fix --quiet","shrimp":"shrimpit ui/src/**/**/**/**/**/**/**/**/**/**/**/*.js*","update:packages":"rm -rf node_modules && npm update --save-dev && npm update --save"},"devDependencies":{"@welldone-software/why-did-you-render":"^4.0.3","enzyme":"^3.10.0","enzyme-adapter-react-16":"^1.14.0","enzyme-to-json":"^3.4.0","git-revision-webpack-plugin":"^3.0.3","jest":"^24.9.0","jsdom":"^15.1.1","nodemon":"^1.19.2","prettier-eslint":"^9.0.1","react-hot-loader":"^4.12.14","react-test-renderer":"^16.9.0","redux-mock-store":"^1.5.3","redux-saga-test-plan":"^4.0.0-rc.3","shrimpit":"^1.3.0","sinon":"^7.5.0","terser-webpack-plugin":"^2.1.2","typedoc":"^0.15.0","typedoc-plugin-markdown":"^2.2.6","typedoc-webpack-plugin":"^1.1.4"}}')},"./sdk/index.js":function(e,t,r){"use strict";r.r(t);var n={GENERAL_ERROR:"teevid/error",GENERAL_WARNING:"teevid/warning",GENERAL_INFO:"teevid/info",SET_GLOBAL_CONFIGS:"teevid/api/global_config",SET_ADMIN_PORTAL:"teevid/api/admin_portal",SET_ADMIN_SOCKET:"teevid/api/admin_socket",PARTICIPANT_STATS:"teevid/api/participant_stats",DELETE_FROM_ROOM:"teevid/api/delete_from_room",ROOM_CLOSE:"teevid/api/room_close",LICENSE_GET:"teevid/api/license_get",LICENSE_SUCCESS:"teevid/api/license_success",LICENSE_ERROR:"teevid/api/license_error",LICENSE_UPDATE:"teevid/api/license_update",LICENSE_UPDATE_SUCCESS:"teevid/api/license_update_success",LICENSE_UPDATE_ERROR:"teevid/api/license_update_error",SERVERS_GET:"teevid/api/servers_get",SERVERS_SUCCESS:"teevid/api/servers_success",SERVERS_ERROR:"teevid/api/servers/error",LIVE_MEETINGS_GET:"teevid/api/live_meetings_get",LIVE_MEETINGS_SUCCESS:"teevid/api/live_meetings_success",LIVE_MEETINGS_ERROR:"teevid/api/live_meetings_error",RECORDS_FETCH:"teevid/api/records",RECORDS_FETCH_SUCCESS:"teevid/api/records_success",RECORD_UPDATE:"teevid/api/record_update",RECORD_UPDATED_SUCCESS:"teevid/api/records_updated_success",RECORD_REMOVE:"teevid/api/record_remove",RECORD_REMOVED_SUCCESS:"teevid/api/records_removed_success",STORYBOARD_FETCH_ALL:"teevid/api/storyboard_all",STORYBOARD_SUCCESS_ALL:"teevid/api/storyboard_success_all",STORYBOARD_LOAD_PROGRESS:"teevid/api/storyboard_load_progress",STORYBOARD_LOAD_PROGRESS_ERROR:"teevid/api/storyboard_load_progress_error",STORYBOARD_THEMES_FETCH:"teevid/api/storyboard_themes",STORYBOARD_THEMES_SUCCESS:"teevid/api/storyboard_themes_success",STORYBOARD_FETCH:"teevid/api/storyboard_fetch",STORYBOARD_FETCH_SUCCESS:"teevid/api/storyboard_fetch_success",STORYBOARD_UPDATE:"teevid/api/storyboard_update",STORYBOARD_CREATE:"teevid/api/storyboard_create",STORYBOARD_REMOVE:"teevid/api/storyboard_remove",STORYBOARD_REMOVED:"teevid/api/storyboard_removed",STORYBOARD_SUCCESS:"teevid/api/storyboard_success",STORYBOARD_ERROR:"teevid/api/storyboard_error",STORYBOARD_SCENE_CREATE:"teevid/api/storyboard_scene_create",STORYBOARD_SCENE_CREATE_SUCCESS:"teevid/api/storyboard_scene_create_success",STORYBOARD_SCENE_CREATE_ERROR:"teevid/api/storyboard_scene_create_error",REFRESH_MEDIA_DEVICES:"teevid/media/devices_refresh",REFRESH_CURRENT_MEDIA_DEVICES:"teevid/media/devices_refresh_current",SET_MEDIA_DEVICES:"teevid/media/devices_set",SET_CURRENT_MEDIA_DEVICES:"teevid/media/devices_set_current",USERS_FETCH_ALL:"teevid/api/users_all",USERS_SUCCESS_ALL:"teevid/api/users_success_all",USER_CREATE:"teevid/api/users_create",USER_EDIT:"teevid/api/users_edit",USER_CREATE_SUCCESS:"teevid/api/users_create_success",USER_EDIT_SUCCESS:"teevid/api/users_edit_success",USER_CREATE_ERROR:"teevid/api/users_create_error",USER_EDIT_ERROR:"teevid/api/users_edit_error",USER_CHANGE_PASSWORD:"teevid/api/users_change_password",USER_DELETE:"teevid/api/users_delete",USER_DELETE_SUCCESS:"teevid/api/users_delete_success",USER_DELETE_ERROR:"teevid/api/users_delete_error",USERS_ERROR:"teevid/api/users_error",ROOM_FETCH_ALL:"teevid/api/room_all",ROOM_SUCCESS_ALL:"teevid/api/room_success_all",ROOM_CREATE:"teevid/api/room_create",ROOM_CREATE_SUCCESS:"teevid/api/room_create_success",ROOM_CREATE_ERROR:"teevid/api/room_create_error",ROOM_EDIT:"teevid/api/room_edit",ROOM_EDIT_SUCCESS:"teevid/api/room_edit_success",ROOM_EDIT_ERROR:"teevid/api/room_edit_error",ROOM_DELETE:"teevid/api/room_delete",ROOM_DELETE_SUCCESS:"teevid/api/room_delete_success",ROOM_DELETE_ERROR:"teevid/api/room_delete_error",ROOM_ERROR:"teevid/api/room_error",SERVER_STATUS:"server-status",GET_TERMINATED_MEETINGS:"teevid/api/terminated_meetings",GET_TERMINATED_MEETINGS_SUCCESS:"teevid/api/terminated_meetings_success",GET_TERMINATED_MEETINGS_ERROR:"teevid/api/terminated_meetings_error",GET_TERMINATED_PARTICIPANTS:"teevid/api/terminated_participants",GET_TERMINATED_PARTICIPANTS_SUCCESS:"teevid/api/terminated_participants_success",GET_TERMINATED_PARTICIPANTS_ERROR:"teevid/api/terminated_participants_error",MCU_FETCH_ALL:"teevid/api/mcu_all",MCU_SUCCESS_ALL:"teevid/api/mcu_all_success",MCU_START:"teevid/api/mcu_start",MCU_RESTART:"teevid/api/mcu_restart",MCU_START_SUCCESS:"teevid/api/mcu_start_success",MCU_START_ERROR:"teevid/api/mcu_start_error",MCU_REMOVE:"teevid/api/mcu_remove",MCU_REMOVE_SUCCESS:"teevid/api/mcu_remove_success",MCU_STOP:"teevid/api/mcu_stop",MCU_STOP_SUCCESS:"teevid/api/mcu_stop_success",MCU_KILL:"teevid/api/mcu_kill",MCU_KILL_SUCCESS:"teevid/api/mcu_kill_success",MCU_STATS:"teevid/api/mcu_stats",MS_FETCH_ALL:"teevid/api/media_servers_all",MS_SUCCESS_ALL:"teevid/api/media_servers_success_all",MS_ADD:"teevid/api/media_servers_add",MS_ADD_SUCCESS:"teevid/api/media_servers_add_success",MS_REMOVE:"teevid/api/media_servers_remove",MS_REMOVE_SUCCESS:"teevid/api/media_servers_remove_success",KURENTO_FETCH_ALL:"teevid/api/kurento_servers_all",KURENTO_SUCCESS_ALL:"teevid/api/kurento_servers_success_all",KURENTO_RESTART:"teevid/api/kurento_restart",KURENTO_RESTARTED_SUCCESS:"teevid/api/kurento_restarted_success",KURENTO_RESET:"teevid/api/kurento_reset",KURENTO_RESETED_SUCCESS:"teevid/api/kurento_reseted_success",NOOP:"noop"};const i="server-status",o="stats-update",a="mcu-instance-list";var s={UPDATE_TOKEN:"teevid/token/update",SET_SERVER_URL:"teevid/server_url/set",LOGIN:"teevid/login",LOGIN_SUCCESS:"teevid/login/sucess",LOGIN_ERROR:"teevid/login/error",LOGOUT:"teevid/logout",USER_REFRESH_PROFILE:"teevid/user_profile/refresh",USER_EDIT_PROFILE:"teevid/user_profile/edit",USER_EDIT_PROFILE_ERROR:"teevid/user_profile/edit_error",USER_SET_PROFILE:"teevid/user_profile/set",SET_EVENT_ROOM:"teevid/set_event_room",ACCESS_PIN_ERROR:"teevid/access_pin_error",OWNER_PIN_ERROR:"teevid/owner_pin_error"},c=r("./node_modules/immutability-helper/index.js"),d=r.n(c);const u="interactive",p="basic-lecture",l="lecture",f="auto",h="manual",m=0,y=3,g=4,v=1,E=2,S=3,_=4,b=0,T=1,C=2,R=3,A=4,O=2,I=3,P={0:{length:1,geometry:{optimized_layout_full_quality:1,optimized_layout_threshold:0}},1:{length:2,geometry:{optimized_layout_full_quality:2,optimized_layout_threshold:0}},2:{length:4,geometry:{optimized_layout_full_quality:4,optimized_layout_threshold:0}},3:{length:5,geometry:{optimized_layout_full_quality:1,optimized_layout_threshold:4}},4:{length:6,geometry:{optimized_layout_full_quality:2,optimized_layout_threshold:4}},5:{length:8,geometry:{optimized_layout_full_quality:4,optimized_layout_threshold:4}},default:{length:10,geometry:{optimized_layout_full_quality:4,optimized_layout_threshold:6}}},w={NO_DEVICE:-1,UNMUTED:0,MUTED:1,MUTED_BY_MODER:2},k={adminSocket:null,isAdminPortal:!1,users:[],license:{},servers:[],mcus:[],mediaServers:[],kurentoServers:[],liveMeetings:{},terminatedMeetings:{},serverUrl:"",storyboards:[],storyboard:null,rooms:[],themes:[],globalConfigs:{},audioDevices:[],videoDevices:[],currentDevices:{video:null,audio:null},percents:0},M=e=>{const t={};return e.forEach(e=>{"optimized_layout_full_quality"===e._id?isNaN(e.value)||0===parseInt(e.value)?t[e._id]=null:t[e._id]=parseInt(e.value):"optimized_layout_threshold"===e._id?isNaN(e.value)?t[e._id]=null:t[e._id]=parseInt(e.value):t[e._id]=e.value}),t.streaming_domain||window&&window.location&&window.location.hostname&&(t.streaming_domain=window.location.hostname),t.optimized_layout_full_quality||(t.optimized_layout_full_quality=P.default.geometry.optimized_layout_full_quality),t.optimized_layout_threshold||(t.optimized_layout_threshold=P.default.geometry.optimized_layout_threshold),t};var N=(e=k,{type:t,payload:r})=>{switch(t){case s.LOGOUT:return Object.assign({},e,{adminSocket:null,isAdminPortal:!1,users:[],servers:[],liveMeetings:{}});case n.SET_MEDIA_DEVICES:return Object.assign({},e,{audioDevices:r.audio,videoDevices:r.video});case n.SET_CURRENT_MEDIA_DEVICES:return Object.assign({},e,{currentDevices:r});case n.SET_ADMIN_PORTAL:return Object.assign({},e,{isAdminPortal:r});case n.SET_ADMIN_SOCKET:return Object.assign({},e,{adminSocket:r});case n.SET_GLOBAL_CONFIGS:return Object.assign({},e,{globalConfigs:M(r)});case n.LICENSE_SUCCESS:case n.LICENSE_UPDATE_SUCCESS:return Object.assign({},e,{license:r});case n.LIVE_MEETINGS_SUCCESS:return Object.assign({},e,{liveMeetings:r});case n.SERVERS_SUCCESS:return Object.assign({},e,{servers:r});case n.LICENSE_ERROR:return Object.assign({},e,{license:{}});case n.STORYBOARD_FETCH_SUCCESS:return Object.assign({},e,{storyboard:r});case n.STORYBOARD_SUCCESS_ALL:return Object.assign({},e,{storyboards:r});case n.STORYBOARD_LOAD_PROGRESS:return Object.assign({},e,{percents:r});case n.STORYBOARD_THEMES_SUCCESS:return Object.assign({},e,{themes:r});case n.USERS_SUCCESS_ALL:return Object.assign({},e,{users:r});case n.ROOM_SUCCESS_ALL:return Object.assign({},e,{rooms:r});case n.MCU_SUCCESS_ALL:case n.MCU_STATS:return Object.assign({},e,{mcus:r});case n.MS_SUCCESS_ALL:return Object.assign({},e,{mediaServers:r});case n.KURENTO_SUCCESS_ALL:return Object.assign({},e,{kurentoServers:r});case n.SERVER_STATUS:return Object.assign({},e,{liveMeetings:r});case n.PARTICIPANT_STATS:let t={};for(const n in r.stats)e.liveMeetings[r.roomId]&&(t[n]=Object.assign({},e.liveMeetings[r.roomId].currentParticipants[n],r.stats[n]));return Object.assign({},d()(e,{liveMeetings:{[r.roomId]:{currentParticipants:{$merge:t}}}}));case n.GET_TERMINATED_MEETINGS_SUCCESS:return Object.assign({},e,{terminatedMeetings:r});default:return e}},D=function(e){return"@@redux-saga/"+e},x=D("CANCEL_PROMISE"),L=D("CHANNEL_END"),U=D("IO"),j=D("MULTICAST"),B=D("SELF_CANCELLATION"),F=D("TASK"),V=D("TASK_CANCEL"),G=D("TERMINATE"),q=D("LOCATION");function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var W=function(e){return null==e},H=function(e){return null!=e},$=function(e){return"function"==typeof e},Y=function(e){return"string"==typeof e},Q=Array.isArray,K=function(e){return e&&$(e.then)},J=function(e){return e&&$(e.next)&&$(e.throw)},X=function e(t){return t&&(Y(t)||te(t)||$(t)||Q(t)&&t.every(e))},Z=function(e){return e&&$(e.take)&&$(e.close)},ee=function(e){return $(e)&&e.hasOwnProperty("toString")},te=function(e){return Boolean(e)&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype};var re=function(e,t){var r;void 0===t&&(t=!0);var n=new Promise((function(n){r=setTimeout(n,e,t)}));return n[x]=function(){clearTimeout(r)},n},ne=function(e){return function(){return e}}(!0),ie=function(){};var oe=function(e){return e};"function"==typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator;var ae=function(e,t){z(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach((function(r){e[r]=t[r]}))};function se(e,t){var r=e.indexOf(t);r>=0&&e.splice(r,1)}function ce(e){var t=!1;return function(){t||(t=!0,e())}}var de=function(e){throw e},ue=function(e){return{value:e,done:!0}};function pe(e,t,r){void 0===t&&(t=de),void 0===r&&(r="iterator");var n={meta:{name:r},next:e,throw:t,return:ue,isSagaIterator:!0};return"undefined"!=typeof Symbol&&(n[Symbol.iterator]=function(){return n}),n}var le=function(e){return Array.apply(null,new Array(e))},fe=function(e){return e===G},he=function(e){return e===V},me=function(e){return fe(e)||he(e)};function ye(e,t){var r=Object.keys(e),n=r.length;var i,o=0,a=Q(e)?le(n):{},s={};return r.forEach((function(e){var r=function(r,s){i||(s||me(r)?(t.cancel(),t(r,s)):(a[e]=r,++o===n&&(i=!0,t(a))))};r.cancel=ie,s[e]=r})),t.cancel=function(){i||(i=!0,r.forEach((function(e){return s[e].cancel()})))},s}function ge(e){return{name:e.name||"anonymous",location:ve(e)}}function ve(e){return e[q]}var Ee={isEmpty:ne,put:ie,take:ie};function Se(e,t){void 0===e&&(e=10);var r=new Array(e),n=0,i=0,o=0,a=function(t){r[i]=t,i=(i+1)%e,n++},s=function(){if(0!=n){var t=r[o];return r[o]=null,n--,o=(o+1)%e,t}},c=function(){for(var e=[];n;)e.push(s());return e};return{isEmpty:function(){return 0==n},put:function(s){var d;if(n<e)a(s);else switch(t){case 1:throw new Error("Channel's Buffer overflow!");case 3:r[i]=s,o=i=(i+1)%e;break;case 4:d=2*e,r=c(),n=r.length,i=r.length,o=0,r.length=d,e=d,a(s)}},take:s,flush:c}}var _e=function(){return Ee},be=function(e){return Se(e,4)},Te=function(e,t){var r;return(r={})[U]=!0,r.combinator=!1,r.type=e,r.payload=t,r};function Ce(e,t){return void 0===e&&(e="*"),X(e)?Te("TAKE",{pattern:e}):Z(r=e)&&r[j]&&H(t)&&X(t)?Te("TAKE",{channel:e,pattern:t}):Z(e)?Te("TAKE",{channel:e}):void 0;var r}function Re(e,t){return W(t)&&(t=e,e=void 0),Te("PUT",{channel:e,action:t})}function Ae(e){var t=Te("ALL",e);return t.combinator=!0,t}function Oe(e,t){var r,n=null;return $(e)?r=e:(Q(e)?(n=e[0],r=e[1]):(n=e.context,r=e.fn),n&&Y(r)&&$(n[r])&&(r=n[r])),{context:n,fn:r,args:t}}function Ie(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Te("CALL",Oe(e,r))}function Pe(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Te("FORK",Oe(e,r))}function we(e){return void 0===e&&(e=B),Te("CANCEL",e)}function ke(e){void 0===e&&(e=oe);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Te("SELECT",{selector:e,args:r})}var Me=Ie.bind(null,re),Ne=function(e){return{done:!0,value:e}},De={};function xe(e){return Z(e)?"channel":ee(e)?String(e):$(e)?e.name:String(e)}function Le(e,t,r){var n,i,o,a=t;function s(t,r){if(a===De)return Ne(t);if(r&&!i)throw a=De,r;n&&n(t);var s=r?e[i](r):e[a]();return a=s.nextState,o=s.effect,n=s.stateUpdater,i=s.errorState,a===De?Ne(t):o}return pe(s,(function(e){return s(null,e)}),r)}function Ue(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o,a={done:!1,value:Ce(e)},s=function(e){return{done:!1,value:Pe.apply(void 0,[t].concat(n,[e]))}},c=function(e){return o=e};return Le({q1:function(){return{nextState:"q2",effect:a,stateUpdater:c}},q2:function(){return{nextState:"q1",effect:s(o)}}},"q1","takeEvery("+xe(e)+", "+t.name+")")}function je(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var o,a,s={done:!1,value:Ce(e)},c=function(e){return{done:!1,value:Pe.apply(void 0,[t].concat(n,[e]))}},d=function(e){return{done:!1,value:we(e)}},u=function(e){return o=e},p=function(e){return a=e};return Le({q1:function(){return{nextState:"q2",effect:s,stateUpdater:p}},q2:function(){return o?{nextState:"q3",effect:d(o)}:{nextState:"q1",effect:c(a),stateUpdater:u}},q3:function(){return{nextState:"q1",effect:c(a),stateUpdater:u}}},"q1","takeLatest("+xe(e)+", "+t.name+")")}function Be(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return Pe.apply(void 0,[Ue,e,t].concat(n))}function Fe(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return Pe.apply(void 0,[je,e,t].concat(n))}r("./node_modules/symbol-observable/es/index.js");var Ve=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ge={INIT:"@@redux/INIT"+Ve(),REPLACE:"@@redux/REPLACE"+Ve(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ve()}};function qe(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function ze(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];0,"function"==typeof e[i]&&(r[i]=e[i])}var o,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:Ge.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:Ge.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+Ge.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var n=!1,i={},s=0;s<a.length;s++){var c=a[s],d=r[c],u=e[c],p=d(u,t);if(void 0===p){var l=qe(c,t);throw new Error(l)}i[c]=p,n=n||p!==u}return(n=n||a.length!==Object.keys(e).length)?i:e}}function We(e,t){return function(){return t(e.apply(this,arguments))}}function He(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}var $e=He,Ye=[],Qe=0;function Ke(e){try{Ze(),e()}finally{et()}}function Je(e){Ye.push(e),Qe||(Ze(),tt())}function Xe(e){try{return Ze(),e()}finally{tt()}}function Ze(){Qe++}function et(){Qe--}function tt(){var e;for(et();!Qe&&void 0!==(e=Ye.shift());)Ke(e)}var rt=function(e){return function(t){return e.some((function(e){return st(e)(t)}))}},nt=function(e){return function(t){return e(t)}},it=function(e){return function(t){return t.type===String(e)}},ot=function(e){return function(t){return t.type===e}},at=function(){return ne};function st(e){var t="*"===e?at:Y(e)?it:Q(e)?rt:ee(e)?it:$(e)?nt:te(e)?ot:null;if(null===t)throw new Error("invalid pattern: "+e);return t(e)}var ct={type:L},dt=function(e){return e&&e.type===L};function ut(e){void 0===e&&(e=be());var t=!1,r=[];return{take:function(n){t&&e.isEmpty()?n(ct):e.isEmpty()?(r.push(n),n.cancel=function(){se(r,n)}):n(e.take())},put:function(n){if(!t){if(0===r.length)return e.put(n);r.shift()(n)}},flush:function(r){t&&e.isEmpty()?r(ct):r(e.flush())},close:function(){if(!t){t=!0;var e=r;r=[];for(var n=0,i=e.length;n<i;n++){(0,e[n])(ct)}}}}}function pt(e,t){void 0===t&&(t=_e());var r,n=!1,i=ut(t),o=function(){n||(n=!0,$(r)&&r(),i.close())};return r=ce(r=e((function(e){dt(e)?o():i.put(e)}))),n&&r(),{take:i.take,flush:i.flush,close:o}}function lt(e,t){var r=e[x];$(r)&&(t.cancel=r),e.then(t,(function(e){t(e,!0)}))}var ft,ht=0,mt=function(){return++ht};function yt(e){e.isRunning()&&e.cancel()}var gt=((ft={}).TAKE=function(e,t,r){var n=t.channel,i=void 0===n?e.channel:n,o=t.pattern,a=t.maybe,s=function(e){e instanceof Error?r(e,!0):!dt(e)||a?r(e):r(G)};try{i.take(s,H(o)?st(o):null)}catch(e){return void r(e,!0)}r.cancel=s.cancel},ft.PUT=function(e,t,r){var n=t.channel,i=t.action,o=t.resolve;Je((function(){var t;try{t=(n?n.put:e.dispatch)(i)}catch(e){return void r(e,!0)}o&&K(t)?lt(t,r):r(t)}))},ft.ALL=function(e,t,r,n){var i=n.digestEffect,o=ht,a=Object.keys(t);if(0!==a.length){var s=ye(t,r);a.forEach((function(e){i(t[e],o,s[e],e)}))}else r(Q(t)?[]:{})},ft.RACE=function(e,t,r,n){var i=n.digestEffect,o=ht,a=Object.keys(t),s=Q(t)?le(a.length):{},c={},d=!1;a.forEach((function(e){var t=function(t,n){d||(n||me(t)?(r.cancel(),r(t,n)):(r.cancel(),d=!0,s[e]=t,r(s)))};t.cancel=ie,c[e]=t})),r.cancel=function(){d||(d=!0,a.forEach((function(e){return c[e].cancel()})))},a.forEach((function(e){d||i(t[e],o,c[e],e)}))},ft.CALL=function(e,t,r,n){var i=t.context,o=t.fn,a=t.args,s=n.task;try{var c=o.apply(i,a);if(K(c))return void lt(c,r);if(J(c))return void Rt(e,c,s.context,ht,ge(o),!1,r);r(c)}catch(e){r(e,!0)}},ft.CPS=function(e,t,r){var n=t.context,i=t.fn,o=t.args;try{var a=function(e,t){W(e)?r(t):r(e,!0)};i.apply(n,o.concat(a)),a.cancel&&(r.cancel=a.cancel)}catch(e){r(e,!0)}},ft.FORK=function(e,t,r,n){var i=t.context,o=t.fn,a=t.args,s=t.detached,c=n.task,d=function(e){var t=e.context,r=e.fn,n=e.args;try{var i=r.apply(t,n);if(J(i))return i;var o=!1;return pe((function(e){return o?{value:e,done:!0}:(o=!0,{value:i,done:!K(i)})}))}catch(e){return pe((function(){throw e}))}}({context:i,fn:o,args:a}),u=function(e,t){return e.isSagaIterator?{name:e.meta.name}:ge(t)}(d,o);Xe((function(){var t=Rt(e,d,c.context,ht,u,s,void 0);s?r(t):t.isRunning()?(c.queue.addTask(t),r(t)):t.isAborted()?c.queue.abort(t.error()):r(t)}))},ft.JOIN=function(e,t,r,n){var i=n.task,o=function(e,t){if(e.isRunning()){var r={task:i,cb:t};t.cancel=function(){e.isRunning()&&se(e.joiners,r)},e.joiners.push(r)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(Q(t)){if(0===t.length)return void r([]);var a=ye(t,r);t.forEach((function(e,t){o(e,a[t])}))}else o(t,r)},ft.CANCEL=function(e,t,r,n){var i=n.task;t===B?yt(i):Q(t)?t.forEach(yt):yt(t),r()},ft.SELECT=function(e,t,r){var n=t.selector,i=t.args;try{r(n.apply(void 0,[e.getState()].concat(i)))}catch(e){r(e,!0)}},ft.ACTION_CHANNEL=function(e,t,r){var n=t.pattern,i=ut(t.buffer),o=st(n),a=function t(r){dt(r)||e.channel.take(t,o),i.put(r)},s=i.close;i.close=function(){a.cancel(),s()},e.channel.take(a,o),r(i)},ft.CANCELLED=function(e,t,r,n){r(n.task.isCancelled())},ft.FLUSH=function(e,t,r){t.flush(r)},ft.GET_CONTEXT=function(e,t,r,n){r(n.task.context[t])},ft.SET_CONTEXT=function(e,t,r,n){var i=n.task;ae(i.context,t),r()},ft);function vt(e,t){return e+"?"+t}function Et(e){var t=e.name,r=e.location;return r?t+"  "+vt(r.fileName,r.lineNumber):t}var St=null,_t=[],bt=function(){St=null,_t.length=0},Tt=function(){var e,t,r,n,i,o=_t[0],a=_t.slice(1),s=o.crashedEffect?function(e){var t=ve(e);return t?t.code+"  "+vt(t.fileName,t.lineNumber):""}(o.crashedEffect):null;return["The above error occurred in task "+Et(o.meta)+(s?" \n when executing effect "+s:"")].concat(a.map((function(e){return"    created by "+Et(e.meta)})),[(e=_t,t=function(e){return e.cancelledTasks},r=e,i=(n=[]).concat.apply(n,r.map(t)),i.length?["Tasks cancelled due to error:"].concat(i).join("\n"):"")]).join("\n")};function Ct(e,t,r,n,i,o,a){var s;void 0===a&&(a=ie);var c,d,u=0,p=null,l=[],f=Object.create(r),h=function(e,t,r){var n,i=[],o=!1;function a(e){t(),c(),r(e,!0)}function s(t){i.push(t),t.cont=function(s,c){o||(se(i,t),t.cont=ie,c?a(s):(t===e&&(n=s),i.length||(o=!0,r(n))))}}function c(){o||(o=!0,i.forEach((function(e){e.cont=ie,e.cancel()})),i=[])}return s(e),{addTask:s,cancelAll:c,abort:a,getTasks:function(){return i}}}(t,(function(){l.push.apply(l,h.getTasks().map((function(e){return e.meta.name})))}),m);function m(t,r){if(r){if(u=2,(o={meta:i,cancelledTasks:l}).crashedEffect=St,_t.push(o),y.isRoot){var n=Tt();bt(),e.onError(t,{sagaStack:n})}d=t,p&&p.reject(t)}else t===V?u=1:1!==u&&(u=3),c=t,p&&p.resolve(t);var o;y.cont(t,r),y.joiners.forEach((function(e){e.cb(t,r)})),y.joiners=null}var y=((s={})[F]=!0,s.id=n,s.meta=i,s.isRoot=o,s.context=f,s.joiners=[],s.queue=h,s.cancel=function(){0===u&&(u=1,h.cancelAll(),m(V,!1))},s.cont=a,s.end=m,s.setContext=function(e){ae(f,e)},s.toPromise=function(){return p?p.promise:(p=$e(),2===u?p.reject(d):0!==u&&p.resolve(c),p.promise)},s.isRunning=function(){return 0===u},s.isCancelled=function(){return 1===u||0===u&&1===t.status},s.isAborted=function(){return 2===u},s.result=function(){return c},s.error=function(){return d},s);return y}function Rt(e,t,r,n,i,o,a){var s=e.finalizeRunEffect((function(t,r,n){if(K(t))lt(t,n);else if(J(t))Rt(e,t,d.context,r,i,!1,n);else if(t&&t[U]){(0,gt[t.type])(e,t.payload,n,u)}else n(t)}));p.cancel=ie;var c={meta:i,cancel:function(){0===c.status&&(c.status=1,p(V))},status:0},d=Ct(e,c,r,n,i,o,a),u={task:d,digestEffect:l};return a&&(a.cancel=d.cancel),p(),d;function p(e,r){try{var i;r?(i=t.throw(e),bt()):he(e)?(c.status=1,p.cancel(),i=$(t.return)?t.return(V):{done:!0,value:V}):i=fe(e)?$(t.return)?t.return():{done:!0}:t.next(e),i.done?(1!==c.status&&(c.status=3),c.cont(i.value)):l(i.value,n,p)}catch(e){if(1===c.status)throw e;c.status=2,c.cont(e,!0)}}function l(t,r,n,i){void 0===i&&(i="");var o,a=mt();function c(r,i){o||(o=!0,n.cancel=ie,e.sagaMonitor&&(i?e.sagaMonitor.effectRejected(a,r):e.sagaMonitor.effectResolved(a,r)),i&&function(e){St=e}(t),n(r,i))}e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:a,parentEffectId:r,label:i,effect:t}),c.cancel=ie,n.cancel=function(){o||(o=!0,c.cancel(),c.cancel=ie,e.sagaMonitor&&e.sagaMonitor.effectCancelled(a))},s(t,a,c)}}var At={SDK_ACTIVATION:"teevid/meeting/voice_activation",SDK_ORDER_UPDATE:"teevid/meeting/order_update",INIT_MEETING:"teevid/meeting/init",SET_CONNECTION_STATE:"teevid/connection/state/set",SET_ACCESS_PIN_REQ:"teevid/connection/access_pin/require",MODERATION_SERVER_READY:"teevid/moderation/ready",STATS_ROOM:"teevid/meeting/stats",STATS_PARTICIPANT:"teevid/meeting/participant_stats",MODERATION_MESSAGE_RECEIVED:"teevid/moderation/message",MODERATION_MESSAGE_ERROR:"teevid/moderation/message/error",MODERATION_SOCKET_CREATED:"teevid/moderation/socket/created",MODERATION_SOCKET_CLOSED:"teevid/moderation/socket/closed",MODERATION_SOCKET_OPENED:"teevid/moderation/socket/opened",MODERATION_SOCKET_ERROR:"teevid/moderation/socket/error",CREATE_PARTICIPANT:"teevid/participant/create",CREATE_PARTICIPANT_SUCCESS:"teevid/participant/success",CREATE_PARTICIPANT_ERROR:"teevid/participant/error",CREATE_CONNECTION:"teevid/connection/create",CREATE_CONNECTION_SUCCESS:"teevid/connection/create/success",CREATE_CONNECTION_ERROR:"teevid/connection/create/error",CONNECT:"teevid/connection/connect",CONNECTION_SUCCESS:"teevid/connection/connect/success",CONNECTION_ERROR:"teevid/connection/connect/error",CONNECTION_EVENT:"teevid/connection/event",CONNECTION_READY:"teevid/connection/ready",SET_CURRENT_ROOM:"teevid/meeting/room/set",ROOM_READY:"teevid/meeting/room/ready",CONNECTION_CANCEL:"teevid/connection/cancel",CONNECTION_DISCONNECT:"teevid/connection/disconnect",CONNECTION_DISCONNECTED:"teevid/connection/disconnected",STATUS_UPDATE:"teevid/connection/status_update",UPDATE_PARTICIPANT_STATUS:"teevid/connnections/update_participant_status",SET_STREAMING_STATE:"teevid/streaming/state",STREAMING_START:"teevid/streaming/start",STREAMING_STOP:"teevid/streaming/stop",SDK_SET_LOCAL_STREAM:"teevid/local_stream/added",CONNECTION_STREAM_ADDED:"teevid/stream/added",CONNECTION_STREAM_REMOVED:"teevid/stream/removed",CONNECTION_LOCAL_STREAM_REMOVED:"teevid/local_stream/removed",CONNECTION_STREAM_SUBSCRIBED:"teevid/stream/subscribed",CONNECTION_STOP_SHARING:"teevid/sharing/stopped",CONNECTION_START_SHARING:"teevid/sharing/started",CONNECTION_ADD_PARTICIPANT:"teevid/participant/add",CONNECTION_ADD_PARTICIPANT_STREAM:"teevid/participant/stream/add",CONNECTION_PARTICIPANT_REMOVED:"teevid/participant/removed",KICK_PARTICIPANT:"teevid/participant/kick",PARTICIPANT_AVATAR_GET:"teevid/participant/avatar_get",PARTICIPANT_AVATAR_SET:"teevid/participant/avatar_set",PARTICIPANT_NAME_CHANGED:"teevid/participant/change_name",NOOP:"noop",SET_MEETING_STATE:"teevid/meeting/set",MEETING_CHANGE_MODE:"teevid/meeting/change_mode",MEETING_CHANGE_LAYOUT:"teevid/meeting/change_layout",MEETING_LAYOUT_MODE:"teevid/meeting/change_layout_mode",MEETING_SEND_LAYOUT:"teevid/meeting/send_layout",MEETING_SLIDE_NUMBER:"teevid/meeting/slide_number",MEETING_SLIDE_CHANGED:"teevid/meeting/slide_number_changed",ROOM_CONNECTED:"teevid/meeting/room/connected",MUTE_STREAM:"teevid/connection/stream/mute",MUTE_UPDATED:"teevid/connection/stream/mute_updated",MUTE_ALL:"teevid/meeting/mute",MUTE_AUDIO:"teevid/meeting/mute_audio",MUTE_VIDEO:"teevid/meeting/mute_video",REMOTE_MUTE:"teevid/meeting/remote_mute",UNMUTE_REQUEST_SENT:"teevid/meeting/um_request_sent",UNMUTE_RESPONSE:"teevid/meeting/um_response",MODERATOR_UNMUTE_REQUEST:"teevid/meeting/moderator_um_request",MODERATOR_UNMUTE_RESPONSE:"teevid/meeting/moderator_um_response",SET_MUTE_STATE:"teevid/meeting/set_mute_state",REQUEST_OWNER_PIN:"teevid/meeting/request_owner_pin",ROLE_CHANGED:"teevid/participant/role_changed",OWNER_PIN_SUCCESS:"teevid/participant/owner-pin-success",OWNER_PIN_FAILED:"teevid/participant/owner-pin-failed",SET_LECTURE_LAYOUT:"teevid/meeting/set_lecture_layout",SET_LAYOUT_MODE:"teevid/meeting/set_layout_mode",UPDATE_LAYOUT_GEOMETRY:"teevid/meeting/update_layout_geometry",UPDATE_LAYOUT_PARTICIPANTS:"teevid/meeting/update_layout_participants",UPDATE_PANEL_LAYOUT_PARTICIPANTS:"teevid/meeting/update_panel_layout_participants",MEETING_SET_MODE:"teevid/meeting/mode",SELECT_FOR_LECTURE:"teevid/meeting/select_for_lecture",SELECT_FOR_PANEL_MODE:"teevid/meeting/select_for_panel_mode",REQUEST_MODERATED_ACTION:"teevid/meeting/request_moderated_action",SET_OWNER_PIN:"teevid/meeting/set_owner_pin",SDK_MESSAGE:"teevid/moderation/sdk_message",MW_MESSAGE:"teevid/moderation/mw_message",RAISE_HAND_REQ:"teevid/meeting/raise_hand",RAISE_HAND_UPDATE:"teevid/meeting/raise_hand/update",RAISE_HAND_RES:"teevid/meeting/raise_hand/response",RAISE_HAND_RES_RECEIVED:"teevid/meeting/response_received",SET_SIP_STATE:"teevid/meeting/sip_state",SEND_SIP_STATE:"teevid/meeting/send_sip_state",SEND_MESSAGE:"teevid/meeting/send_message",SEND_TRANSCRIPT:"teevid/meeting/send_transcript",ADD_CHAT_MESSAGE:"teevid/meeting/add_chat_message",ADD_TRANSCRIPT_MESSAGE:"teevid/meeting/add_transcript_message",TURN_ON_SUBTITLES:"teevid/meeting/turn_on_subtitles",RECEIVE_SUBTITLES_REQUEST:"teevid/meeting/receive_subtitles_request",UPDATE_TRANSCRIPT:"teevid/meeting/update_transcript_configs",SHARE_TRANSCRIPT:"teevid/meeting/share_transcript",RECEIVE_TRANSCRIPT:"teevid/meeting/receive_transcript",SCREEN_SHARE_STARTED:"teevid/screen_share/started",SCREEN_SHARE_STOPPED:"teevid/screen_share/stopped",SCREEN_SHARE_SET_REMOTE:"teevid/screen_share/set_remote",RECEIVED_REQUEST_TO_PARTICIPATE:"teevid/meeting/received_request_to_participate",BFM_ON_PAUSE:"teevid/meeting/bfm_on_pause",SET_BFM_PAUSE_STATE:"teevid/meeting/set_bfm_pause_state",SDK_CREATE_LOCAL_STREAM:"teevid/meeting/stream_create",SDK_CLOSE_LOCAL_STREAM:"teevid/meeting/stream_close",RECORDING_START:"teevid/recording/start",RECORDING_START_SUCCESS:"teevid/recording/start_success",RECORDING_STOP:"teevid/recording/stop",RECORDING_STOP_SUCCESS:"teevid/recording/stop_success",RECORDING_STATUS:"teevid/recording/status",RECORDING_ERROR:"teevid/recording/error",RECORDING_FILESLIST:"teevid/recording/fileslist",RECORDING_FILE_REMOVE:"teevid/recording/file_remove",RECORDING_SET_STATE:"teevid/recording/state",RECORDING_SET_STATE_REMOTE:"teevid/recording/remote_state",GET_ROOM_RECORDINGS_SIZE:"teevid/recordings/get/room/size",SET_ROOM_RECORDINGS_SIZE:"teevid/recordings/set/room/size"};const Ot="audio",It="video",Pt={MODERATOR:"Moderator",PARTICIPANT:"Participant"};var wt=r("./node_modules/lodash.get/index.js"),kt=r.n(wt);const Mt=e=>e.teevid.meeting.participant,Nt=e=>e.teevid.user.profile,Dt=e=>kt()(e,"teevid.meeting.participant.status.devices",{audio:0,video:0}),xt=e=>e.teevid.meeting.streams,Lt=e=>e.teevid.meeting.remoteParticipants,Ut=e=>e.teevid.meeting.room,jt=e=>e.teevid.meeting.roomOptions,Bt=e=>e.teevid.user.serverUrl,Ft=e=>e.teevid.meeting.connection,Vt=e=>kt()(e,"teevid.meeting.moderationSocket",null),Gt=e=>e.teevid.meeting.mode,qt=e=>e.teevid.meeting.participantToken,zt=e=>e.teevid.user.userToken,Wt=e=>e.teevid.meeting.sipCallState,Ht=e=>({token:e.teevid.user.userToken,serverUrl:e.teevid.user.serverUrl}),$t=e=>({storyboard:e.teevid.api.storyboard,slideNumber:e.teevid.meeting.slideNumber}),Yt=e=>({room:e.teevid.meeting.room,globalConfigs:e.teevid.api.globalConfigs,lectureLayout:e.teevid.meeting.lectureLayout,layoutMode:e.teevid.meeting.layoutMode,mode:e.teevid.meeting.mode}),Qt=e=>({mode:e.teevid.meeting.mode,lecturerId:e.teevid.meeting.lecturerId,storyboardId:e.teevid.meeting.storyboardId,slideNumber:e.teevid.meeting.slideNumber,lectureLayout:e.teevid.meeting.lectureLayout,selectedForLecture:e.teevid.meeting.selectedForLecture,layoutMode:e.teevid.meeting.layoutMode}),Kt=e=>({lectureLayout:e.teevid.meeting.lectureLayout,layoutMode:e.teevid.meeting.layoutMode,selectedForLecture:e.teevid.meeting.selectedForLecture}),Jt=(e,t)=>kt()(e,`teevid.meeting.remoteParticipants.${t}`),Xt=(e,t)=>{let r;return r=e.teevid.meeting.participant._id===t?e.teevid.meeting.participant:e.teevid.meeting.remoteParticipants[t],r&&r.streams&&r.streams.mediaStreamId&&e.teevid.meeting.streams&&e.teevid.meeting.streams[r.streams.mediaStreamId]?e.teevid.meeting.streams[r.streams.mediaStreamId]:null},Zt=e=>({token:e.teevid.meeting.participantToken,serverUrl:e.teevid.user.serverUrl,mSocket:e.teevid.meeting.moderationSocket}),er=(e,t)=>{const r=kt()(e,"teevid.meeting.selectedForLecture");return r&&r.length&&-1!==r.indexOf(t)};var tr={setAdminPortal:e=>({type:n.SET_ADMIN_PORTAL,payload:e}),adminSocket:e=>({type:n.SET_ADMIN_SOCKET,payload:e}),serverStatus:e=>({type:n.SERVER_STATUS,payload:e}),participantStats:e=>({type:n.PARTICIPANT_STATS,payload:e}),deleteParticipantFromRoom:(e,t)=>({type:n.DELETE_FROM_ROOM,roomId:e,participantId:t}),closeRoom:e=>({type:n.ROOM_CLOSE,roomId:e}),setGlobalConfig:e=>({type:n.SET_GLOBAL_CONFIGS,payload:e}),licenseGet:()=>({type:n.LICENSE_GET}),licenseSuccess:e=>({type:n.LICENSE_SUCCESS,payload:e}),licenseError:e=>({type:n.LICENSE_ERROR,payload:e}),licenseUpdate:e=>({type:n.LICENSE_UPDATE,license:e}),licenseUpdateSuccess:e=>({type:n.LICENSE_UPDATE_SUCCESS,payload:e}),licenseUpdateError:e=>({type:n.LICENSE_UPDATE_ERROR,error:e}),serversGet:()=>({type:n.SERVERS_GET}),serversSuccess:e=>({type:n.SERVERS_SUCCESS,payload:e}),serversError:()=>({type:n.SERVERS_ERROR}),liveMeetingsGet:()=>({type:n.LIVE_MEETINGS_GET}),liveMeetingsSuccess:e=>({type:n.LIVE_MEETINGS_SUCCESS,payload:e}),liveMeetingsError:()=>({type:n.LIVE_MEETINGS_ERROR}),recordsFetch:e=>({type:n.RECORDS_FETCH,payload:e}),recordsFetchSuccess:e=>({type:n.RECORDS_FETCH_SUCCESS,payload:e}),recordUpdate:({recordId:e,update:t})=>({type:n.RECORD_UPDATE,payload:{recordId:e,update:t}}),recordUpdatedSuccess:e=>({type:n.RECORD_UPDATED_SUCCESS,payload:e}),recordRemove:({recordId:e,roomId:t})=>({type:n.RECORD_REMOVE,payload:{recordId:e,roomId:t}}),recordRemovedSuccess:e=>({type:n.RECORD_REMOVED_SUCCESS,payload:e}),storyboardFetch:e=>({type:n.STORYBOARD_FETCH,stbId:e}),storyboardFetchSuccess:e=>({type:n.STORYBOARD_FETCH_SUCCESS,payload:e}),storyboardFetchAll:()=>({type:n.STORYBOARD_FETCH_ALL}),storyboardSuccessAll:e=>({type:n.STORYBOARD_SUCCESS_ALL,payload:e}),storyboardLoadProgress:e=>({type:n.STORYBOARD_LOAD_PROGRESS,payload:e}),storyboardLoadProgressError:e=>({type:n.STORYBOARD_LOAD_PROGRESS_ERROR,payload:e}),storyboardThemesFetch:()=>({type:n.STORYBOARD_THEMES_FETCH}),storyboardThemesSuccess:e=>({type:n.STORYBOARD_THEMES_SUCCESS,payload:e}),storyboardError:e=>({type:n.STORYBOARD_ERROR,payload:e}),storyboardSceneCreate:(e,t)=>({type:n.STORYBOARD_SCENE_CREATE,stbId:e,scene:t}),storyboardSceneCreateSuccess:e=>({type:n.STORYBOARD_SCENE_CREATE_SUCCESS,result:e}),storyboardSceneCreateError:e=>({type:n.STORYBOARD_SCENE_CREATE_ERROR,error:e}),usersFetchAll:()=>({type:n.USERS_FETCH_ALL}),usersSuccessAll:e=>({type:n.USERS_SUCCESS_ALL,payload:e}),userCreate:e=>({type:n.USER_CREATE,data:e}),userEdit:(e,t)=>({type:n.USER_EDIT,id:e,data:t}),userCreateSuccess:e=>({type:n.USER_CREATE_SUCCESS}),userEditSuccess:e=>({type:n.USER_EDIT_SUCCESS}),userCreateError:e=>({type:n.USER_CREATE_ERROR,error:e}),userEditError:e=>({type:n.USER_EDIT_ERROR,error:e}),userChangePassword:e=>({type:n.USER_CHANGE_PASSWORD,data:e}),userDelete:e=>({type:n.USER_DELETE,name:e}),userDeleteSuccess:e=>({type:n.USER_DELETE_SUCCESS}),userDeleteError:e=>({type:n.USER_DELETE_ERROR,error:e}),usersError:()=>({type:n.USERS_ERROR}),roomsFetchAll:()=>({type:n.ROOM_FETCH_ALL}),roomsSuccessAll:e=>({type:n.ROOM_SUCCESS_ALL,payload:e}),roomCreate:e=>({type:n.ROOM_CREATE,data:e}),roomCreateSuccess:e=>({type:n.ROOM_CREATE_SUCCESS}),roomCreateError:e=>({type:n.ROOM_CREATE_ERROR,error:e}),roomEdit:(e,t)=>({type:n.ROOM_EDIT,id:e,data:t}),roomEditSuccess:()=>({type:n.ROOM_EDIT_SUCCESS}),roomEditError:e=>({type:n.ROOM_EDIT_ERROR,error:e}),roomDelete:e=>({type:n.ROOM_DELETE,name:e}),roomDeleteSuccess:e=>({type:n.ROOM_DELETE_SUCCESS}),roomDeleteError:e=>({type:n.ROOM_DELETE_ERROR,error:e}),roomsError:()=>({type:n.ROOM_ERROR}),noop:()=>({type:n.NOOP}),refreshMediaDevices:()=>({type:n.REFRESH_MEDIA_DEVICES}),refreshCurrentMediaDevices:e=>({type:n.REFRESH_CURRENT_MEDIA_DEVICES,payload:e}),setMediaDevices:e=>({type:n.SET_MEDIA_DEVICES,payload:e}),setCurrentMediaDevices:e=>({type:n.SET_CURRENT_MEDIA_DEVICES,payload:e}),generalError:e=>({type:n.GENERAL_ERROR,payload:e}),generalWarning:e=>({type:n.GENERAL_WARNING,payload:e}),generalInfo:e=>({type:n.GENERAL_INFO,payload:e}),getTerminatedMeetings:e=>({type:n.GET_TERMINATED_MEETINGS,data:e}),getTerminatedMeetingsSuccess:e=>({type:n.GET_TERMINATED_MEETINGS_SUCCESS,payload:e}),getTerminatedMeetingsError:e=>({type:n.GET_TERMINATED_MEETINGS_ERROR,payload:e}),getTerminatedParticipants:e=>({type:n.GET_TERMINATED_PARTICIPANTS,data:e}),getTerminatedParticipantsSuccess:e=>({type:n.GET_TERMINATED_PARTICIPANTS_SUCCESS,payload:e}),getTerminatedParticipantsError:e=>({type:n.GET_TERMINATED_PARTICIPANTS_ERROR,payload:e}),mcuFetchAll:()=>({type:n.MCU_FETCH_ALL}),mcuSuccessAll:e=>({type:n.MCU_SUCCESS_ALL,payload:e}),mcuStart:e=>({type:n.MCU_START,id:e}),mcuRestart:e=>({type:n.MCU_RESTART,id:e}),mcuStartSuccess:e=>({type:n.MCU_START_SUCCESS,payload:e}),mcuRemove:e=>({type:n.MCU_REMOVE,id:e}),mcuRemoveSuccess:e=>({type:n.MCU_REMOVE_SUCCESS,data:e}),mcuStop:e=>({type:n.MCU_STOP,id:e}),mcuStopSuccess:e=>({type:n.MCU_STOP_SUCCESS,data:e}),mcuKill:e=>({type:n.MCU_KILL,id:e}),mcuKillSuccess:e=>({type:n.MCU_KILL_SUCCESS,data:e}),mcuStats:e=>({type:n.MCU_STATS,payload:e}),msFetchAll:()=>({type:n.MS_FETCH_ALL}),msSuccessAll:e=>({type:n.MS_SUCCESS_ALL,payload:e}),msAdd:e=>({type:n.MS_ADD,data:e}),msAddSuccess:()=>({type:n.MS_ADD_SUCCESS}),msRemove:e=>({type:n.MS_REMOVE,id:e}),msRemoveSuccess:()=>({type:n.MS_REMOVE_SUCCESS}),kurentoFetchAll:()=>({type:n.KURENTO_FETCH_ALL}),kurentoSuccessAll:e=>({type:n.KURENTO_SUCCESS_ALL,payload:e}),kurentoRestart:e=>({type:n.KURENTO_RESTART,payload:e}),kurentoRestartedSuccess:e=>({type:n.KURENTO_RESTARTED_SUCCESS,payload:e}),kurentoReset:e=>({type:n.KURENTO_RESET,payload:e}),kurentoResetedSuccess:e=>({type:n.KURENTO_RESETED_SUCCESS,payload:e})};const rr={READY:"ready",STATS_UPDATE:"stats-update",STATUS_UPDATE:"status-update",MEETING_STATE:"meeting-state",ROLE_CHANGED:"role-changed",OWNER_PIN_SUCCESS:"owner-pin-success",OWNER_PIN_FAILED:"owner-pin-failed",STREAMING_STATE:"streaming-state",RECORDING_STATE:"recording-state",PARTICIPANT_READY:"participant-ready",PARTICIPANT_ADDED:"participant-added",PARTICIPANT_REMOVED:"participant-removed",MEETING_SET_MODE:"set-meeting-mode",MEETING_MODE:"set-meeting-mode",MOD_LAYOUT_ORDER_UPDATE:"update-layout-order",MW_NOTIFICATION:"middleware-notification",MUTE:"mute",MUTE_UPDATE:"mute-update",UNMUTE_REQUEST:"um-request",GET_ROLE:"get-role",UNMUTE_RESPONSE:"um-response",CHAT:"chat-message",SEND_TRANSCRIPT:"send-transcript-message",SHARE_TRANSCRIPT:"share-transcript",TURN_ON_SUBTITLES:"turn-on-subtitles",STATS:"stats",OWNER_PIN_ENTER:"enter-owner-pin",MEETING_DISBAND:"disband",LECTURE_LAYOUT:"lecture-layout",LECTURE_STATE:"set-lecture-state",LECTURE_SLIDE_NUMBER:"set-lecture-slide",SHARING_STOP:"stop-sharing",PARTICIPANT_UPDATE:"part-update",KICK_PARTICIPANT:"kick-participant",ROOM_CLOSE:"room-close",DISCONNECT:"disconnect",PARTICIPANT_PUBLISHED:"publish",PARTICIPANT_UNPUBLISHED:"unpublish",PARTICIPANT_SHARES:"part-screen-share",PARTICIPANT_NAME_CHANGED:"part-change-name",STREAMING_START:"strm-start",STREAMING_STOP:"strm-stop",RAISE_HAND_REQ:"raise-hand",RAISE_HAND_UPDATE:"raise-hand-set",RAISE_HAND_RES:"raise-hand-res",SEND_REQUEST_TO_PARTICIPATE:"send-request-to-participate",LEAVE_PLAYBACK_PAGE:"leave-playback-page",RECEIVE_REQUEST_TO_PARTICIPATE:"receive-request-to-participate",REQUEST_TO_PARTICIPATE_SENT:"request-to-participate-sent",ACCEPT_REQUEST_TO_PARTICIPATE:"accept-request-to-participate",REJECT_REQUEST_TO_PARTICIPATE:"reject-request-to-participate",VIEWER_JOIN_TO_MEETING:"viewer-join-to-meeting",SIP_CALL_STATE:"sip-call-state",BFM_ON_PAUSE:"bfm-on-pause",MOD_VOICE_ACTIVATION:"voice-activation"},nr={type:"web",token:"",data:{method:"noop",params:{}}};var ir={stats:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.STATS,params:{stats:t}}}),sendToSip:(e,t,r,n,i)=>Object.assign({},nr,{token:e,data:{method:rr.SIP_CALL_STATE,params:{sipUri:t,room:r,state:n,isEncrypted:i}}}),streamRemoved:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.KICK_PARTICIPANT,params:{streamId:t}}}),kickParticipant:(e,t,r)=>Object.assign({},nr,{token:e,data:{method:rr.KICK_PARTICIPANT,params:{roomId:t,participantId:r}}}),roomClose:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.ROOM_CLOSE,params:{roomId:t}}}),publishStream:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.PARTICIPANT_PUBLISHED,params:{streamId:t}}}),publishScreenStream:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.PARTICIPANT_SHARES,params:{streamId:t}}}),setOwnerPin:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.OWNER_PIN_ENTER,params:{pin:t}}}),changeParticipantName:(e,t,r)=>Object.assign({},nr,{token:e,data:{method:rr.PARTICIPANT_NAME_CHANGED,params:{participantId:t,name:r}}}),mute:(e,t,r,n)=>Object.assign({},nr,{token:e,data:{method:rr.MUTE,params:{senderId:t,participantId:r,state:n}}}),muteUpdate:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.MUTE_UPDATE,params:{state:t}}}),raiseHand:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.RAISE_HAND_REQ,params:{state:t}}}),raiseHandUpdate:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.RAISE_HAND_UPDATE,params:t}}),raiseHandDecline:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.RAISE_HAND_RES,params:{participantId:t,accepted:!1}}}),raiseHandAccept:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.RAISE_HAND_RES,params:{participantId:t,accepted:!0}}}),stopSharing:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.SHARING_STOP,params:{state:t}}}),updateRole:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.OWNER_PIN_ENTER,params:{pin:t}}}),participantReady:(e,t,r)=>Object.assign({},nr,{token:e,data:{method:rr.PARTICIPANT_READY,params:{devices:t.status.devices,meetingState:r}}}),participantStatusUpdated:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.STATUS_UPDATE,params:t}}),setMode:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.MEETING_MODE,params:t}}),setSlide:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.LECTURE_SLIDE_NUMBER,params:{number:t}}}),setLayout:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.LECTURE_LAYOUT,params:t}}),chat:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.CHAT,params:t}}),sendTranscript:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.SEND_TRANSCRIPT,params:t}}),shareTranscript:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.SHARE_TRANSCRIPT,params:t}}),turnOnSubtitles:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.TURN_ON_SUBTITLES,params:t}}),startStreaming:e=>Object.assign({},nr,{token:e,data:{method:rr.STREAMING_START,params:{}}}),stopStreaming:e=>Object.assign({},nr,{token:e,data:{method:rr.STREAMING_STOP,params:{}}}),recordingState:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.RECORDING_STATE,params:t}}),unmuteRequest:(e,t,r,n)=>Object.assign({},nr,{token:e,data:{method:rr.UNMUTE_REQUEST,params:{senderId:t,participantId:r,state:n}}}),getRole:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.GET_ROLE,params:{userToken:t}}}),unmuteResponse:(e,t,r,n)=>Object.assign({},nr,{token:e,data:{method:rr.UNMUTE_RESPONSE,params:{senderId:t,participantId:r,state:n}}}),leavePlaybackPage:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.LEAVE_PLAYBACK_PAGE,params:t}}),sendRequestToParticipate:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.SEND_REQUEST_TO_PARTICIPATE,params:t}}),acceptRequestToParticipate:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.ACCEPT_REQUEST_TO_PARTICIPATE,params:t}}),rejectRequestToParticipate:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.REJECT_REQUEST_TO_PARTICIPATE,params:t}}),joinToMeeting:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.JOIN_TO_MEETING,params:t}}),bfmOnPause:(e,t)=>Object.assign({},nr,{token:e,data:{method:rr.BFM_ON_PAUSE,params:t}}),voiceActivation:(e,t,r)=>Object.assign({},nr,{token:e,data:{method:rr.MOD_VOICE_ACTIVATION,params:{participantId:t,reorder:r}}})};function*or(e,...t){const r=yield ke(Vt),n=yield ke(qt);r&&1===r.readyState&&r.send(JSON.stringify(e(n,...t)))}const ar=(e,t,r,n,i)=>{const o={method:r.toUpperCase(),headers:{Accept:"application/json","cache-control":"no-store"}};if("/accesstokens"===n){const e=window.btoa(`${i.username}:${i.password}`);o.headers.Authorization=`Basic ${e}`}else t&&(o.headers.Authorization=`Bearer ${t}`);return-1!==["post","put","patch"].indexOf(r.toLowerCase())&&i&&(o.body=JSON.stringify(i),o.headers["Content-Type"]="application/json"),fetch(`https://${e}/api/v1${n}`,o).then(e=>{if(204===e.status)return{};const r=e.json().catch(e=>(console.error(`Error calling ${n}: ${e}`),{}));if(e.status>=200&&e.status<300){let n=t;return e.headers.get("Authorization")&&(n=e.headers.get("Authorization").replace(/^Bearer /,"")),r.then(e=>({payload:e,token:n}))}return 401===e.status?r.then(t=>{const r={code:e.status,type:t.type||t.name||"",message:t.message||t.type,details:t.details||""},n=t.message.split("\n");throw n.length>1&&(t.details=t.details||t.message,t.message=n[0]),r}):r.then(t=>{const r=t.message||e.statusText;throw{code:e.status,message:r}})})};function*sr(e,t,r){const{token:n,serverUrl:i}=yield ke(Ht);return yield ar(i,n,e,t,r)}function*cr(e,t,r){const{token:n,serverUrl:i}=yield ke(Zt),{payload:o}=yield ar(i,n,e,t,r);return o}function dr(e){var t=e.play;e.play=function(){e.hasAudio()||e.hasVideo()||e.hasScreen()?(t.apply(e,arguments),e.player.bar&&(e.player.bar.link.setAttribute("href","http://teevid.com/"),e.player.bar.logo.setAttribute("alt",""),e.player.bar.logo.setAttribute("src","assets/cayilogo.png"))):console.warn("Stream",e.getID(),"does not have media channels")},e.show=e.play,e.isPublished=function(){return e.stream&&e.getID()&&"local"!==e.getID()}}const ur=e=>{if(!e||!e.player||!e.player.video.videoWidth&&!e.player.video.videoHeight)return null;const t=e.player.video,{videoWidth:r,videoHeight:n}=t,i=document.createElement("canvas"),o=i.getContext("2d");return r>n?(i.width=n,i.height=n,o.drawImage(t,(r-n)/2,0,n,n,0,0,n,n)):(i.width=r,i.height=r,o.drawImage(t,0,(n-r)/2,r,r,0,0,r,r)),i.toDataURL("image/png")},pr=()=>{if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)return navigator.mediaDevices.enumerateDevices().then(e=>({audio:e.filter(e=>"audioinput"===e.kind),video:e.filter(e=>"videoinput"===e.kind)}))},lr=e=>!e||!e.status||e.status.devices.audio!==w.UNMUTED,fr=e=>!e||!e.status||e.status.devices.video!==w.UNMUTED;function*hr(){yield Be(n.LICENSE_GET,(function*(e){try{let e=null;const{token:t}=yield ke(Ht);if(e=t||(yield ke(qt)),e){const e=yield TeeVidSdk.license.get();yield Re(tr.licenseSuccess(e))}}catch(e){yield Re(tr.licenseError(e))}yield})),yield Be(n.LICENSE_ERROR,(function*(e){yield Re(tr.generalError(e.error))})),yield Be(n.LICENSE_UPDATE,(function*({license:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.license.update(e);yield Re(tr.licenseUpdateSuccess(t))}}catch(e){yield Re(tr.generalError(e))}yield}))}function*mr(){yield Be(s.LOGIN_SUCCESS,(function*(){yield Re(tr.licenseGet()),yield Re(tr.storyboardFetchAll())}))}function*yr(){yield Be(n.USERS_FETCH_ALL,gr),yield Be(n.USER_CREATE,vr),yield Be(n.USER_EDIT,Er),yield Be(n.USER_DELETE,Sr)}function*gr(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.users.list();yield Re(tr.usersSuccessAll(e))}}catch(e){yield Re(tr.usersError(e))}}function*vr({data:e}){try{const{token:t}=yield ke(Ht);if(t){yield TeeVidSdk.users.create(e);yield Re(tr.userCreateSuccess())}}catch(e){yield Re(tr.userCreateError(e))}}function*Er({id:e,data:t}){try{const{token:r}=yield ke(Ht);if(r){yield TeeVidSdk.users.edit(e,t);yield Re(tr.userEditSuccess())}}catch(e){yield Re(tr.userEditError(e))}}function*Sr({name:e}){try{const{token:t}=yield ke(Ht);t&&(yield TeeVidSdk.users.remove(e),yield Re(tr.userDeleteSuccess()))}catch(e){yield Re(tr.userDeleteError(e))}}function*_r(){yield Be(n.ROOM_FETCH_ALL,br),yield Be(n.ROOM_CREATE,Tr),yield Be(n.ROOM_EDIT,Cr),yield Be(n.ROOM_DELETE,Rr)}function*br(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.rooms.list();yield Re(tr.roomsSuccessAll(e))}}catch(e){yield Re(tr.roomsError(e))}}function*Tr({data:e}){try{const{token:t}=yield ke(Ht);t&&(yield TeeVidSdk.rooms.create(e),yield Re(tr.roomCreateSuccess()))}catch(e){yield Re(tr.generalError(e))}}function*Cr({id:e,data:t}){try{const{token:r}=yield ke(Ht);r&&(yield TeeVidSdk.rooms.edit(e,t),yield Re(tr.roomEditSuccess()))}catch(e){yield Re(tr.generalError(e))}}function*Rr({name:e}){try{const{token:t}=yield ke(Ht);t&&(yield TeeVidSdk.rooms.remove(e),yield Re(tr.roomDeleteSuccess()))}catch(e){yield Re(tr.roomDeleteError(e))}}function*Ar(){yield Be(n.STORYBOARD_FETCH_ALL,Ir),yield Be(n.STORYBOARD_FETCH,Or),yield Be(n.STORYBOARD_THEMES_FETCH,kr),yield Be(n.STORYBOARD_SCENE_CREATE,Pr),yield Be(n.STORYBOARD_LOAD_PROGRESS,wr)}function*Or({stbId:e}){try{const{token:t,serverUrl:r}=yield ke(Ht),n=yield ke(qt),i=t||n;if(i){const{payload:t}=yield ar(r,i,"get",`/storyboard/${e}`);yield Re(tr.storyboardFetchSuccess(t))}}catch(e){yield Re(tr.storyboardError(e))}}function*Ir(){try{const{token:e,serverUrl:t}=yield ke(Ht),{name:r}=yield ke(Nt),n=yield ke(qt),i=e||n;if(i){const{payload:e}=yield ar(t,i,"get",`/storyboard?owner=${r}`);yield Re(tr.storyboardSuccessAll(e))}}catch(e){yield Re(tr.storyboardError(e))}}function*Pr({stbId:e,scene:t}){try{const{token:r}=yield ke(Ht);if(r){const r=yield TeeVidSdk.storyboards.sceneCreate(e,t);yield Re(tr.storyboardSceneCreateSuccess(r))}}catch(e){yield Re(tr.storyboardSceneCreateError(e))}}function*wr({percents:e}){try{e&&(yield Re(tr.storyboardLoadProgress(e)))}catch(e){yield Re(tr.storyboardLoadProgressError(e))}}function*kr(){try{const{token:e,serverUrl:t}=yield ke(Ht),r=yield ke(qt),n=e||r;if(n){const{payload:e}=yield ar(t,n,"get","/themes");yield Re(tr.storyboardThemesSuccess(e))}}catch(e){yield}}function*Mr(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.system.servers();yield Re(tr.serversSuccess(e))}}catch(e){yield Re(tr.serversError(e))}}function*Nr(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.system.liveMeetings();yield Re(tr.liveMeetingsSuccess(e))}}catch(e){yield Re(tr.liveMeetingsError(e))}}function*Dr(){yield Be(n.SERVERS_GET,Mr),yield Be(n.LIVE_MEETINGS_GET,Nr)}function*xr(){yield Be(n.SET_ADMIN_PORTAL,(function*({payload:e}){if(e){const{token:e}=yield ke(Ht),t=`wss://${yield ke(Bt)}/socket/moderation?token=${encodeURIComponent(e)}`,r=new WebSocket(t),n=function(e){return pt(t=>(e.onerror=e=>{t(e)},e.onmessage=r=>{let n=r.data;"_"===n?e.send(n):(n=JSON.parse(n),t(n))},()=>{e.close()}))}(r);yield Re(tr.adminSocket(r)),yield Pe(Ur,n)}else{const e=yield ke(e=>e.teevid.api.adminSocket);e&&1===e.readyState&&e.close(),yield Re(tr.adminSocket(null))}})),yield Be(n.DELETE_FROM_ROOM,(function*({roomId:e,participantId:t}){yield Lr(ir.kickParticipant,e,t)})),yield Be(n.ROOM_CLOSE,(function*({roomId:e}){yield Lr(ir.roomClose,e)}))}function*Lr(e,...t){const r=yield ke(e=>e.teevid.api.adminSocket),{token:n}=yield ke(Ht);if(r&&1===r.readyState&&e&&"function"==typeof e){const i=e(n,...t);r.send(JSON.stringify(i))}}function*Ur(e){yield Be(e,(function*(e){if(!e||"middleware"!==e.type)return void console.error("Missing or malformed message",e);let t=tr.noop();switch(e.data.method){case i:t=tr.serverStatus(e.data.params.status);break;case a:t=tr.mcuStats(e.data.params.instances);break;case o:t=tr.participantStats(e.data.params)}yield Re(t)}))}function*jr(){yield Be(n.REFRESH_MEDIA_DEVICES,(function*(){const e=yield pr();e?yield Re(tr.setMediaDevices(e)):yield Re(tr.setMediaDevices({audio:[],video:[]}))}))}function*Br(){yield Be(n.GET_TERMINATED_MEETINGS,(function*({data:e}){const{token:t}=yield ke(Ht);try{if(t){const t=yield TeeVidSdk.reports.meetings(e);yield Re(tr.getTerminatedMeetingsSuccess(t))}}catch(e){yield Re(tr.getTerminatedMeetingsError(e))}})),yield Be(n.GET_TERMINATED_PARTICIPANTS,(function*({data:e}){const{token:t}=yield ke(Ht);try{if(t){const t=yield TeeVidSdk.reports.participants(e);yield Re(tr.getTerminatedParticipantsSuccess(t))}}catch(e){yield Re(tr.getTerminatedParticipantsError(e))}}))}function*Fr(){yield Be(n.MS_FETCH_ALL,(function*(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.mediaServers.list();yield Re(tr.msSuccessAll(e))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MS_ADD,(function*({data:e}){try{const{token:t}=yield ke(Ht);t&&(yield TeeVidSdk.mediaServers.add(e),yield Re(tr.msAddSuccess()))}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MS_REMOVE,(function*({id:e}){try{const{token:t}=yield ke(Ht);t&&(yield TeeVidSdk.mediaServers.remove(e),yield Re(tr.msRemoveSuccess()))}catch(e){yield Re(tr.generalError(e))}}))}function*Vr(){yield Be(n.MCU_FETCH_ALL,(function*(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.mcu.list();yield Re(tr.mcuSuccessAll(e))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MCU_START,(function*({id:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.mcu.start(e);yield Re(tr.mcuStartSuccess(t))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MCU_STOP,(function*({id:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.mcu.stop(e);yield Re(tr.mcuStopSuccess(t))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MCU_KILL,(function*({id:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.mcu.kill(e);yield Re(tr.mcuKillSuccess(t))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MCU_RESTART,(function*({id:e}){try{const{token:t}=yield ke(Ht);t&&(yield TeeVidSdk.mcu.restart(e))}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.MCU_REMOVE,(function*({id:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.mcu.remove(e);yield Re(tr.mcuRemoveSuccess(t))}}catch(e){yield Re(tr.generalError(e))}}))}function*Gr(){yield Be(n.KURENTO_FETCH_ALL,(function*(){try{const{token:e}=yield ke(Ht);if(e){const e=yield TeeVidSdk.kurentoServers.list();yield Re(tr.kurentoSuccessAll(e))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.KURENTO_RESTART,(function*({payload:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.kurentoServers.restart(e);yield Re(tr.kurentoRestartedSuccess(t))}}catch(e){yield Re(tr.generalError(e))}})),yield Be(n.KURENTO_RESET,(function*({payload:e}){try{const{token:t}=yield ke(Ht);if(t){const t=yield TeeVidSdk.kurentoServers.reset(e);yield Re(tr.kurentoResetedSuccess(t))}}catch(e){yield Re(tr.generalError(e))}}))}var qr=function*(){yield Ae([hr(),mr(),Ar(),jr(),yr(),_r(),Br(),Dr(),xr(),Vr(),Fr(),Gr()])};const zr={userToken:localStorage.getItem("authToken")||"",serverUrl:"",profile:null,eventRoom:null};var Wr=(e=zr,{type:t,payload:r})=>{switch(t){case s.LOGOUT:return localStorage.clear(),Object.assign({},e,{userToken:"",profile:null});case s.USER_SET_PROFILE:return localStorage.setItem("currentTheme",r.theme),Object.assign({},e,{profile:r});case s.SET_SERVER_URL:return Object.assign({},e,{serverUrl:r});case s.UPDATE_TOKEN:return localStorage.setItem("authToken",r),Object.assign({},e,{userToken:r});case s.LOGIN_SUCCESS:return localStorage.setItem("currentTheme",r.theme),localStorage.setItem("authToken",r.token),Object.assign({},e,{profile:r.profile,userToken:r.token});case s.LOGIN_ERROR:return localStorage.removeItem("authToken"),Object.assign({},e,{profile:null,userToken:""});case s.STORYBOARD_SUCCESS_ALL:return Object.assign({},e,{storyboards:r});case s.SET_EVENT_ROOM:return Object.assign({},e,{eventRoom:r});default:return e}},Hr={setServerUrl:e=>({type:s.SET_SERVER_URL,payload:e}),updateToken:e=>({type:s.UPDATE_TOKEN,payload:e}),login:(e,t)=>({type:s.LOGIN,payload:{username:e,password:t}}),loginSuccess:(e,t)=>({type:s.LOGIN_SUCCESS,payload:{profile:e,token:t}}),setProfile:e=>({type:s.USER_SET_PROFILE,payload:e}),refreshProfile:()=>({type:s.USER_REFRESH_PROFILE}),loginError:(e,t)=>({type:s.LOGIN_ERROR,payload:e,noRedirect:t}),logout:()=>({type:s.LOGOUT}),editProfile:e=>({type:s.USER_EDIT_PROFILE,profile:e}),editProfileError:e=>({type:s.USER_EDIT_PROFILE_ERROR,error:e}),setEventRoom:e=>({type:s.SET_EVENT_ROOM,payload:e}),accessPinError:e=>({type:s.ACCESS_PIN_ERROR,payload:e}),ownerPinError:e=>({type:s.OWNER_PIN_ERROR,payload:e})};function*$r(){yield Be(s.LOGIN,(function*({payload:{username:e,password:t}}){e&&t||(yield Re(Hr.loginError({status:403,message:"bad-credentials"})));try{const{payload:r,token:n}=yield sr("post","/accesstokens",{username:e,password:t});yield Re(Hr.loginSuccess(r,n))}catch(e){yield Re(Hr.loginError(e))}}))}function*Yr(e){yield Be(s.USER_REFRESH_PROFILE,(function*(){try{const{token:e}=yield ke(Ht);if(e){const{payload:e}=yield sr("get","/users/me");yield Re(Hr.setProfile(e))}}catch(e){yield Re(Hr.loginError(e))}})),yield Be(s.USER_EDIT_PROFILE,(function*({profile:e}){try{const{token:t}=yield ke(Ht);t&&(yield sr("patch","/users/me",e),yield Re(Hr.refreshProfile()))}catch(e){yield Re(Hr.editProfileError(e))}}))}var Qr=function*(){yield Ae([$r(),Yr()])},Kr=Object.freeze({RECEIVE_STREAMING_STATUS:"teevid/viewer/receive-streaming-status",SEND_REQUEST_TO_PARTICIPATE:"teevid/viewer/send-request-to-participate",VIEWER_LEAVES_PLAYBACK_PAGE:"teevid/viewer/leaves_playback_page",REQUEST_TO_PARTICIPATE:"teevid/viewer/request-to-participate",REQUEST_TO_PARTICIPATE_ACCEPTED:"teevid/viewer/request-accepted",REQUEST_TO_PARTICIPATE_REJECTED:"teevid/viewer/request-rejected",OPEN_VIEWER_CHANNEL:"teevid/viewer/open-channel",CLOSE_VIEWER_CHANNEL:"teevid/viewer/close-channel",VIEWER_CHANNEL_OPENED:"teevid/viewer/channel-opened",VIEWER_CHANNEL_CLOSED:"teevid/viewer/channel-closed",REQUEST_TO_PARTICIPATE_SENT:"teevid/viewer/request-to-participate-sent",ACCEPT_REQUEST_TO_PARTICIPATE:"teevid/viewer/accept-request-to-participate",REJECT_REQUEST_TO_PARTICIPATE:"teevid/viewer/reject-request-to-participate",CLEAR_REQUEST_DATA:"teevid/viewer/clear-request-data",JOIN_TO_MEETING:"teevid/viewer/join-to-meeting",SET_STREAMING_STATE:"teevid/viewer/set-streaming-state",SET_MEETING_STATE:"teevid/viewer/set-meeting-state",SET_RECEIVED_STREAMING_STATE:"teevid/viewer/set-received-meeting-state",NOOP:"noop"});const Jr=Object.freeze({REQUEST_TO_PARTICIPATE_SENT:"request-to-participate-sent",ACCEPT_REQUEST_TO_PARTICIPATE:"accept-request-to-participate",REJECT_REQUEST_TO_PARTICIPATE:"reject-request-to-participate",MEETING_STATE:"meeting-state",SET_STREAMING_STATE:"streaming-state"}),Xr={guestToken:"",room:"",serverUrl:"",name:"",moderationSocket:null,sent:null,reason:null,accepted:null,participant:null,streamingState:2};var Zr=(e=Xr,{type:t,payload:r})=>{switch(t){case Kr.OPEN_VIEWER_CHANNEL:return Object.assign({},e,{room:r.roomId});case Kr.VIEWER_CHANNEL_OPENED:return Object.assign({},e,{moderationSocket:r});case Kr.REQUEST_TO_PARTICIPATE_SENT:case Kr.REQUEST_TO_PARTICIPATE_ACCEPTED:case Kr.REQUEST_TO_PARTICIPATE_REJECTED:return Object.assign({},e,r);case Kr.CLEAR_REQUEST_DATA:return Object.assign({},e,{sent:null,reason:"",accepted:null});case Kr.SET_MEETING_STATE:return Object.assign({},e,{streamingState:r.state.streamingState});case Kr.SET_RECEIVED_STREAMING_STATE:return Object.assign({},e,{streamingState:r.newState});default:return e}},en=Object.freeze({requestToParticipate:e=>({type:Kr.REQUEST_TO_PARTICIPATE,payload:e}),viewerLeavesPlaybackPage:e=>({type:Kr.VIEWER_LEAVES_PLAYBACK_PAGE,payload:e}),acceptRequestToParticipate:e=>({type:Kr.ACCEPT_REQUEST_TO_PARTICIPATE,payload:e}),requestToParticipateAccepted:e=>({type:Kr.REQUEST_TO_PARTICIPATE_ACCEPTED,payload:e}),rejectRequestToParticipate:e=>({type:Kr.REJECT_REQUEST_TO_PARTICIPATE,payload:e}),requestToParticipateRejected:e=>({type:Kr.REQUEST_TO_PARTICIPATE_REJECTED,payload:e}),noop:()=>({type:Kr.NOOP}),closeViewerChannel:e=>({type:Kr.CLOSE_VIEWER_CHANNEL,payload:e}),openViewerChannel:e=>({type:Kr.OPEN_VIEWER_CHANNEL,payload:e}),viewerChannelOpened:e=>({type:Kr.VIEWER_CHANNEL_OPENED,payload:e}),viewerChannelClosed:()=>({type:Kr.VIEWER_CHANNEL_CLOSED}),requestToParticipateSent:e=>({type:Kr.REQUEST_TO_PARTICIPATE_SENT,payload:e}),clearRequestData:()=>({type:Kr.CLEAR_REQUEST_DATA}),joinToMeeting:()=>({type:Kr.JOIN_TO_MEETING}),receiveStreamingStatus:e=>({type:Kr.RECEIVE_STREAMING_STATUS,payload:e}),setMeetingState:e=>({type:Kr.SET_MEETING_STATE,payload:e}),setReceivedStreamingState:e=>({type:Kr.SET_RECEIVED_STREAMING_STATE,payload:e})}),tn={setCurrentRoom:e=>({type:At.SET_CURRENT_ROOM,payload:e}),roomStats:e=>({type:At.STATS_ROOM,payload:e}),createParticipant:(e,t,r={},n)=>({type:At.CREATE_PARTICIPANT,payload:{room:e,username:t,pin:r,inviteToken:n}}),participantCreated:e=>({type:At.CREATE_PARTICIPANT_SUCCESS,payload:e}),participantCreationError:(e,t=0)=>({type:At.CREATE_PARTICIPANT_ERROR,payload:{error:e,state:t}}),addParticipant:e=>({type:At.CONNECTION_ADD_PARTICIPANT,payload:e}),addParticipantStream:e=>({type:At.CONNECTION_ADD_PARTICIPANT_STREAM,payload:e}),removeParticipant:e=>({type:At.CONNECTION_PARTICIPANT_REMOVED,payload:e}),kickParticipant:(e,t)=>({type:At.KICK_PARTICIPANT,roomId:e,participantId:t}),updateStats:e=>({type:At.STATS_PARTICIPANT,payload:e}),connect:()=>({type:At.CONNECT}),createConnection:e=>({type:At.CREATE_CONNECTION,payload:e}),connectionCreated:e=>({type:At.CREATE_CONNECTION_SUCCESS,payload:{connection:e}}),connectionCreationError:e=>({type:At.CREATE_CONNECTION_ERROR,payload:e}),connectionSuccess:e=>({type:At.CONNECTION_SUCCESS,connection:e}),connectionEvent:(e,t)=>({type:At.CONNECTION_EVENT,payload:{event:e,eventType:t}}),setOwnerPin:e=>({type:At.SET_OWNER_PIN,pin:e}),requestOwnerPin:e=>({type:At.REQUEST_OWNER_PIN,payload:{action:e}}),setConnectionState:(e=0)=>({type:At.SET_CONNECTION_STATE,payload:e}),setAccessPinRequirement:e=>({type:At.SET_ACCESS_PIN_REQ,payload:e}),connectionCancel:()=>({type:At.CONNECTION_CANCEL}),connectionReady:()=>({type:At.CONNECTION_READY}),moderationSocketCreated:e=>({type:At.MODERATION_SOCKET_CREATED,payload:e}),moderationServerReady:()=>({type:At.MODERATION_SERVER_READY}),connectionError:e=>({type:At.CONNECTION_ERROR,payload:e}),connectionRoomReady:()=>({type:At.ROOM_READY}),disconnect:(e="disconnection")=>({type:At.CONNECTION_DISCONNECT,payload:e}),disconnected:()=>({type:At.CONNECTION_DISCONNECTED}),sendSipState:e=>({type:At.SEND_SIP_STATE,payload:e}),setSipState:e=>({type:At.SET_SIP_STATE,payload:e}),participantStatusUpdated:e=>({type:At.STATUS_UPDATE,payload:e}),updateParticipantStatus:e=>({type:At.UPDATE_PARTICIPANT_STATUS,payload:e}),localStreamAdded:e=>({type:At.SDK_SET_LOCAL_STREAM,payload:e}),streamAdded:e=>({type:At.CONNECTION_STREAM_ADDED,payload:e}),streamRemoved:e=>({type:At.CONNECTION_STREAM_REMOVED,payload:e}),streamSubscribed:e=>({type:At.CONNECTION_STREAM_SUBSCRIBED,payload:e}),stopSharing:()=>({type:At.CONNECTION_STOP_SHARING}),startSharing:()=>({type:At.CONNECTION_START_SHARING}),mMessage:e=>({type:At.MODERATION_MESSAGE_RECEIVED,payload:e}),mMessageError:e=>({type:At.MODERATION_MESSAGE_ERROR,payload:e}),mSocketClosed:e=>({type:At.MODERATION_SOCKET_CLOSED,payload:e}),mSocketError:e=>({type:At.MODERATION_SOCKET_ERROR,payload:e}),noop:()=>({type:At.NOOP}),setMeetingState:e=>({type:At.SET_MEETING_STATE,payload:e}),setMeetingMode:e=>({type:At.MEETING_CHANGE_MODE,payload:e}),setMeetingLayout:e=>({type:At.MEETING_CHANGE_LAYOUT,payload:e}),setLayoutMode:e=>({type:At.MEETING_LAYOUT_MODE,payload:{layoutMode:e}}),setSlideNumber:e=>({type:At.MEETING_SLIDE_NUMBER,payload:{number:e}}),slideNumberChanged:e=>({type:At.MEETING_SLIDE_CHANGED,payload:{number:e}}),sendMeetingLayout:()=>({type:At.MEETING_SEND_LAYOUT}),roomConnected:()=>({type:At.ROOM_CONNECTED}),themesSuccessAll:e=>({type:At.THEMES_SUCCESS_ALL,themes:e}),themesFetchAll:()=>({type:At.THEMES_FETCH}),raiseHandRequest:e=>({type:At.RAISE_HAND_REQ,payload:e}),raiseHandUpdate:e=>({type:At.RAISE_HAND_UPDATE,payload:e}),raiseHandResponse:(e,t)=>({type:At.RAISE_HAND_RES,payload:{accepted:e,id:t}}),raiseHandResponseReceived:(e,t)=>({type:At.RAISE_HAND_RES_RECEIVED,payload:e,data:t}),setStreamingState:(e,t)=>({type:At.SET_STREAMING_STATE,payload:{state:e,message:t}}),startStreaming:()=>({type:At.STREAMING_START}),stopStreaming:()=>({type:At.STREAMING_STOP}),setSharingStream:e=>({type:At.SCREEN_SHARE_STARTED,payload:e}),setRemoteScreenStream:(e,t)=>({type:At.SCREEN_SHARE_SET_REMOTE,payload:{streamId:e,participantId:t}}),removeSharingStream:e=>({type:At.SCREEN_SHARE_STOPPED,payload:e}),getAvatar:e=>({type:At.PARTICIPANT_AVATAR_GET,participantId:e}),setAvatar:(e,t)=>({type:At.PARTICIPANT_AVATAR_SET,payload:{participantId:e,avatar:t}}),roleChanged:(e,t,r)=>({type:At.ROLE_CHANGED,payload:{participantId:e,data:{role:t,isRoomOwner:r}}}),ownerPinSuccess:(e,t,r,n)=>({type:At.OWNER_PIN_SUCCESS,payload:{participantId:e,data:{role:t,isRoomOwner:r,token:n}}}),ownerPinFailed:e=>({type:At.OWNER_PIN_FAILED,payload:e}),participantMuteUpdate:(e,t)=>({type:At.MUTE_UPDATED,payload:{participantId:e,mute:t}}),muteStream:()=>({type:At.MUTE_STREAM}),mute:e=>({type:At.MUTE_ALL,state:e}),muteAudio:e=>({type:At.MUTE_AUDIO,state:e}),muteVideo:e=>({type:At.MUTE_VIDEO,state:e}),moderatorUnmuteRequest:(e,t)=>({type:At.MODERATOR_UNMUTE_REQUEST,payload:{senderId:e,device:t}}),moderatorUnmuteResponse:(e,t)=>({type:At.MODERATOR_UNMUTE_RESPONSE,payload:{senderId:e,device:t}}),remoteMute:(e,t,r)=>({type:At.REMOTE_MUTE,participantId:e,device:t,state:r}),setMuteState:e=>({type:At.SET_MUTE_STATE,payload:e}),unmuteRequestSent:(e,t)=>({type:At.UNMUTE_REQUEST_SENT,payload:{participantId:e,device:t}}),setParticipantUnmuteRequest:(e,t)=>({type:At.PARTICIPANT_UNMUTE_REQUEST,senderId:e,request:t}),unmuteResponse:(e,t)=>({type:At.UNMUTE_RESPONSE,payload:{device:t,senderId:e}}),unmuteRequestAccepted:(e,t)=>({type:At.UNMUTE_REQUEST_ACCEPTED,participantId:e,request:t}),unmuteRequestDeclined:(e,t)=>({type:At.UNMUTE_REQUEST_DECLINED,participantId:e,request:t}),setVideoStateIndication:e=>({type:At.MUTE_VIDEO_STATE_INDICATION,state:e}),setAudioStateIndication:e=>({type:At.MUTE_AUDIO_STATE_INDICATION,state:e}),setChatDisabled:e=>({type:At.CHAT_DISABLE,state:e}),setScreenSharing:e=>({type:At.SET_SCREEN_SHARE,state:e}),setAudioDevices:e=>({type:At.SET_AUDIO_DEVICES,devices:e}),setVideoDevices:e=>({type:At.SET_VIDEO_DEVICES,devices:e}),setCurrentDevices:(e,t)=>({type:At.SET_CURRENT_DEVICES,devices:{video:e,audio:t}}),initMediaDevices:e=>({type:At.INIT_DEVICES,options:e}),sendMessage:e=>({type:At.SEND_MESSAGE,payload:e}),addChatMessage:e=>({type:At.ADD_CHAT_MESSAGE,payload:e}),sendTranscript:e=>({type:At.SEND_TRANSCRIPT,payload:e}),addTranscriptMessage:e=>({type:At.ADD_TRANSCRIPT_MESSAGE,payload:e}),turnOnSubtitles:e=>({type:At.TURN_ON_SUBTITLES,payload:e}),receiveSubtitlesRequest:e=>({type:At.RECEIVE_SUBTITLES_REQUEST,payload:e}),updateTranscript:e=>({type:At.UPDATE_TRANSCRIPT,payload:e}),shareTranscript:e=>({type:At.SHARE_TRANSCRIPT,payload:e}),receiveTranscript:e=>({type:At.RECEIVE_TRANSCRIPT,payload:e}),bfmOnPause:e=>({type:At.BFM_ON_PAUSE,payload:e}),setBfmPauseState:e=>({type:At.SET_BFM_PAUSE_STATE,payload:e}),applyLectureLayout:()=>({type:At.MEETING_LECTURE_LAYOUT_APPLY}),setLectureLayout:e=>({type:At.SET_LECTURE_LAYOUT,payload:{lectureLayout:e}}),updateLayoutGeometry:e=>({type:At.UPDATE_LAYOUT_GEOMETRY,payload:{geometry:e}}),updateLayoutParticipants:e=>({type:At.UPDATE_LAYOUT_PARTICIPANTS,payload:{selectedForLecture:e}}),updatePanelLayoutParticipants:e=>({type:At.UPDATE_PANEL_LAYOUT_PARTICIPANTS,payload:{selectedForLecture:e}}),selectForLecture:(e,t,r)=>({type:At.SELECT_FOR_LECTURE,payload:{participantId:e,tileId:t,previousParticipantId:r}}),selectForPanelMode:e=>({type:At.SELECT_FOR_PANEL_MODE,payload:{selectedForLecture:e}}),setMutedStatus:(e,t)=>({type:At.PARTICIPANT_MUTED,streamId:e,add:t}),changeParticipantName:(e,t)=>({type:At.PARTICIPANT_NAME_CHANGED,payload:{participantId:e,name:t}}),setSelectionForLecture:e=>({type:At.MEETING_LECTURE_SET_SELECTION,list:e}),lectureLayoutUpdate:e=>({type:At.MEETING_LECTURE_LAYOUT_UPDATE,action:e}),selectParticipantForLecture:(e,t)=>({type:At.MEETING_LECTURE_SELECT,id:e,index:t}),updateRole:(e,t)=>({type:At.PARTICIPANT_ROLE_UPDATE,action:e,pin:t}),updateRoleSuccess:()=>({type:At.PARTICIPANT_ROLE_UPDATE_SUCCESS}),setSlide:e=>({type:At.MEETING_SET_SLIDE,slideNumber:e}),setMode:(e,t=null)=>({type:At.MEETING_SET_MODE,payload:{mode:e,stbId:t}}),setModeRequest:e=>({type:At.MEETING_SET_MODE_REQUEST,mode:e}),setPresenterStream:e=>({type:At.MEETING_SET_PRESENTER_STREAM,streamId:e}),setInitStb:e=>({type:At.MEETING_INIT_STB,payload:e}),setScreenStream:e=>({type:At.MEETING_SET_SCREEN_STREAM,stream:e}),setQoe:(e,t)=>({type:At.STATS_QOE,participantId:e,qoe:t}),SDKMessage:e=>({type:At.SDK_MESSAGE,payload:e}),MWMessage:e=>({type:At.MW_MESSAGE,payload:e}),receivedRequestToParticipate:e=>({type:At.RECEIVED_REQUEST_TO_PARTICIPATE,payload:e}),voiceActivated:e=>({type:At.SDK_ACTIVATION,payload:e}),orderUpdate:e=>({type:At.SDK_ORDER_UPDATE,payload:e}),createLocalStream:()=>({type:At.SDK_CREATE_LOCAL_STREAM}),closeLocalStream:()=>({type:At.SDK_CLOSE_LOCAL_STREAM}),recordingStart:()=>({type:At.RECORDING_START}),recordingStarted:()=>({type:At.RECORDING_START_SUCCESS}),recordingStop:()=>({type:At.RECORDING_STOP}),recordingStopped:()=>({type:At.RECORDING_STOP_SUCCESS}),recordingFilesList:()=>({type:At.RECORDING_FILESLIST}),recordingFileRemove:e=>({type:At.RECORDING_FILE_REMOVE,filename:e}),setRecordingState:e=>({type:At.RECORDING_SET_STATE,payload:e}),setRecordingStateRemote:(e,t)=>({type:At.RECORDING_SET_STATE_REMOTE,payload:{state:e,message:t}}),getRoomRecordingsSize:e=>({type:At.GET_ROOM_RECORDINGS_SIZE,payload:e}),setRoomRecordingsSize:e=>({type:At.SET_ROOM_RECORDINGS_SIZE,payload:e})};const rn=e=>e.teevid.viewer.moderationSocket,nn=e=>e.teevid.viewer.participant;function*on(e,...t){const r=yield ke(rn),{token:n}=yield ke(Ht);r&&1===r.readyState&&r.send(JSON.stringify(e(n,...t)))}function*an(){yield Be(Kr.OPEN_VIEWER_CHANNEL,(function*({payload:{roomId:e}}){const t=yield ke(Bt),r=yield ke(zt),n=`wss://${t}/socket/moderation?token=${encodeURIComponent(r)}&roomId=${e}`,i=new WebSocket(n);i.onclose=e=>{TeeVidSdk.actions.logout()};const o=function(e){return pt(t=>(e.onerror=e=>{console.error(e)},e.onmessage=r=>{let n=r.data;n&&"_"===n?e&&1===e.readyState&&e.send(n):(n=JSON.parse(n),t(n))},()=>{e.close()}))}(i);yield Re(en.viewerChannelOpened(i)),yield function*(e){yield Be(Kr.CLOSE_VIEWER_CHANNEL,()=>{e.close()}),yield Be(e,(function*(e){const{method:t,params:r}=e.data;let n=en.noop();switch(t){case Jr.ACCEPT_REQUEST_TO_PARTICIPATE:n=en.requestToParticipateAccepted(r);break;case Jr.REJECT_REQUEST_TO_PARTICIPATE:n=en.requestToParticipateRejected(r);break;case Jr.REQUEST_TO_PARTICIPATE_SENT:n=en.requestToParticipateSent(r);break;case Jr.SET_STREAMING_STATE:n=en.setReceivedStreamingState(r);break;case Jr.MEETING_STATE:n=en.setMeetingState(r)}yield Re(n)}))}(o)}))}function*sn(){yield Be(Kr.REQUEST_TO_PARTICIPATE,(function*({payload:e}){e&&(yield on(ir.sendRequestToParticipate,e))}))}function*cn(){yield Be(Kr.VIEWER_LEAVES_PLAYBACK_PAGE,(function*({payload:e}){e&&(yield on(ir.leavePlaybackPage))}))}function*dn(){yield Be(Kr.ACCEPT_REQUEST_TO_PARTICIPATE,(function*({payload:e}){e&&(yield or(ir.acceptRequestToParticipate,{id:e}))}))}function*un(){yield Be(Kr.REJECT_REQUEST_TO_PARTICIPATE,(function*({payload:e}){e&&(yield or(ir.rejectRequestToParticipate,{id:e}))}))}function*pn(){yield Be(Kr.JOIN_TO_MEETING,(function*(){const e=yield ke(rn),t=yield ke(nn);yield Re(tn.setCurrentRoom(t.room)),yield Re(tn.participantCreated(t)),e&&3!==e.readyState&&e.close()}))}function*ln(){yield Ae([an(),sn(),dn(),un(),pn(),cn()])}var fn=r("./node_modules/lodash.omit/index.js"),hn=r.n(fn);const mn=e=>{let t;if(e){const{optimized_layout_full_quality:r,optimized_layout_threshold:n}=e;t=Object.assign({},P.default.geometry,{optimized_layout_full_quality:r,optimized_layout_threshold:n})}else t=Object.assign({},P.default.geometry);return{optimizedLayoutFullQuality:t.optimized_layout_full_quality,optimizedLayoutThreshold:t.optimized_layout_threshold}},yn={participantToken:"",participant:null,remoteParticipants:{},recording:{state:_,error:null},roomOptions:{enabledRecording:!0,enableChat:!1,hasAccessPin:!1,hasOwnerPin:!1},viewersRequests:[],layoutGeometry:mn(),room:null,connectionState:b,requiresAccessPin:!1,connection:null,streamStats:{},moderationSocket:null,sipCallState:{state:0,sipUri:""},mode:u,streams:{},streamingState:g,isConnected:!1,startTime:0,slideNumber:0,storyboardId:null,chatLog:[],lecturerId:null,transcript:[],subtitles:[],subtitlesLangs:[],selectedForLecture:[],lectureLayout:0,layoutMode:"auto",isPresenter:!1,bfmPaused:!1},gn=(e,t,r)=>{let n=e.slice();if(-1===n.indexOf(r)&&(n=[r,...n]),n.length===t)return n;n.length>t&&(n=[r,...n.filter(e=>-1===["stub",r].indexOf(e))],n=n.slice(0,t));for(let e=0;e<t;e++){n[e]||(n[e]="stub")}return n};var vn=(e=yn,{type:t,payload:r})=>{switch(t){case At.SET_SIP_STATE:return d()(e,{sipCallState:{$set:r}});case At.STATS_PARTICIPANT:return((e,t)=>{const r={};try{for(const n in t)if(t.hasOwnProperty(n)){const i=kt()(e,`streamStats.${n}`,[]).filter(e=>"stats-qoe"!==e.name);r[n]=[].concat(i,{value:kt()(t,`${n}.qoe`,0),name:"stats-qoe",label:"QOE"})}return d()(e,{streamStats:{$set:r}})}catch(t){return console.error(t),e}})(e,r);case At.SCREEN_SHARE_SET_REMOTE:return d()(e,{remoteParticipants:{[r.participantId]:{streams:{screenStreamId:{$set:r.streamId}}}}});case At.SCREEN_SHARE_STARTED:return d()(e,{participant:{streams:{screenStreamId:{$set:r}}}});case At.SET_STREAMING_STATE:return Object.assign({},e,{streamingState:r.state});case At.SET_ACCESS_PIN_REQ:return Object.assign({},e,{requiresAccessPin:r});case At.SET_CONNECTION_STATE:return Object.assign({},e,{connectionState:r});case At.STATS_ROOM:return((e,t)=>{const r={streamStats:{}};try{for(const n in t)if(t.hasOwnProperty(n)){const[i]=kt()(e,`streamStats.${n}`,[]).filter(e=>"stats-qoe"===e.name);r.streamStats[n]=i?{$set:[].concat(t[n].filter(e=>"stats-qoe"!==e.name),i)}:{$set:t[n]}}return d()(e,r)}catch(t){return console.error(t),e}})(e,r);case At.CONNECTION_PARTICIPANT_REMOVED:return d()(e,{remoteParticipants:{$unset:[r]}});case At.CONNECTION_STREAM_REMOVED:return((e,t)=>{const r=t.getID(),n={streams:{$unset:[r]}};if(r===kt()(e,"participant.streams.mediaStreamId"))n.participant={streams:{mediaStreamId:{$set:null}}};else for(const t in e.remoteParticipants)if(e.remoteParticipants.hasOwnProperty(t)){if(kt()(e,`remoteParticipants.${t}.streams.mediaStreamId`,"")===r){n.remoteParticipants={[t]:{streams:{mediaStreamId:{$set:null}}}};break}}return d()(e,n)})(e,r);case At.CONNECTION_STREAM_SUBSCRIBED:return r.getID()?d()(e,{streams:{[r.getID()]:{$set:r}}}):e;case At.CONNECTION_ADD_PARTICIPANT:return d()(e,{remoteParticipants:{[r.participant._id]:{$set:r.participant}}});case At.CONNECTION_ADD_PARTICIPANT_STREAM:return d()(e,{remoteParticipants:{[r.participantId]:{streams:{mediaStreamId:{$set:r.streamId}}}}});case At.SET_MEETING_STATE:return localStorage.setItem("partName",r.participants[e.participant._id].name),localStorage.setItem("roomId",e.room.id),Object.assign({},e,r.state,{remoteParticipants:hn()(r.participants,e.participant._id),participant:Object.assign({},e.participant,r.participants[e.participant._id]),roomOptions:Object.assign({},e.roomOptions,r.state.roomOptions)});case At.MEETING_CHANGE_MODE:return d()(e,{$merge:r.state});case At.MEETING_CHANGE_LAYOUT:return d()(e,{$merge:r});case At.ROOM_READY:return Object.assign({},e,{isConnected:!0,connectionState:T});case At.SDK_SET_LOCAL_STREAM:return((e,t)=>{let r=null;const n={};if(!e.participant)return e;if(t&&(r=t.getID()),null!==r)n.streams={[r]:{$set:t}};else{const t=kt()(e,"participant.streams.mediaStreamId",null);n.streams={$unset:[t]}}return n.localStreamId={$set:r},n.participant={streams:{mediaStreamId:{$set:r}}},d()(e,n)})(e,r);case At.MODERATION_SOCKET_CREATED:return Object.assign({},e,{moderationSocket:r});case At.CREATE_CONNECTION_SUCCESS:return Object.assign({},e,{connection:r.connection,connectionState:T});case At.MEETING_SET_MODE:return Object.assign({},e,{mode:r.mode,selectedForLecture:r.mode===l?[]:e.selectedForLecture,storyboardId:r.stbId,layoutGeometry:r.mode===u?mn(e.room):e.layoutGeometry,lecturerId:r.mode===u?null:e.participant?e.participant._id:null});case At.SET_LECTURE_LAYOUT:return Object.assign({},e,{lectureLayout:r.lectureLayout});case At.MEETING_LAYOUT_MODE:return r.layoutMode===f?Object.assign({},e,{layoutMode:r.layoutMode,lectureLayout:0}):Object.assign({},e,{layoutMode:r.layoutMode});case At.MEETING_SLIDE_NUMBER:case At.MEETING_SLIDE_CHANGED:return Object.assign({},e,{slideNumber:r.number});case At.UPDATE_LAYOUT_GEOMETRY:return Object.assign({},e,{layoutGeometry:r.geometry});case At.UPDATE_LAYOUT_PARTICIPANTS:const t=e.layoutGeometry.optimizedLayoutFullQuality+e.layoutGeometry.optimizedLayoutThreshold,n=e.lecturerId?e.lecturerId:e.participant._id;return Object.assign({},e,{selectedForLecture:gn(r.selectedForLecture||e.selectedForLecture,t,n)});case At.UPDATE_PANEL_LAYOUT_PARTICIPANTS:return Object.assign({},e,{selectedForLecture:r.selectedForLecture});case At.MUTE_UPDATED:let{participantId:i,mute:o}=r;return Object.assign({},d()(e,{remoteParticipants:{[i]:{status:{devices:{$set:o}}}}}));case At.UNMUTE_REQUEST_SENT:const a=e.remoteParticipants[r.participantId];return a?Object.assign({},d()(e,{remoteParticipants:{[r.participantId]:{status:{$merge:{unmuteRequest:Object.assign({},a.status.unmuteRequest||{},{[r.device]:!0})}}}}})):e;case At.MODERATOR_UNMUTE_REQUEST:return Object.assign({},d()(e,{participant:{status:{$merge:{unmuteRequest:Object.assign({},e.participant.status.unmuteRequest||{},r.device)}}}}));case At.MODERATOR_UNMUTE_RESPONSE:const s={};return r.device.hasOwnProperty("audio")&&(s.audio=!1),r.device.hasOwnProperty("video")&&(s.video=!1),Object.assign({},d()(e,{remoteParticipants:{[r.senderId]:{status:{unmuteRequest:{$merge:s}}}}}));case At.UNMUTE_RESPONSE:let c={};return r.device.hasOwnProperty("audio")&&(c.audio=!1),r.device.hasOwnProperty("video")&&(c.video=!1),e.participant.status.unmuteRequest?Object.assign({},d()(e,{participant:{status:{unmuteRequest:{$merge:c}}}})):Object.assign({},d()(e,{participant:{status:{$merge:{unmuteRequest:c}}}}));case At.SET_MUTE_STATE:return Object.assign({},d()(e,{participant:{status:{$set:Object.assign({},e.participant.status,{devices:r})}}}));case At.STATUS_UPDATE:return e.participant.status?d()(e,{participant:{status:{$merge:r}}}):Object.assign({},e,{participant:Object.assign({},e.participant,{status:r})});case At.REQUEST_OWNER_PIN:return Object.assign({},e,{requestOwnerPinAction:r.action});case At.OWNER_PIN_SUCCESS:return e.participant._id===r.participantId?d()(e,{participant:{$merge:r.data},participantToken:{$set:r.data.token}}):Object.assign({},d()(e,{remoteParticipants:{[r.participantId]:{$merge:r.data}}}));case At.ROLE_CHANGED:return e.participant._id===r.participantId?d()(e,{participant:{$merge:r.data}}):Object.assign({},d()(e,{remoteParticipants:{[r.participantId]:{$merge:r.data}}}));case At.PARTICIPANT_NAME_CHANGED:return e.participant._id===r.participantId?d()(e,{participant:{name:{$set:r.name}}}):Object.assign({},d()(e,{remoteParticipants:{[r.participantId]:{name:{$set:r.name}}}}));case At.PARTICIPANT_AVATAR_SET:return e.participant._id===r.participantId?d()(e,{participant:{avatar:{$set:r.avatar}}}):Object.assign({},d()(e,{remoteParticipants:{[r.participantId]:{avatar:{$set:r.avatar}}}}));case At.SET_CURRENT_ROOM:return Object.assign({},e,{room:r});case At.RECORDING_SET_STATE:return Object.assign({},d()(e,{recording:{state:{$set:r}}}));case At.RECORDING_SET_STATE_REMOTE:return Object.assign({},d()(e,{recording:{$set:r.state}}));case At.CREATE_PARTICIPANT_SUCCESS:return Object.assign({},e,{participant:r,participantToken:kt()(r,"token","")});case At.CONNECTION_DISCONNECTED:return Object.assign({},e,yn);case At.CREATE_PARTICIPANT_ERROR:return Object.assign({},e,{connectionState:r.state});case At.ADD_CHAT_MESSAGE:case At.SEND_MESSAGE:return Object.assign({},e,{chatLog:[].concat(e.chatLog,r)});case At.ADD_TRANSCRIPT_MESSAGE:case At.SEND_TRANSCRIPT:const p=((e,{authorId:t,result:r,time:n})=>{const{remoteParticipants:i,participant:o}=e;return{author:o&&o._id===t?o:i[t],message:r,time:n,translations:""}})(e,r);return Object.assign({},e,{transcript:[].concat(e.transcript,p)});case At.SHARE_TRANSCRIPT:case At.RECEIVE_TRANSCRIPT:return Sn(e,r);case At.RECEIVE_SUBTITLES_REQUEST:case At.TURN_ON_SUBTITLES:return e.subtitlesLangs.includes(r.value)?e:Object.assign({},e,{subtitlesLangs:[].concat(e.subtitlesLangs,r.value)});case At.RAISE_HAND_REQ:case At.RAISE_HAND_RES_RECEIVED:return bn(e,r);case At.RAISE_HAND_UPDATE:return Tn(e,r);case At.RECEIVED_REQUEST_TO_PARTICIPATE:return _n(e,r);case At.SET_BFM_PAUSE_STATE:case At.BFM_ON_PAUSE:return Object.assign({},e,{bfmPaused:r});case At.SDK_ORDER_UPDATE:return En(e,r);default:return e}};const En=(e,t)=>{const r={};t.hasOwnProperty(e.participant._id)&&(r.participant={order:{$set:t[e.participant._id]}}),Object.keys(t).length>1&&(r.remoteParticipants={});for(const n in t)e.remoteParticipants.hasOwnProperty(n)&&(r.remoteParticipants[n]={order:{$set:t[n]}});return d()(e,r)},Sn=(e,t)=>{const r=kt()(e,"participant._id");if(r){const n=((e,t,r,n)=>{const{subtitles:i,participantId:o}=t,{remoteParticipants:a,participant:{name:s}}=e;let c="",d={};if(o===r)d[o]={subtitles:i,name:s},c=s;else{const e=a[o]&&a[o].name;d[o]={subtitles:i,name:e},c=e}return{subtitles:i,name:c}})(e,t,r);return Object.assign({},e,{subtitles:[].concat(e.subtitles,n)})}return e},_n=(e,t)=>{const{username:r,question:n,id:i}=t.data.params,{participant:{role:o,isRoomOwner:a}}=e;if("Moderator"===o||a){const t=(new Date).getTime(),o=[].concat(e.viewersRequests,{username:r,question:n,time:t,id:i});return Object.assign({},e,{viewersRequests:o})}return e},bn=(e,t)=>Object.assign({},e,{participant:Object.assign({},e.participant,{status:Object.assign({},e.participant.status,{handRaised:t})})}),Tn=(e,t)=>{const{participantId:r,state:n}=t;return Object.assign({},e,{remoteParticipants:Object.assign({},e.remoteParticipants,{[r]:Object.assign({},e.remoteParticipants[r],{status:Object.assign({},e.remoteParticipants[r].status,{handRaised:n})})})})};var Cn=r("./sdk/libs/erizo.js"),Rn=r.n(Cn);function An(e){if(!e)return"- bps";let t;return e<1e3?t="bps":e<1e6?(t="kbps",e/=1e3):(t="Mbps",e/=1e6),e.toPrecision(3)+" "+t}function On(e){return e||0===e?parseFloat(e).toFixed(0)+" ms":""}function In(e){return e/2>=500?1:e/2>=400?2:e/2>=300?3:e/2>=200?4:5}function Pn(e,t,r){return 8*function(e,t,r){let n=e.stat(r),i=t?t.stat(r):null;return n&&i?(n-i)/(e.timestamp-t.timestamp)*1e3:null}(e,t,r)}class wn{constructor(e){this.stream=e,this.getRawStats=this.getRawStats.bind(this)}getRawStats(){return new Promise((e,t)=>this.stream.pc?this.stream.pc.peerConnection.getStats().then(t=>{e(t)}):t("invalid stream"))}compute(){let e;return this._rawStats?(this._prevRawStats=this._rawStats,e=Promise.resolve(!0)):e=this.getRawStats().then(e=>{new Promise(t=>{setTimeout(()=>{this._prevRawStats=e,t(!0)},500)})}),e.then(this.getRawStats).then(e=>{this._rawStats=e;let t=[];this.stream.simulcastLayers&&this.stream.simulcastLayers>1&&t.push({label:"Simulcast Layers",name:"stats-simulcast-layers",direction:"tx",value:this.stream.simulcastLayers});let r=0;return e.forEach(e=>{let n,i;if(0===e.id.indexOf("outbound_"))n="tx";else{if(0!==e.id.indexOf("inbound_"))return;n="rx"}let o=e;switch(o.mediaType){case"video":i="Video";break;case"audio":i="Audio"}if(o.roundTripTime&&o.roundTripTime>r?r=1e3*o.roundTripTime:o.currentRoundTripTime&&o.currentRoundTripTime>r&&(r=1e3*o.currentRoundTripTime),o.bitrateMean&&o.bitrateMean>0&&t.push({label:i+" BW",name:"stats-"+o.mediaType+"-bw",direction:n,value:o.bitrateMean,formatted:An(o.bitrateMean)}),o.bytesSent&&o.bytesSent>0&&"audio"===o.mediaType){let e=function(e,t){let r=e.bytesSent,n=t?t.bytesSent:null;return r&&n?(e.bytesSent-t.bytesSent)/(e.timestamp-t.timestamp)*1e3*8:null}(o,function(e,t,r,n,i){let o;e&&e.forEach(e=>{if(e.type===t&&e.mediaType===r){let t=!0;if(n){let r=e[n];t=void 0!==i?r===i:r,t&&(o=e)}}});return o}(this._prevRawStats,o.type,o.mediaType,"bytesSent"));t.push({label:"Audio BW",name:"stats-audio-bw",direction:n,value:o.bytesSent,formatted:An(e)})}}),r>0&&(t.unshift({label:"RTT",name:"stats-rtt",value:r,formatted:On(r)}),t.unshift({label:"QOE",name:"stats-qoe",value:In(r)})),t})}}class kn{constructor(e){this.stream=e}getRawStats(){return new Promise((e,t)=>{if(!this.stream.pc)return t("invalid stream");this.stream.pc.peerConnection.getStats(t=>e(t.result()))})}compute(){let e;return this._rawStats?(this._prevRawStats=this._rawStats,e=Promise.resolve(!0)):e=this.getRawStats().then(e=>{new Promise(t=>{setTimeout(()=>{this._prevRawStats=e,t(!0)},500)})}),e.then(()=>this.getRawStats()).then(e=>{this._rawStats=e;let t=[],r=function(e,t,r){const n=function(e,t,r){let n=Mn(e,t,r);return n&&-1!==n.names().indexOf(r)?n.stat(r):null}(e,t,r);if(n){let e=parseInt(n);if(-1!==e)return e}return null}(this._rawStats,"ssrc","googRtt");null!==r&&(t.push({label:"QOE",name:"stats-qoe",value:In(r)}),t.push({label:"RTT",name:"stats-rtt",value:r,formatted:On(r)})),this.stream.simulcastLayers&&this.stream.simulcastLayers>1&&t.push({label:"Simulcast Layers",name:"stats-simulcast-layers",direction:"tx",value:this.stream.simulcastLayers});let n=Mn(this._rawStats,"ssrc","audioInputLevel"),i=Mn(this._prevRawStats,"ssrc","audioInputLevel");if(n){let e=n.stat("googCodecName");t.push({label:"Audio Codec",name:"stats-audio-codec",direction:"tx",value:e});let r=Pn(n,i,"bytesSent");r>0&&t.push({label:"Audio BW",name:"stats-audio-bw",direction:"tx",value:r,formatted:An(r)})}let o=Mn(this._rawStats,"ssrc","audioOutputLevel"),a=Mn(this._prevRawStats,"ssrc","audioOutputLevel");if(o){let e=o.stat("googCodecName");t.push({label:"Audio Codec",name:"stats-audio-codec",direction:"rx",value:e});let r=Pn(o,a,"bytesReceived");r>0&&t.push({label:"Audio BW",name:"stats-audio-bw",direction:"rx",value:r,formatted:An(r)});let n=o.stat("googCurrentDelayMs");t.push({label:"Audio Delay",name:"stats-audio-delay",direction:"rx",value:n,formatted:On(n)})}let s=Mn(this._rawStats,"ssrc","googFirsReceived"),c=Mn(this._prevRawStats,"ssrc","googFirsReceived");if(s){let e=s.stat("googCodecName");t.push({label:"Video Codec",name:"stats-video-codec",direction:"tx",value:e});let r=s.stat("googFrameHeightSent"),n=s.stat("googFrameRateSent");t.push({label:"Video Resolution",name:"stats-video-resolution",direction:"tx",value:r+"p"+n});let i=Pn(s,c,"bytesSent");i>0&&t.push({label:"Video BW",name:"stats-video-bw",direction:"tx",value:i,formatted:An(i)})}let d=Mn(this._rawStats,"ssrc","googFirsSent"),u=Mn(this._prevRawStats,"ssrc","googFirsSent");if(d){let e=d.stat("googCodecName");t.push({label:"Video Codec",name:"stats-video-codec",direction:"rx",value:e});let r=d.stat("googFrameHeightReceived"),n=d.stat("googFrameRateDecoded");t.push({label:"Video Resolution",name:"stats-video-resolution",direction:"rx",value:r+"p"+n});let i=Pn(d,u,"bytesReceived");i>0&&t.push({label:"Video BW",name:"stats-video-bw",direction:"rx",value:i,formatted:An(i)});let o=d.stat("googCurrentDelayMs");t.push({label:"Video Delay",name:"stats-video-delay",direction:"rx",value:o,formatted:On(o)})}return t})}}function Mn(e,t,r,n){if(e)for(let i=0;i<e.length;++i){let o=e[i];if(o.type===t){let e=!0;if(r){let t="id"===r?o.id:o.stat(r);e=void 0!==n?t===n:t}if(e)return o}}}function Nn(e){if(Nn._instances||(Nn._instances={}),!e)return Promise.reject("stream is null");let t=Nn._instances[e.getID()];return t?t.stream.pc||(t.stream=e):(t=window.chrome||-1!==window.navigator.userAgent.indexOf("Chrome")?new kn(e):new wn(e),Nn._instances[e.getID()]=t),t.compute()}function*Dn(){const e=yield ke(Lt),t=yield ke(xt),r=yield ke(Mt),n={},i=kt()(r,"streams.mediaStreamId"),o=kt()(r,"streams.screenStreamId");if(n[r._id]=[],i){const e=t[r.streams.mediaStreamId];e&&(n[r._id]=yield Nn(e).catch((function(e){return[]})));const i=n[r._id].reduce(xn,{qoe:0,videoResolution:0,bandwidth:0});yield or(ir.stats,i)}if(o){const e=t[r.streams.screenStreamId];if(e){const t=yield Nn(e).catch((function(e){return[]}));t.length&&t.forEach(e=>{switch(e.name){case"stats-video-resolution":e.name="screen-video-resolution",e.label="Screen Resolution";break;case"stats-video-bw":e.name="screen-video-bw",e.label="Screen Bandwidth";break;default:return}n[r._id].push(e)})}}for(const r in e){const i=kt()(e,`${r}.streams.mediaStreamId`);if(e.hasOwnProperty(r)&&i){const e=t[i];n[r]=e?yield Nn(e).catch((function(e){return[]})):[]}}yield Re(tn.roomStats(n))}const xn=(e,t)=>{switch(t.name){case"stats-qoe":e.qoe=t.value;break;case"stats-video-resolution":e.videoResolution=t.value;break;case"stats-video-bw":e.bandwidth=t.value;break;case"stats-audio-codec":e.audioCodec=t.value;break;case"stats-video-codec":e.videoCodec=t.value}return e},Ln="room-connected",Un="stream-added",jn="stream-subscribed",Bn="stream-removed",Fn="room-error",Vn="room-disconnected";function*Gn(){const{room:e,globalConfigs:t,lectureLayout:r,mode:n,layoutMode:i}=yield ke(Yt),o=isNaN(t.optimized_layout_full_quality)?1:parseInt(t.optimized_layout_full_quality),a=isNaN(t.optimized_layout_threshold)?1:parseInt(t.optimized_layout_threshold),s=Object.assign({optimizedLayoutFullQuality:o,optimizedLayoutThreshold:a},(e=>{let t;if(e){const{optimized_layout_full_quality:r,optimized_layout_threshold:n}=e;t=Object.assign({},P.default.geometry,{optimized_layout_full_quality:isNaN(r)?1:parseInt(r),optimized_layout_threshold:isNaN(n)?1:parseInt(n)})}else t=Object.assign({},P.default.geometry);return{optimizedLayoutFullQuality:t.optimized_layout_full_quality,optimizedLayoutThreshold:t.optimized_layout_threshold}})(e));return n!==p&&!r||i!==h?s:{optimizedLayoutFullQuality:P[r]?P[r].geometry.optimized_layout_full_quality:s.optimizedLayoutFullQuality,optimizedLayoutThreshold:P[r]?P[r].geometry.optimized_layout_threshold:s.optimizedLayoutThreshold}}function*qn(){const e=yield Gn();yield Re(tn.updateLayoutGeometry(e)),yield Re(tn.updateLayoutParticipants()),yield Me(500),yield Re(tn.sendMeetingLayout())}function*zn(){const e=yield ke(Gt);if(e===p||e===l){const e=yield ke(Kt);yield or(ir.setLayout,e)}yield}function*Wn(){if(yield ke(Mt)){const e=yield Gn();yield Re(tn.updateLayoutGeometry(e)),yield Re(tn.updateLayoutParticipants());const t=yield ke(Qt);yield or(ir.setMode,t)}}function*Hn({payload:e}){const t=yield ke(Qt),r=yield ke(Mt);let n=null,i=null;if(t.lecturerId&&t.lecturerId!==r._id)return yield;const o=t.selectedForLecture[e.tileId],a=t.selectedForLecture.indexOf(e.participantId);if(o===r._id&&(-1===a||"stub"===e.participantId))return yield;if("stub"===o||-1!==a&&"stub"!==e.participantId||(n=o),-1===a&&(i=e.participantId),-1!==a&&"stub"!==e.participantId&&(t.selectedForLecture[a]=o),t.selectedForLecture[e.tileId]=e.participantId,yield Re(tn.updateLayoutParticipants(t.selectedForLecture)),t.mode===p&&(n&&(yield or(ir.mute,r._id,n,{audio:w.MUTED_BY_MODER,video:w.MUTED_BY_MODER})),i)){const e=yield ke(Jt,i),t=kt()(e,"status.devices",{audio:w.NO_DEVICE,video:w.NO_DEVICE}),n={};-1!==[w.MUTED_BY_MODER,w.MUTED].indexOf(t.audio)&&(yield Re(tn.unmuteRequestSent(i,"audio")),n.audio=!0),-1!==[w.MUTED_BY_MODER,w.MUTED].indexOf(t.video)&&(yield Re(tn.unmuteRequestSent(i,"video")),n.video=!0),Object.keys(n).length&&(yield or(ir.unmuteRequest,r._id,i,n))}yield Re(tn.sendMeetingLayout())}function*$n({payload:{selectedForLecture:e}}){const t=yield ke(Qt),r=yield ke(Mt);yield Re(tn.updatePanelLayoutParticipants(e)),t.mode===l&&(yield e.map(e=>or(ir.mute,r._id,e,{audio:w.UNMUTED,video:w.UNMUTED})))}function*Yn({payload:e}){let t=[];const r=yield ke(Mt),n=yield ke(Lt),i=yield Gn();t.push(Re(tn.updateLayoutGeometry(i))),Object.keys(e.mutedState).forEach(i=>{r._id!==i?JSON.stringify(n[i].status.devices)!==JSON.stringify(e.mutedState[i])&&t.push(Re(tn.participantMuteUpdate(i,e.mutedState[i]))):JSON.stringify(r.status.devices)!==JSON.stringify(e.mutedState[i])&&t.push(Re(tn.mute(e.mutedState[i])))}),yield Ae(t)}function*Qn({payload:e}){if(e.state.mode===l&&e.state.storyboardId){const t=yield ke($t);t.storyboard&&t.storyboard._id!==e.state.storyboardId&&0!==t.slidenumber&&(yield Re(tn.setSlideNumber(0))),yield Re(tr.storyboardFetch(e.state.storyboardId))}yield}function*Kn(){const e=yield Gn();yield Re(tn.updateLayoutGeometry(e))}function*Jn({payload:{number:e}}){yield or(ir.setSlide,e)}function*Xn(){yield Fe(At.SET_LECTURE_LAYOUT,qn),yield Fe(At.MEETING_LAYOUT_MODE,qn),yield Fe(At.CREATE_PARTICIPANT_SUCCESS,qn),yield Fe(At.MEETING_CHANGE_LAYOUT,Kn),yield Fe(At.MEETING_SET_MODE,Wn),yield Fe(At.MEETING_CHANGE_MODE,Yn),yield Fe(At.MEETING_CHANGE_MODE,Qn),yield Fe(At.SELECT_FOR_LECTURE,Hn),yield Fe(At.SELECT_FOR_PANEL_MODE,$n),yield Fe(At.MEETING_SEND_LAYOUT,zn),yield Fe(At.SET_MEETING_STATE,Qn),yield Fe(At.MEETING_SLIDE_NUMBER,Jn)}function*Zn(){yield Be(At.MUTE_ALL,(function*({state:e}){if(yield ke(Mt)){const t=yield ke(Dt);e.hasOwnProperty("audio")&&(t.audio=e.audio),e.hasOwnProperty("video")&&(t.video=e.video),yield Re(tn.setMuteState(t)),yield Re(tn.muteStream()),yield or(ir.muteUpdate,t)}})),yield Be(At.MUTE_AUDIO,(function*({state:e}){const t=yield ke(Dt);let r;r="number"==typeof e?Object.assign({},t,{audio:e}):Object.assign({},t,e),yield Re(tn.mute(r))})),yield Be(At.MUTE_VIDEO,(function*({state:e}){const t=yield ke(Dt);let r;r="number"==typeof e?Object.assign({},t,{video:e}):Object.assign({},t,e),yield Re(tn.mute(r))})),yield Be(At.REMOTE_MUTE,(function*({participantId:e,device:t,state:r}){const n=yield ke(Mt);0!==r?yield or(ir.mute,n._id,e,{[t]:r}):yield Ae([Re(tn.unmuteRequestSent(e,t)),or(ir.unmuteRequest,n._id,e,{[t]:r})])})),yield Be(At.UNMUTE_RESPONSE,(function*({payload:{device:e,senderId:t}}){const r=yield ke(Mt);e.hasOwnProperty(Ot)&&e[Ot]&&(yield Re(tn.muteAudio(w.UNMUTED))),e.hasOwnProperty(It)&&e[It]&&(yield Re(tn.muteVideo(w.UNMUTED))),yield or(ir.unmuteResponse,t,r._id,e)}))}function*ei(){yield Fe(At.MUTE_STREAM,(function*(){const e=yield ke(Mt);if(e){const t=TeeVidSdk.localStream,r=(e=>lr(e)&&fr(e))(e);yield ke(Gt),yield ke(er,e.id);if(t){r&&TeeVidSdk.canPublish;const n=lr(e),i=fr(e);t.hasAudio()&&t.muteAudio(n),t.hasVideo()&&t.stream&&t.stream.getVideoTracks().forEach(e=>{e.enabled=!i})}else if(!t&&!r){const{connectionState:e}=yield ke(e=>e.teevid.meeting);e!==T&&(yield Re(tn.createLocalStream()))}}}))}function*ti(){yield Be(At.SEND_MESSAGE,(function*({payload:e}){e&&(yield or(ir.chat,e))}))}function*ri(){yield Be(At.SEND_TRANSCRIPT,(function*({payload:e}){e&&(yield or(ir.sendTranscript,e))}))}function*ni(){yield Be(At.SHARE_TRANSCRIPT,(function*({payload:e}){e&&(yield or(ir.shareTranscript,e))}))}function*ii(){yield Be(At.BFM_ON_PAUSE,(function*({payload:e}){yield or(ir.bfmOnPause,e)}))}function*oi(){yield Be(At.TURN_ON_SUBTITLES,(function*({payload:e}){e&&(yield or(ir.turnOnSubtitles,e))}))}function*ai(){yield Be(At.STATUS_UPDATE,(function*({payload:e}){e&&(yield or(ir.participantStatusUpdated,e))}))}function*si(){yield Be(s.LOGIN_SUCCESS,(function*(){const e=yield ke(Ht);yield or(ir.getRole,e.token)})),yield Be(s.LOGOUT,(function*(){yield or(ir.getRole,null)})),yield Be(At.SET_OWNER_PIN,(function*({pin:e}){yield or(ir.setOwnerPin,e)})),yield Be(At.PARTICIPANT_NAME_CHANGED,(function*({payload:{participantId:e,name:t}}){const r=yield ke(Mt);e&&r._id===e&&(yield or(ir.changeParticipantName,e,t))})),yield Be(At.KICK_PARTICIPANT,(function*({roomId:e,participantId:t}){yield or(ir.kickParticipant,e,t)}))}function*ci(){yield Be(At.SDK_SET_LOCAL_STREAM,(function*({payload:e}){e?(yield Re(tn.muteStream()),yield or(ir.publishStream,e.getID())):yield or(ir.publishStream,null)}))}function*di(){yield Be(At.RAISE_HAND_REQ,(function*({payload:e}){yield or(ir.raiseHand,!!e)}))}function*ui(){yield Be(At.RAISE_HAND_RES,(function*({payload:e}){if(e.accepted){const t=yield ke(Mt);yield Ae([or(ir.raiseHandAccept,e.id),or(ir.mute,t._id,e.id,{audio:w.UNMUTED,video:w.UNMUTED})])}else yield or(ir.raiseHandDecline,e.id)}))}function*pi(){yield Be(At.SCREEN_SHARE_STARTED,(function*({payload:e}){e&&(yield Re(tn.muteStream())),yield or(ir.publishScreenStream,e)}))}function*li({payload:e}){const t=yield ke(Mt),r=yield ke(Lt);for(const n in e)e.hasOwnProperty(n)&&(t._id!==n||t.avatar?r.hasOwnProperty(n)&&!r[n].avatar&&(fr(r[n])||(yield Re(tn.getAvatar(n)))):fr(t)||(yield Re(tn.getAvatar(t._id))))}function*fi(){yield Be(At.STATS_PARTICIPANT,li)}function*hi(){yield Be(At.SEND_SIP_STATE,mi)}function*mi({payload:{sipUri:e,room:t,state:r,isEncrypted:n}}){yield Re(tn.setSipState({sipUri:e,room:t,state:r})),yield or(ir.sendToSip,e,t,r,n)}function*yi(){yield Be(At.PARTICIPANT_AVATAR_GET,(function*({participantId:e}){const t=yield ke(Xt,e);if(t&&kt()(t,"player.video.videoWidth")&&kt()(t,"player.video.videoHeight")){const r=ur(t);r&&(yield Re(tn.setAvatar(e,r)))}}))}function*gi(e){yield Be(e,(function*(e){if(!e||"web"!==e.type)return void console.error("Missing or malformed message");let t=tn.noop();switch(e.data.method){case rr.READY:console.info("Handler ID: ",e.data.params),t=tn.moderationServerReady();break;case rr.MEETING_STATE:t=tn.setMeetingState(e.data.params);break;case rr.RECORDING_STATE:t=tn.setRecordingStateRemote(e.data.params.newState,e.data.params.message);break;case rr.MEETING_SET_MODE:t=tn.setMeetingMode(e.data.params);break;case rr.LECTURE_LAYOUT:t=tn.setMeetingLayout(e.data.params);break;case rr.LECTURE_SLIDE_NUMBER:t=tn.slideNumberChanged(e.data.params.number);break;case rr.PARTICIPANT_ADDED:t=tn.addParticipant(e.data.params);break;case rr.PARTICIPANT_PUBLISHED:t=tn.addParticipantStream(e.data.params);break;case rr.PARTICIPANT_NAME_CHANGED:t=tn.changeParticipantName(e.data.params.participantId,e.data.params.name);break;case rr.PARTICIPANT_REMOVED:t=tn.removeParticipant(e.data.params.participantId);break;case rr.DISCONNECT:t=tn.disconnect("kick");break;case rr.MUTE_UPDATE:if((yield ke(Mt))._id!==e.data.params.participantId){(yield ke(Jt,e.data.params.participantId))&&(t=tn.participantMuteUpdate(e.data.params.participantId,e.data.params.mute))}break;case rr.MUTE:const r=e.data.params.state;r.hasOwnProperty("audio")&&r.hasOwnProperty("video")?t=tn.mute(r):r.hasOwnProperty("audio")?t=tn.muteAudio(r.audio):r.hasOwnProperty("video")&&(t=tn.muteVideo(r.video));break;case rr.UNMUTE_REQUEST:const n={};e.data.params.state.hasOwnProperty("audio")&&(n.audio=!!e.data.params.state.audio),e.data.params.state.hasOwnProperty("video")&&(n.video=!!e.data.params.state.video),Object.keys(n).length&&(t=tn.moderatorUnmuteRequest(e.data.params.senderId,n));break;case rr.UNMUTE_RESPONSE:t=tn.moderatorUnmuteResponse(e.data.params.senderId,e.data.params.state);break;case rr.OWNER_PIN_SUCCESS:t=tn.ownerPinSuccess(e.data.params.participantId,e.data.params.role,e.data.params.isRoomOwner,e.data.params.token);break;case rr.OWNER_PIN_FAILED:t=tn.ownerPinFailed(e.data.params);break;case rr.ROLE_CHANGED:t=tn.roleChanged(e.data.params.participantId,e.data.params.role,e.data.params.isRoomOwner);break;case rr.CHAT:(yield ke(Mt))._id!==e.data.params.authorId&&(t=tn.addChatMessage(e.data.params));break;case rr.SEND_TRANSCRIPT:(yield ke(Mt))._id!==e.data.params.authorId&&(t=tn.addTranscriptMessage(e.data.params));break;case rr.SHARE_TRANSCRIPT:(yield ke(Mt))._id!==e.data.params.participantId&&(t=tn.receiveTranscript(e.data.params));break;case rr.TURN_ON_SUBTITLES:(yield ke(Mt))._id!==e.data.params.participantId&&(t=tn.receiveSubtitlesRequest(e.data.params));break;case rr.STATUS_UPDATE:(yield ke(Mt))._id!==e.data.params.participantId&&(t=tn.updateParticipantStatus(e.data.params));break;case rr.RAISE_HAND_UPDATE:(yield ke(Mt))._id!==e.data.params.participantId&&(t=tn.raiseHandUpdate(e.data.params));break;case rr.RAISE_HAND_RES:t=tn.raiseHandResponseReceived(!1,e.data.params);break;case rr.STREAMING_STATE:t=tn.setStreamingState(e.data.params.newState,e.data.params.message);break;case rr.PARTICIPANT_SHARES:t=tn.setRemoteScreenStream(e.data.params.streamId,e.data.params.participantId);break;case rr.SHARING_STOP:t=tn.stopSharing();break;case rr.STATS_UPDATE:t=tn.updateStats(e.data.params.stats);break;case rr.RECEIVE_REQUEST_TO_PARTICIPATE:t=tn.receivedRequestToParticipate(e);break;case rr.SIP_CALL_STATE:t=yield function*(e){const{sipUri:t,state:r,message:n}=e;let{sipUri:i}=yield ke(Wt);const o=i&&0===i.indexOf("tel:");if(i=o?i.substring(4):i,t!==i)return tn.noop();r===O&&(yield Re(tr.generalInfo("sip-call-accepted")));r===I&&(n?yield Re(tr.generalWarning({message:"sip-call-rejected-ext",args:{message:n}})):yield Re(tr.generalWarning("sip-call-rejected")));return tn.setSipState(e)}(e.data.params);break;case rr.BFM_ON_PAUSE:t=tn.setBfmPauseState(e.data.params);break;case rr.MOD_LAYOUT_ORDER_UPDATE:t=tn.orderUpdate(e.data.params.order);break;case rr.MW_NOTIFICATION:t=tn.MWMessage(e.data.params)}yield Re(t)}))}function*vi(){yield Fe(At.SDK_ACTIVATION,(function*({payload:e}){const t=yield ke(Mt);t&&(yield or(ir.voiceActivation,t._id,e)),yield Me(500)}))}function*Ei(){yield Ae([vi(),pi(),ci(),Xn(),Zn(),si(),ti(),ri(),ni(),oi(),di(),ui(),yi(),fi(),hi(),ii(),ai()])}var Si=r("./node_modules/bowser/es5.js");const _i=r.n(Si).a.getParser(window.navigator.userAgent).parsedResult,bi=(e,t)=>localStorage.setItem(e,t);let Ti=null,Ci=null;const Ri=(e="camera")=>navigator.permissions.query({name:e}).then(e=>{const{state:t}=e;switch(t){case"denied":return!1;case"granted":case"prompt":return!0;default:return!1}}),Ai=e=>pr().then(({audio:e,video:t})=>{const r={audio:!1,video:!1};return e&&e.length&&(r.audio=!0),t&&t.length&&(r.video=!0),r}).then(e=>Promise.all([Ri("microphone"),Ri("camera")]).then(([t,r])=>({options:{audio:e.audio&&t,video:e.video&&r},denied:!(t||r)}))).catch(e=>({options:{video:!0,audio:!0},denied:!1})).then(t=>{const{options:r,denied:n}=t;var i;return e&&(r.video=!1),n?bi("denied",n):(i="denied",localStorage.removeItem(i)),bi("options",JSON.stringify(r)),r}).catch(e=>console.error(e));function*Oi(){let e;for(;;){const t=yield Ce([At.CREATE_PARTICIPANT,At.CONNECTION_CANCEL,At.CONNECTION_DISCONNECTED]),{connectionState:r}=yield ke(e=>e.teevid.meeting);if(t.type===At.CONNECTION_CANCEL||t.type===At.CONNECTION_DISCONNECTED){if(e&&(yield we(e),e=null,Ti&&(yield we(Ti),Ti=null),Ci&&(yield we(Ci),Ci=null)),t.type===At.CONNECTION_DISCONNECTED)try{AndroidJSInterface&&AndroidJSInterface.disconnect()}catch(e){}yield Re(tn.setConnectionState(b))}else r===R&&(e&&(yield we(e)),e=yield Pe(Ii,t.payload)),e||r===T||(yield Re(tn.setConnectionState(T)),e=yield Pe(Ii,t.payload))}}function*Ii({username:e,pin:t,room:r,inviteToken:n}){if(!(yield TeeVidSdk.verifyDeveloperKey()))throw new Error("error-invalid-sdk-key");try{const i=yield Ie(Pi,{username:e,pin:t,roomId:r,inviteToken:n});yield Re(tn.setCurrentRoom(i.room)),i.status={devices:{audio:w.UNMUTED,video:w.UNMUTED}},i.streams={mediaStreamId:null,screenStreamId:null},yield Re(tn.participantCreated(i))}catch(e){const t=[Re(tn.connectionCancel())];"token-expired-error"===e.message?t.push(Re(Hr.logout())):"err-bad-access-pin"===e.message?t.push(Re(Hr.accessPinError(!0))):"err-access-pin-required"!==e.message&&t.push(Re(tn.connectionError(e))),yield Ae(t)}}function*Pi({username:e,pin:t,roomId:r,inviteToken:n}){let i=t;for(;;)try{const{payload:t}=yield Ie(sr,"post",`/rooms/${r}/participants/`,{username:e,pin:i,inviteToken:n});return yield Re(tn.setAccessPinRequirement(!1)),t}catch(e){switch(i={},e.code){case 404:try{AndroidJSInterface&&AndroidJSInterface.disconnect()}catch(e){}throw e;case 412:const t=[Re(tn.setAccessPinRequirement(!1))];"no-slots-error"===e.message?t.unshift(Re(tn.setConnectionState(A))):t.unshift(Re(tn.setConnectionState(R))),yield Ae(t),yield Me(2e3);break;case 401:if("err-bad-pin"===e.message){yield Ae([Re(Hr.ownerPinError(!0)),Re(tn.setConnectionState(R)),Re(tn.setAccessPinRequirement(!1))]),yield Me(2e3);break}throw"err-access-pin-required"===e.message&&(yield Re(tn.setAccessPinRequirement(!0))),e;default:throw e}}}function wi(e){const t=["room-connected","stream-added","stream-subscribed","stream-removed","room-error","room-disconnected"];return pt(r=>{function n(e,t){r({type:e,event:t})}return t.forEach(t=>{e.addEventListener(t,n.bind(null,t))}),()=>{e.disconnect()}})}function*ki(e){yield Be(e,(function*(e){let t=tn.noop();switch(e.type){case Ln:t=tn.roomConnected();break;case Un:t=tn.streamAdded(e.event.stream);break;case jn:t=tn.streamSubscribed(e.event.stream);break;case Bn:t=tn.streamRemoved(e.event.stream);break;case Vn:case Fn:t=tn.disconnected()}yield Re(t)}))}function*Mi(){let e=null,t=null;yield Be(At.CONNECT,(function*(r){const n=yield ke(Bt),i=yield ke(Mt),o=yield ke(Ft),{browser:{name:a},os:{name:s}}=_i,c="VP9"===i.room.videoCodec&&"Safari"===a&&("macOS"===s||"iOS"===s),d=yield Ai(c);c&&(yield Re(TeeVidSdk.cleanActions.generalWarning("warning-unsupported-video-codec"))),yield Re(tr.refreshCurrentMediaDevices(d)),yield Re(tn.setMuteState({audio:d.audio?w.UNMUTED:w.NO_DEVICE,video:d.video?w.UNMUTED:w.NO_DEVICE}));const u=`wss://${n}/socket/moderation?token=${encodeURIComponent(i.token)}`,p=new WebSocket(u);p.onclose=e=>{4e3===e.code?TeeVidSdk.actions.disconnect("kick"):TeeVidSdk.actions.disconnect()},t=function(e,t){return pt(r=>(e.onerror=r=>{if(t.state===C)return e.onclose(null)},e.onmessage=e=>{const t=JSON.parse(e.data);r(t)},()=>{e.close()}))}(p,o),e=wi(o),yield Re(tn.moderationSocketCreated(p)),Ci=yield Pe(gi,t),Ti=yield Pe(ki,e)})),yield Be([At.CONNECTION_DISCONNECT,At.CONNECTION_DISCONNECTED],(function*(){e&&(yield e.close(),e=null),t&&(yield t.close(),t=null);try{AndroidJSInterface&&AndroidJSInterface.disconnect()}catch(e){}})),yield Be(At.MODERATION_SERVER_READY,(function*(){const e=yield ke(Mt),t=yield ke(Qt);e.role===Pt.MODERATOR&&t.storyboardId&&!t.lecturerId&&t.mode===l?yield or(ir.participantReady,e,t):yield or(ir.participantReady,e)}))}function*Ni(){yield Be(At.CREATE_CONNECTION,(function*(){const e=yield ke(Mt),t={token:e.nuveId},r=Rn.a.Room(t),n=r.publish;r.publish=function(t,i,o){(i=i||{}).scheme="notify";let a=t.getAttributes()||{};return a.participantId=e._id,a.username=e.name,t.updateLocalAttributes(a),n.apply(r,[t,i,o])},yield Re(tn.connectionCreated(r))}))}function*Di(){yield Be(At.SET_MEETING_STATE,(function*(){yield Re(tn.connectionReady())}))}function*xi(){yield Be(At.ROOM_CONNECTED,(function*(){const e=yield ke(Ft);e.remoteStreams.forEach(t=>{t.local||(dr(t),e.subscribe(t,{offerFromErizo:!1}))}),yield Re(tn.connectionRoomReady());const t=yield Pe(Li);yield Ce("stop-timer"),yield we(t)}))}function*Li(){for(;;){(yield ke(Mt))||(yield Re({type:"stop-timer"})),yield Dn(),yield Me(3e3)}}function*Ui(){yield Be(At.CONNECTION_STREAM_ADDED,(function*({payload:e}){const t=yield ke(Ft);e.local||(dr(e),t.subscribe(e,{offerFromErizo:!1}))}))}function*ji(){yield Be(At.CONNECTION_STREAM_REMOVED,(function*({payload:e}){const t=yield ke(Mt);kt()(t,"streams.mediaStreamId",null)===e.getID()&&(yield or(ir.streamRemoved,e.streamID()))}))}function*Bi(){yield Ae([Mi(),Oi(),Ni(),Di(),xi(),Ui(),ji()])}function*Fi(){yield Be(At.STREAMING_START,(function*(){try{const e=yield ke(jt),t=yield ke(Ut);e.enabledStreaming&&e.streaming.enabled&&(yield Ae([Ie(cr,"POST","/media/start",{room:t.id}),yield Re(tn.setStreamingState(m))]))}catch(e){yield Re(tn.setStreamingState(g)),TeeVidSdk.actions.generalError(e)}}))}function*Vi(){yield Be(At.SET_STREAMING_STATE,(function*({payload:{state:e,message:t}}){TeeVidSdk.canModerate&&e===g&&t&&TeeVidSdk.actions.generalWarning({message:t,delay:1e4})}))}function*Gi(){yield Be(At.STREAMING_STOP,(function*(){try{const e=yield ke(Ut);yield Ae([Ie(cr,"POST","/media/stop",{room:e.id}),Re(tn.setStreamingState(y))])}catch(e){console.error(e)}}))}function*qi(){yield Ae([Gi(),Fi(),Vi()])}function*zi(){yield Be(At.RECORDING_START,(function*(){try{const e=yield ke(Ut);yield Re(tn.setRecordingState(v)),yield Ie(cr,"POST","/record/start",{room:e.id}),yield Re(tn.recordingStarted())}catch(e){yield Re(tn.setRecordingState(_)),yield Re(tr.generalWarning(e.message))}}))}function*Wi(){yield Be(At.RECORDING_START_SUCCESS,(function*(){yield or(ir.recordingState,E),yield Re(tn.setRecordingState(E))}))}function*Hi(){yield Be(At.RECORDING_STOP,(function*(){try{const e=yield ke(Ut);yield Re(tn.setRecordingState(S)),yield Ie(cr,"POST","/record/stop",{room:e.id}),yield Re(tn.recordingStopped())}catch(e){"recording-not-started-error"===e.message?yield Re(tn.recordingStopped()):yield Re(tn.setRecordingState(E)),yield Re(tr.generalWarning(e.message))}}))}function*$i(){yield Be(At.RECORDING_SET_STATE_REMOTE,(function*({payload:{state:e,message:t}}){if(TeeVidSdk.canModerate&&e.state===_){const e=yield ke(Ut),r=yield TeeVidSdk.recordings.getTotalSize(e.id);yield TeeVidSdk.actions.setRoomRecordingsSize(r),t&&TeeVidSdk.actions.generalWarning({message:t,delay:1e4})}}))}function*Yi(){yield Ae([zi(),Hi(),Wi(),$i()])}function*Qi(){yield}function*Ki(){yield Ae([Qi(),Bi(),Ei(),qi(),Yi(),ei()])}var Ji=r("./package.json");r.d(t,"actionTypes",(function(){return Xi})),r.d(t,"actions",(function(){return Zi})),r.d(t,"moderationActions",(function(){return eo}));const Xi=Object.assign({},n,s,At,Kr),Zi=Object.assign({},tr,Hr,tn,en),eo=ir;let to=null;const ro=`${Ji.version}-${"15dbe6d82ebb3be760172e89846865a20ac7d4f8".slice(0,7)}`;const no=new class{constructor(e=5){Rn.a.Logger.setLogLevel(e),window.TeeVidSdk=this,this.cleanActions=Zi}get version(){return ro}getStream(e){const{remoteParticipants:t,streams:r}=this.store.getState().teevid.meeting,n=kt()(t,`${e}.streams.mediaStreamId`,null);return n?kt()(r,n,null):null}get localStream(){const{participant:e,streams:t,connectionState:r}=this.store.getState().teevid.meeting;if(r===b)return null;const n=kt()(e,"streams.mediaStreamId",null);return n?kt()(t,n,null):null}get presenterStream(){const{lecturerId:e,participant:t,streams:r,remoteParticipants:n,connectionState:i}=this.store.getState().teevid.meeting;if(i===b)return null;if(!e)return null;if(t&&t._id===e)return this.localStream;const o=n[e];if(o){const e=kt()(o,"streams.mediaStreamId",null);if(e)return kt()(r,e,null)}return null}get actionTypes(){return Xi}generateThumbnail(e){return ur(e)}get logo(){const{serverUrl:e}=this.store.getState().teevid.user;return`https://${e}/api/v1/system/image/logo`}customImage(e){const{serverUrl:t}=this.store.getState().teevid.user;return`https://${t}/api/v1/system/image/${e}`}removeCustomImage(e){return this._call("delete",`/system/image/${e}`)}get publisherCount(){const{meeting:e}=this.store.getState().teevid,{remoteParticipants:t}=e;let r=0;for(const e in t){const n=t[e];kt()(n,"streams.mediaStreamId",null)&&r++}return kt()(e,"participant.streams.mediaStreamId")&&r++,r}get canPublish(){const{meeting:e,api:t}=this.store.getState().teevid,{isConnected:r}=e,{globalConfigs:n}=t;if(!e)return!1;if(!r)return!1;const i=parseInt(n.interactive_max_publisher_count,10)||12;return this.publisherCount<i}get reducer(){return ze({api:N,user:Wr,meeting:vn,viewer:Zr})}get saga(){return function*(){yield Ae([qr(),Qr(),Ki(),ln()])}}get profile(){if(this.store){const e=this.store.getState();return kt()(e,"teevid.user.profile",null)}return null}get userToken(){if(this.store){const e=this.store.getState();return kt()(e,"teevid.user.userToken",null)}return null}get remoteStreams(){const e=this.store.getState().teevid.meeting.connection,t={};return e&&e.remoteStreams&&e.remoteStreams.forEach(e=>{e.local||(t[e.getID()]=e)}),t}sendModerationMessage(e){const t=this.store.getState(),r=kt()(t,"teevid.meeting.moderationSocket"),n=kt()(t,"teevid.meeting.participantToken");if(!r||!n||1!==r.readyState)throw new Error({message:"error-connect-socket"});e.token=n,r.send(JSON.stringify(e))}isCurrentParticipant(e){return e===kt()(this.store.getState(),"teevid.meeting.participant._id",null)}get canModerate(){const e=this.store.getState(),t=kt()(e,"teevid.meeting.participant.role",null);return-1!==[Pt.MODERATOR,Pt.OWNER].indexOf(t)}get isRoomOwner(){const e=this.store.getState();return kt()(e,"teevid.meeting.participant.isRoomOwner",!1)}hasOwnerPin(){const e=this.store.getState();return kt()(e,"teevid.meeting.roomOptions.hasOwnerPin",!1)}Stream(e,t){const r=Rn.a.UnboundStream(t,e),n=r.getAttributes()||{};return r.updateLocalAttributes(n),dr(r),r.setAttribute=function(e,t){const n=r.getAttributes()||{};return n[e]!==t&&(n[e]=t,r.setAttributes(n)),n},r}get serverUrl(){const{serverUrl:e}=this.store.getState().teevid.user;return e}verifyDeveloperKey(){return to?this._call("get","/sdk-key/verify/"+encodeURIComponent(to)).then((function(e){return e.valid?Promise.resolve(!0):Promise.reject({message:e.message})})):Promise.reject({message:"error-invalid-sdk-key"})}init(e,t,r){to=r,this.store=t,this.actions=function(e,t){if("function"==typeof e)return We(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var i=e[n];"function"==typeof i&&(r[n]=We(i,t))}return r}(Zi,t.dispatch),this.actions.setServerUrl(e),this.actions.refreshMediaDevices(),ar(e,null,"get","/system/configurations/public").then(e=>{this.actions.setGlobalConfig(e.payload)})}login(e,t){this.actions.login(e,t)}_callAsParticipant(e,t,r){const{serverUrl:n}=this.store.getState().teevid.user,{participantToken:i}=this.store.getState().teevid.meeting;return ar(n,i,e,t,r).then(e=>e.payload)}_call(e,t,r,n){const{serverUrl:i,userToken:o}=this.store.getState().teevid.user;let a=o;if(!a){const{participantToken:e}=this.store.getState().teevid.meeting;a=e}return ar(i,a,e,t,r).then(e=>{if(n)return e;if(e.token){const t=(e=>JSON.parse(atob(e.split(".")[1])))(e.token);["Participant","Moderator"].includes(t.role)||this.actions.updateToken(e.token)}return e.payload})}prepareUploadOptions(e,t){const r=new FormData;r.append("file",e),t&&r.append("importType",t);const n={method:"POST",headers:{Accept:"application/json","cache-control":"no-store"},body:r},{userToken:i}=this.store.getState().teevid.user;return i&&(n.headers.Authorization="Bearer "+i),n}_upload(e,t){const{serverUrl:r}=this.store.getState().teevid.user;if(t){const n=this.prepareUploadOptions(t);return fetch(`https://${r}/api/v1${e}`,n)}return Promise.resolve(!1)}get translator(){return{languages:()=>cr("get","/translator/languages"),translate:(e,t,r)=>{if(!t||!r)throw Error("400 Bad Request");return this._call("post",`/translator/?from=${encodeURIComponent(e||"")}&to=${encodeURIComponent(t)}`,{message:r})}}}get configuration(){return this.filterDevices=(e=[],t="videoinput")=>e.filter(e=>e.kind===t),this.configuration={_items:!1},{get:()=>this._call("get","/systems/configurations/public").then(e=>(this.configuration._items={},e.forEach(e=>this.configuration._items[e._id]=e.value),this.configuration._items)),getMcuVersion:()=>this._call("get","/system/version"),listMediaDevices:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>{const t=this.filterDevices(e,"videoinput");return{audioIn:this.filterDevices(e,"audioinput"),videoIn:t,audioOut:this.filterDevices(e,"audiooutput")}}):Promise.resolve({audioIn:[],videoIn:[],audioOut:[]}),listVideoInputs:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>this.filterDevices(e,"videoinput")):Promise.resolve([]),listAudioInputs:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>this.filterDevices(e,"audioinput")):Promise.resolve([]),listAudioOutputs:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>this.filterDevices(e,"audiooutput")):Promise.resolve([])}}get user(){return{guest:()=>this._call("get","/token/guest",null,!0).then(({payload:e,token:t})=>(this.actions.loginSuccess(e,t),e)),editProfile:e=>this._call("patch","/users/me",e),refreshProfile:()=>this._call("get","/users/me").then(e=>(e&&this.actions.setProfile(e),e)),setAvatar:e=>this._upload("/users/avatar",e),requestPasswordRecovery:e=>this._call("post","/users/password-recovery",{email:e}),resetPassword:(e,t)=>this._call("post","/users/password-reset",{recoveryToken:e,password:t,type:"password-recovery"}),editPersonalRoom:e=>{if(this.profile&&this.profile.room)return this._call("patch","/rooms/my",e);throw Error("You don't have a personal room")}}}get media(){return{requestStats:e=>{if(!e)throw Error("You have to provide server ID");return this._call("get",`/media/stats/${e}`)},getServers:()=>this._call("get","/media/servers"),getServer:e=>this._call("get",`/media/server/${e}`),checkStatus:e=>this._call("get",`/media/check/${e}`),startStreaming:e=>{if(!e)throw Error("You must provide proper server and room IDs");return this._call("post",`/media/start/${e}`)},stopStreaming:e=>{if(!e)throw Error("You must provide proper room ID");return this._call("post","/media/stop",{room:e})},startRecording(e,t){if(!e)throw Error("You must provide proper room ID");return this._call("post","/record/start",{room:e,recordPath:t})},stopRecording(e){if(!e)throw Error("You must provide proper room ID");return this._call("post","/record/stop",{room:e})},callSip:(e,t)=>this._call("post","/media/call",{room:e,to:t})}}get streamingServices(){const e=e=>`/streaming/service/${encodeURIComponent(e)}`;return{list:()=>this._call("get","/streaming/services"),get:e=>{if(!e)throw Error("You have to provide service ID");return this._call("get",`/streaming/service/${encodeURIComponent(e)}`)},create:e=>this._call("post","/streaming/service/create",e),remove:t=>{if(!t)throw Error("You have to provide service ID");return this._call("delete",e(t))},update:({serviceId:t,update:r})=>{if(!t)throw Error("You have to provide service ID");return this._call("patch",e(t),r)},start:e=>this._call("post","/streaming/service/start",e)}}get userCredentials(){const e=(e,t)=>`/streaming/${encodeURIComponent(e)}/credentials/${encodeURIComponent(t)}`;return{save:({userId:t,serviceId:r,credentials:n})=>{if(!t||!r)throw Error("You have to provide user and service ID");return this._call("post",e(t,r),n)},get:({userId:t,serviceId:r})=>{if(!t||!r)throw Error("You have to provide user and service ID");return this._call("get",e(t,r))},remove:({userId:t,serviceId:r})=>{if(!t||!r)throw Error("You have to provide user and service ID");return this._call("get",e(t,r))}}}get users(){return{list:()=>this._call("get","/users"),create:e=>this._call("post","/users",e),edit:(e,t)=>{if(!e)throw Error("User does not exist");return this._call("patch",`/users/${encodeURIComponent(e)}`,t)},remove:e=>this._call("delete",`/users/${encodeURIComponent(e)}`),changePassword:e=>this._call("put",`/users/${encodeURIComponent(e.name)}/password`,e),deleteChosen:e=>this._call("post","/users/remove",e)}}get recordings(){return{getAll:e=>this._call("get",`/recording/${encodeURIComponent(e)}`),removeRecord:e=>this._call("delete",`/recording/${encodeURIComponent(e)}`),updateRecord:({recordId:e,update:t})=>this._call("patch",`/recording/${encodeURIComponent(e)}`,t),getRecordUrl:e=>this._call("get",`/record/${encodeURIComponent(e)}`),getTotalSize:e=>e?this._call("get",`/recordings/${encodeURIComponent(e)}/size`):this._call("get","/recordings/size")}}get storyboards(){return{list:()=>this._call("get","/storyboard"),get:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("get",`/storyboard/${encodeURIComponent(e)}`)},listThemes:()=>this._call("get","/themes"),edit:(e,t)=>{if(!e)throw Error("Storyboard does not exist");return this._call("post",`/storyboard/${encodeURIComponent(e)}`,t)},clone:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("patch",`/storyboard/${encodeURIComponent(e)}/clone`)},cloneScene:(e,t,r)=>{if(!e)throw Error("Storyboard does not exist");return this._call("patch",`/storyboard/${encodeURIComponent(e)}/scenes/${encodeURIComponent(t)}/clone`,r)},remove:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("delete",`/storyboard/${encodeURIComponent(e)}`)},getLayouts:()=>this._call("get","/layouts"),create:e=>this._call("post","/storyboard",e),upload:e=>this._upload("/upload",e),uploadWithProgress:(e,t,r,n)=>{const{serverUrl:i}=this.store.getState().teevid.user;if(e){const o=this.prepareUploadOptions(e,n);return new Promise((e,n)=>{const a=new XMLHttpRequest;a.open("post","https://"+i+r);for(let e in o.headers||{})a.setRequestHeader(e,o.headers[e]);a.onload=()=>{e({body:a.responseText,status:a.status,json:function(){return new Promise((e,t)=>{try{e(JSON.parse(this.body))}catch(e){t(e)}})}})},a.onerror=n,a.upload&&t&&(a.upload.onprogress=t),a.send(o.body)})}return Promise.resolve(!1)},uploadImage:e=>this._upload("/upload/image",e),scenesList:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("get",`/storyboard/${encodeURIComponent(e)}/scenes`)},sceneEdit:(e,t,r)=>{if(!e)throw Error("Storyboard does not exist");if(!t)throw Error("Scene does not exist");return this._call("patch",`/storyboard/${encodeURIComponent(e)}/scenes/${encodeURIComponent(t)}`,r)},sceneRemove:(e,t)=>{if(!e)throw Error("Storyboard does not exist");if(!t)throw Error("Scene does not exist");return this._call("delete",`/storyboard/${encodeURIComponent(e)}/scenes/${encodeURIComponent(t)}`)},sceneCreate:(e,t)=>{if(!e)throw Error("Storyboard does not exist");return this._call("post",`/storyboard/${encodeURIComponent(e)}/scenes`,t)},export:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("post",`/storyboard/${encodeURIComponent(e)}/export`)}}}get rooms(){return{get:e=>e?this._call("get",`/rooms/${encodeURIComponent(e)}`):Promise.reject(Error("No room name specified")),check:e=>e?this._call("get",`/rooms/${encodeURIComponent(e)}/check`):Promise.reject(Error("No room name specified")),getInviteToken:e=>e?this._callAsParticipant("get",`/rooms/${encodeURIComponent(e)}/invite_token`).then(e=>e.token):Promise.reject(Error("No room name specified")),list:()=>this._call("get","/rooms"),create:e=>this._call("post","/rooms",e),edit:(e,t)=>{if(!e)throw Error("Room does not exist");return this._call("patch",`/rooms/${encodeURIComponent(e)}`,t)},remove:e=>{if(!e)throw Error("Room does not exist");return this._call("delete",`/rooms/${encodeURIComponent(e)}`)},deleteChosen:e=>this._call("post","/rooms/remove",e)}}get participants(){return{list:e=>{if(!e)throw Error("Room does not exist");return this._call("get",`/rooms/${encodeURIComponent(e)}/participants`)},remove:(e,t)=>{if(!e)throw Error("Room does not exist");if(!t)throw Error("Participant does not exist");if(0===t.indexOf("local_"))throw Error("Paricipant does not exist");return this._call("delete",`/rooms/${encodeURIComponent(e)}/participants/${encodeURIComponent(t)}`)},deleteAll:e=>{if(!e)throw Error("Room does not exist");return this._call("delete",`/rooms/${encodeURIComponent(e)}/participants`)},updateRole:(e,t,r)=>{if(!e)throw Error("Room does not exist");if(!t)throw Error("Participant duplicated");if(!r)throw Error("Bad pin");return this._call("patch",`/rooms/${encodeURIComponent(e)}/participants/${encodeURIComponent(t)}`,{pin:r}).then(e=>{if("Paricipant"===e.role)throw Error("Bad pin");return e.role})},updateName:(e,t,r)=>{if(!e)throw Error("Room does not exist");if(!t)throw Error("Participant duplicated");return this._call("patch",`/rooms/${encodeURIComponent(e)}/participants/${encodeURIComponent(t)}`,{name:r})}}}get license(){return{get:()=>this._call("get","/system/license"),update:e=>this._call("put","/system/license",{license:e})}}get system(){return{servers:()=>this._call("get","/system/servers"),liveMeetings:()=>this._call("get","/live-meetings"),status:()=>this._call("get","/system/status"),setSystemImage:({file:e,type:t})=>this._upload(`/system/image/${t}`,e)}}get reports(){return{meetings:e=>this._call("get",`/meetings?from=${e.from}&to=${e.to}`),participants:e=>this._call("get",`/meetings-participants?from=${e.from}&to=${e.to}`)}}get mcu(){return{list:()=>this._call("get","/system/mcu/list"),start:e=>this._call("put",`/system/mcu/start/${encodeURIComponent(e)}`),stop:e=>this._call("put",`/system/mcu/stop/${encodeURIComponent(e)}`),kill:e=>this._call("put",`/system/mcu/kill/${encodeURIComponent(e)}`),restart:e=>this._call("put",`/system/mcu/restart/${encodeURIComponent(e)}`),remove:e=>this._call("delete",`/system/mcu/${encodeURIComponent(e)}`)}}get mediaServers(){return{list:()=>this._call("get","/system/servers"),add:e=>this._call("post","/system/servers",e),remove:e=>Array.isArray(e)?this._call("delete",`/system/servers/${e.join("&")}`):this._call("delete",`/system/servers/${e}`)}}get kurentoServers(){return{list:()=>this._call("get","/media/servers"),restart:e=>this._call("put",`/media/servers/${e}/restart`),reset:e=>this._call("put",`/media/servers/${e}/reset`)}}};window.TeeVidSdk=no;t.default=no},"./sdk/libs/erizo.js":function(e,t,r){(function(t){var r=r||{};r.scope={},r.inherits=function(e,t){function r(){}for(var n in r.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new r,e.prototype.constructor=e,t)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n]},r.ASSUME_ES5=!1,r.ASSUME_NO_NATIVE_MAP=!1,r.ASSUME_NO_NATIVE_SET=!1,r.defineProperty=r.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)},r.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:void 0!==t&&null!=t?t:e},r.global=r.getGlobal(this),r.SYMBOL_PREFIX="jscomp_symbol_",r.initSymbol=function(){r.initSymbol=function(){},r.global.Symbol||(r.global.Symbol=r.Symbol)},r.symbolCounter_=0,r.Symbol=function(e){return r.SYMBOL_PREFIX+(e||"")+r.symbolCounter_++},r.initSymbolIterator=function(){r.initSymbol();var e=r.global.Symbol.iterator;e||(e=r.global.Symbol.iterator=r.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&r.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return r.arrayIterator(this)}}),r.initSymbolIterator=function(){}},r.arrayIterator=function(e){var t=0;return r.iteratorPrototype((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))},r.iteratorPrototype=function(e){return r.initSymbolIterator(),(e={next:e})[r.global.Symbol.iterator]=function(){return this},e},r.makeIterator=function(e){r.initSymbolIterator();var t=e[Symbol.iterator];return t?t.call(e):r.arrayIterator(e)},r.arrayFromIterator=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r},r.arrayFromIterable=function(e){return e instanceof Array?e:r.arrayFromIterator(r.makeIterator(e))},r.polyfill=function(e,t,n,i){if(t){for(n=r.global,e=e.split("."),i=0;i<e.length-1;i++){var o=e[i];o in n||(n[o]={}),n=n[o]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&r.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},r.polyfill("Array.from",(function(e){return e||function(e,t,n){r.initSymbolIterator(),t=null!=t?t:function(e){return e};var i=[];if("function"==typeof(o=e[Symbol.iterator]))for(e=o.call(e);!(o=e.next()).done;)i.push(t.call(n,o.value));else for(var o=e.length,a=0;a<o;a++)i.push(t.call(n,e[a]));return i}}),"es6-impl","es3"),r.iteratorFromArray=function(e,t){r.initSymbolIterator(),e instanceof String&&(e+="");var n=0,i={next:function(){if(n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i},r.polyfill("Array.prototype.keys",(function(e){return e||function(){return r.iteratorFromArray(this,(function(e){return e}))}}),"es6-impl","es3"),r.FORCE_POLYFILL_PROMISE=!1,r.polyfill("Promise",(function(e){function t(){this.batch_=null}function n(e){return e instanceof o?e:new o((function(t,r){t(e)}))}if(e&&!r.FORCE_POLYFILL_PROMISE)return e;t.prototype.asyncExecute=function(e){return null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_()),this.batch_.push(e),this},t.prototype.asyncExecuteBatch_=function(){var e=this;this.asyncExecuteFunction((function(){e.executeBatch_()}))};var i=r.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){i(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var r=e[t];delete e[t];try{r()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction((function(){throw e}))};var o=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[];var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};o.prototype.createResolveAndReject_=function(){function e(e){return function(n){r||(r=!0,e.call(t,n))}}var t=this,r=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},o.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof o)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},o.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},o.prototype.reject_=function(e){this.settle_(2,e)},o.prototype.fulfill_=function(e){this.settle_(1,e)},o.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t|"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,this.executeOnSettledCallbacks_()},o.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=this.onSettledCallbacks_,t=0;t<e.length;++t)e[t].call(),e[t]=null;this.onSettledCallbacks_=null}};var a=new t;return o.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},o.prototype.settleSameAsThenable_=function(e,t){var r=this.createResolveAndReject_();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},o.prototype.then=function(e,t){function r(e,t){return"function"==typeof e?function(t){try{n(e(t))}catch(e){i(e)}}:t}var n,i,a=new o((function(e,t){n=e,i=t}));return this.callWhenSettled_(r(e,n),r(t,i)),a},o.prototype.catch=function(e){return this.then(void 0,e)},o.prototype.callWhenSettled_=function(e,t){function r(){switch(n.state_){case 1:e(n.result_);break;case 2:t(n.result_);break;default:throw Error("Unexpected state: "+n.state_)}}var n=this;null==this.onSettledCallbacks_?a.asyncExecute(r):this.onSettledCallbacks_.push((function(){a.asyncExecute(r)}))},o.resolve=n,o.reject=function(e){return new o((function(t,r){r(e)}))},o.race=function(e){return new o((function(t,i){for(var o=r.makeIterator(e),a=o.next();!a.done;a=o.next())n(a.value).callWhenSettled_(t,i)}))},o.all=function(e){var t=r.makeIterator(e),i=t.next();return i.done?n([]):new o((function(e,r){function o(t){return function(r){a[t]=r,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,n(i.value).callWhenSettled_(o(a.length-1),r),i=t.next()}while(!i.done)}))},o}),"es6-impl","es3"),r.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.polyfill("WeakMap",(function(e){function t(e){r.owns(e,i)||r.defineProperty(e,i,{value:{}})}function n(e){var r=Object[e];r&&(Object[e]=function(e){return t(e),r(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),r=Object.seal({}),n=new e([[t,2],[r,3]]);return 2==n.get(t)&&3==n.get(r)&&(n.delete(t),n.set(r,4),!n.has(t)&&4==n.get(r))}catch(e){return!1}}())return e;var i="$jscomp_hidden_"+Math.random().toString().substring(2);n("freeze"),n("preventExtensions"),n("seal");var o=0,a=function(e){if(this.id_=(o+=Math.random()+1).toString(),e){r.initSymbol(),r.initSymbolIterator(),e=r.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return a.prototype.set=function(e,n){if(t(e),!r.owns(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.id_]=n,this},a.prototype.get=function(e){return r.owns(e,i)?e[i][this.id_]:void 0},a.prototype.has=function(e){return r.owns(e,i)&&r.owns(e[i],this.id_)},a.prototype.delete=function(e){return!(!r.owns(e,i)||!r.owns(e[i],this.id_))&&delete e[i][this.id_]},a}),"es6-impl","es3"),r.MapEntry=function(){},r.polyfill("Map",(function(e){if(!r.ASSUME_NO_NATIVE_MAP&&function(){if(!e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(r.makeIterator([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),o=i.next();return!o.done&&o.value[0]==t&&"s"==o.value[1]&&!((o=i.next()).done||4!=o.value[0].x||"t"!=o.value[1]||!i.next().done)}catch(e){return!1}}())return e;r.initSymbol(),r.initSymbolIterator();var t=new WeakMap,n=function(e){if(this.data_={},this.head_=a(),this.size=0,e){e=r.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};n.prototype.set=function(e,t){var r=i(this,e);return r.list||(r.list=this.data_[r.id]=[]),r.entry?r.entry.value=t:(r.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},r.list.push(r.entry),this.head_.previous.next=r.entry,this.head_.previous=r.entry,this.size++),this},n.prototype.delete=function(e){return!(!(e=i(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.data_[e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},n.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=a(),this.size=0},n.prototype.has=function(e){return!!i(this,e).entry},n.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},n.prototype.entries=function(){return o(this,(function(e){return[e.key,e.value]}))},n.prototype.keys=function(){return o(this,(function(e){return e.key}))},n.prototype.values=function(){return o(this,(function(e){return e.value}))},n.prototype.forEach=function(e,t){for(var r,n=this.entries();!(r=n.next()).done;)r=r.value,e.call(t,r[1],r[0],this)},n.prototype[Symbol.iterator]=n.prototype.entries;var i=function(e,n){var i=n&&typeof n;"object"==i||"function"==i?t.has(n)?i=t.get(n):(i=""+ ++s,t.set(n,i)):i="p_"+n;var o=e.data_[i];if(o&&r.owns(e.data_,i))for(e=0;e<o.length;e++){var a=o[e];if(n!=n&&a.key!=a.key||n===a.key)return{id:i,list:o,index:e,entry:a}}return{id:i,list:o,index:-1,entry:void 0}},o=function(e,t){var n=e.head_;return r.iteratorPrototype((function(){if(n){for(;n.head!=e.head_;)n=n.previous;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))},a=function(){var e={};return e.previous=e.next=e.head=e},s=0;return n}),"es6-impl","es3"),r.polyfill("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991}),"es6-impl","es3"),r.polyfill("Array.prototype.values",(function(e){return e||function(){return r.iteratorFromArray(this,(function(e,t){return t}))}}),"es6","es3"),r.findInternal=function(e,t,r){e instanceof String&&(e=String(e));for(var n=e.length,i=0;i<n;i++){var o=e[i];if(t.call(r,o,i,e))return{i:i,v:o}}return{i:-1,v:void 0}},r.polyfill("Array.prototype.find",(function(e){return e||function(e,t){return r.findInternal(this,e,t).v}}),"es6-impl","es3"),r.polyfill("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}}),"es6-impl","es3"),r.polyfill("Array.prototype.includes",(function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var n=r.length;for(t=t||0;t<n;t++)if(r[t]==e||Object.is(r[t],e))return!0;return!1}}),"es7","es3"),r.checkStringArgs=function(e,t,r){if(null==e)throw new TypeError("The 'this' value for String.prototype."+r+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+r+" must not be a regular expression");return e+""},r.polyfill("String.prototype.includes",(function(e){return e||function(e,t){return-1!==r.checkStringArgs(this,e,"includes").indexOf(e,t||0)}}),"es6-impl","es3"),r.polyfill("Object.assign",(function(e){return e||function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var o in i)r.owns(i,o)&&(e[o]=i[o])}return e}}),"es6-impl","es3"),r.polyfill("String.prototype.startsWith",(function(e){return e||function(e,t){var n=r.checkStringArgs(this,e,"startsWith");e+="";var i=n.length,o=e.length;t=Math.max(0,Math.min(0|t,n.length));for(var a=0;a<o&&t<i;)if(n[t++]!=e[a++])return!1;return a>=o}}),"es6-impl","es3"),r.polyfill("String.prototype.endsWith",(function(e){return e||function(e,t){var n=r.checkStringArgs(this,e,"endsWith");e+="",void 0===t&&(t=n.length),t=Math.max(0,Math.min(0|t,n.length));for(var i=e.length;0<i&&0<t;)if(n[--t]!=e[--i])return!1;return 0>=i}}),"es6-impl","es3"),e.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=24)}([function(e,t,n){var i,o,a=(i="",o=function(e){console.log.apply(console,[].concat(r.arrayFromIterable(e)))},{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(e){var t=e;e>a.NONE?t=a.NONE:e<a.DEBUG&&(t=a.DEBUG),a.logLevel=t},setOutputFunction:function(e){o=e},setLogPrefix:function(e){i=e},log:function(e,t){for(var r=[],n=1;n<arguments.length;++n)r[n-1]=arguments[n];if(n=i,!(e<a.logLevel))if(e===a.DEBUG?n+="DEBUG":e===a.TRACE?n+="TRACE":e===a.INFO?n+="INFO":e===a.WARNING?n+="WARNING":e===a.ERROR&&(n+="ERROR"),r=[n+": "].concat(r),void 0!==a.panel){n="";for(var s=0;s<r.length;s+=1)n+=r[s];a.panel.value=a.panel.value+"\n"+n}else o.apply(a,[r])},debug:function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];a.log.apply(a,[].concat([a.DEBUG],r.arrayFromIterable(t)))},trace:function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];a.log.apply(a,[].concat([a.TRACE],r.arrayFromIterable(t)))},info:function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];a.log.apply(a,[].concat([a.INFO],r.arrayFromIterable(t)))},warning:function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];a.log.apply(a,[].concat([a.WARNING],r.arrayFromIterable(t)))},error:function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];a.log.apply(a,[].concat([a.ERROR],r.arrayFromIterable(t)))}});t.a=a},function(e,t,r){r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return d})),r.d(t,"a",(function(){return s}));var n=r(0),i=function(){var e={},t={};return e.addEventListener=function(e,r){void 0===t[e]&&(t[e]=[]),t[e].push(r)},e.removeEventListener=function(e,r){t[e]&&(-1!==(r=t[e].indexOf(r))&&t[e].splice(r,1))},e.removeAllListeners=function(){t={}},e.dispatchEvent=function(e){if(!e||!e.type)throw Error("Undefined event");for(var r=(r=t[e.type]||[]).slice(0),i=0;i<r.length;i+=1)try{r[i](e)}catch(t){n.a.info("Error triggering event: "+e.type+", error: "+t)}},e.on=e.addEventListener,e.off=e.removeEventListener,e.emit=e.dispatchEvent,e},o=function(){this.emitter=i()};o.prototype.addEventListener=function(e,t){this.emitter.addEventListener(e,t)},o.prototype.removeEventListener=function(e,t){this.emitter.removeEventListener(e,t)},o.prototype.dispatchEvent=function(e){this.emitter.dispatchEvent(e)},o.prototype.on=function(e,t){this.addEventListener(e,t)},o.prototype.off=function(e,t){this.removeEventListener(e,t)},o.prototype.emit=function(e){this.dispatchEvent(e)};var a=function(e){var t={};return t.type=e.type,t},s=function(e){var t=a(e);return t.stream=e.stream,t.state=e.state,t},c=function(e){var t=a(e);return t.streams=e.streams,t.message=e.message,t},d=function(e){var t=a(e);return t.stream=e.stream,t.msg=e.msg,t.origin=e.origin,t.bandwidth=e.bandwidth,t.attrs=e.attrs,t}},function(e,t,r){var n=r(6)("ACTIVE","PASSIVE","ACTPASS","INACTIVE");n.byValue=function(e){return n[e.toUpperCase()]},n.toString=function(e){switch(e){case n.ACTIVE:return"active";case n.PASSIVE:return"passive";case n.ACTPASS:return"actpass";case n.INACTIVE:return"inactive";default:return null}},n.reverse=function(e){switch(e){case n.ACTIVE:return n.PASSIVE;case n.PASSIVE:return n.ACTIVE;case n.ACTPASS:return n.PASSIVE;case n.INACTIVE:return n.INACTIVE;default:return n.ACTIVE}},e.exports=n},function(e,t,r){var n=r(6)("SEND","RECV");n.byValue=function(e){return n[e.toUpperCase()]},n.toString=function(e){switch(e){case n.SEND:return"send";case n.RECV:return"recv";default:return"unknown"}},n.reverse=function(e){switch(e){case n.SEND:return n.RECV;case n.RECV:default:return n.SEND}},e.exports=n},function(e,t,r){var n=r(6)("SENDRECV","SENDONLY","RECVONLY","INACTIVE");n.byValue=function(e){return n[e.toUpperCase()]},n.toString=function(e){switch(e){case n.SENDRECV:return"sendrecv";case n.SENDONLY:return"sendonly";case n.RECVONLY:return"recvonly";case n.INACTIVE:return"inactive";default:return"unknown"}},n.reverse=function(e){switch(e){case n.SENDRECV:return n.SENDRECV;case n.SENDONLY:return n.RECVONLY;case n.RECVONLY:return n.SENDONLY;case n.INACTIVE:return n.INACTIVE;default:return n.SENDRECV}},e.exports=n},function(e,t,r){var n=r(1);t.a=function(){var e=Object(n.b)({});return e.url="",e}},function(e,t){e.exports=function e(t){for(var n=[],i=0;i<arguments.length;++i)n[i-0]=arguments[i];var o=this;if(!(this instanceof e))return new(Function.prototype.bind.apply(e,[null].concat(Array.prototype.slice.call(n))));Array.from(n).forEach((function(e){r.initSymbol(),o[e]=Symbol.for("LICODE_SEMANTIC_SDP_"+e)}))}},function(e,t,r){t.a=function(){var e={},t={};return e.add=function(e,r){t[e]=r},e.get=function(e){return t[e]},e.has=function(e){return void 0!==t[e]},e.size=function(){return Object.keys(t).length},e.forEach=function(e){for(var r=Object.keys(t),n=0;n<r.length;n+=1){var i=r[n];e(t[i],i)}},e.keys=function(){return Object.keys(t)},e.remove=function(e){delete t[e]},e.clear=function(){t={}},e}},function(e,t,r){(function(e){var n=r(0),i=function(){var t="none";return void 0!==e&&e.exports?t="fake":null!==window.navigator.userAgent.match("Firefox")?t="mozilla":null!==window.navigator.userAgent.match("Chrome")?(t="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(t="electron")):null!==window.navigator.userAgent.match("Safari")?t="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(t="safari"),t};t.a={GetUserMedia:function(t,r,o){r=void 0===r?function(){}:r,o=void 0===o?function(){}:o;var a,s=function(e,t,r){navigator.mediaDevices.getUserMedia(e).then(t).catch(r)};t.screen?t.desktopStreamId||t.extensionId?(n.a.debug("Screen access requested using GetUserMedia"),function(){switch(i()){case"electron":n.a.debug("Screen sharing in Electron"),(a={}).video=t.video||{},a.video.mandatory=t.video.mandatory||{},a.video.mandatory.chromeMediaSource="desktop",a.video.mandatory.chromeMediaSourceId=t.desktopStreamId,s(a,r,o);break;case"mozilla":n.a.debug("Screen sharing in Firefox"),a={},void 0!==t.video?(a.video=t.video,a.video.mediaSource||(a.video.mediaSource="window")):a={audio:t.audio,video:{mediaSource:"window"}},s(a,r,o);break;case"chrome-stable":if(n.a.debug("Screen sharing in Chrome"),a={},t.desktopStreamId)a.video=t.video||{mandatory:{}},a.video.mandatory=a.video.mandatory||{},a.video.mandatory.chromeMediaSource="desktop",a.video.mandatory.chromeMediaSourceId=t.desktopStreamId,s(a,r,o);else{var e="okeephmleflklcdebijnponpabbmmgeo";t.extensionId&&(n.a.debug("extensionId supplied, using "+t.extensionId),e=t.extensionId),n.a.debug("Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(e,{getStream:!0},(function(e){void 0===e?(n.a.error("Access to screen denied"),o({code:"Access to screen denied"})):(e=e.streamId,void 0!==t.video.mandatory?(a.video=t.video||{mandatory:{}},a.video.mandatory.chromeMediaSource="desktop",a.video.mandatory.chromeMediaSourceId=e):a={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}}},s(a,r,o))}))}catch(e){n.a.debug("Screensharing plugin is not accessible "),o({code:"no_plugin_present"})}}break;default:n.a.error("This browser does not support ScreenSharing")}}()):(n.a.debug("Screen access requested using GetDisplayMedia"),function(e,t,r){navigator.mediaDevices.getDisplayMedia(e).then(t).catch(r)}(t,r,o)):void 0!==e&&e.exports?n.a.error("Video/audio streams not supported in erizofc yet"):(n.a.debug("Calling getUserMedia with config",t),s(t,r,o))},getBrowser:i}}).call(t,r(41)(e))},function(e,t,n){var i=this;e=n(28);var o=n.n(e);e=n(2);var a=n.n(e);e=n(4);var s=n.n(e),c=n(36),d=n(21),u=n(0),p=n(38);t.a=function(e){var t={},n=new p.a(3e4,(function(){e.onEnqueueingTimeout&&e.onEnqueueingTimeout()}));t._queue=n;var l,f,h,m,y=-1,g=[],v=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];g.push([].concat(["Negotiation:"],r.arrayFromIterable(t)).reduce((function(e,t){return e+" "+t})))};t.getNegotiationLogs=function(){return g.reduce((function(e,t){return e+"'\n'"+t}))},u.a.info("Starting Base stack",e),t.pcConfig={iceServers:[],sdpSemantics:"plan-b"},t.con={},void 0!==e.iceServers&&(t.pcConfig.iceServers=e.iceServers),!0===e.forceTurn&&(t.pcConfig.iceTransportPolicy="relay"),t.audio=e.audio,t.video=e.video,void 0===t.audio&&(t.audio=!0),void 0===t.video&&(t.video=!0),e.remoteCandidates=[],e.localCandidates=[],e.remoteDescriptionSet=!1,t.mediaConstraints={offerToReceiveVideo:void 0!==t.video&&!1!==t.video,offerToReceiveAudio:void 0!==t.audio&&!1!==t.audio};var E=function(e){t.peerConnectionFsm.error(e)};t.peerConnection=new RTCPeerConnection(t.pcConfig,t.con);var S=0;t.peerConnection.onnegotiationneeded=function(){var e=(e=t.audio?1:0)+(t.video?1:0);0==S%e&&(v("onnegotiationneeded - createOffer"),(e=t.peerConnectionFsm.createOffer(!1))&&e.catch(E.bind(i))),S+=1};var _=function(){l.sdp=t.enableSimulcast(l.sdp),l.type="offer",h=o.a.SDPInfo.processString(l.sdp),d.a.setMaxBW(h,e),h.medias.forEach((function(e){e.getSetup()!==a.a.ACTPASS&&e.setSetup(a.a.ACTPASS)})),l.sdp=h.toString(),t.localSdp=h},b=function(t,r){l=r,_(),e.callback({type:l.type,sdp:l.sdp,receivedSessionVersion:y,config:{maxVideoBW:e.maxVideoBW}})},T=function(r){return l=r,function(){l.sdp=t.enableSimulcast(l.sdp),l.type="answer",h=o.a.SDPInfo.processString(l.sdp),d.a.setMaxBW(h,e);var r=t.remoteSdp.getStreams().size,n=h.getStreams().size,i=s.a.reverse("sendrecv");i=0<r&&0<n?s.a.reverse("sendrecv"):0<r&&0===n?s.a.reverse("recvonly"):0===r&&0<n?s.a.reverse("sendonly"):s.a.reverse("inactive");h.getMedias().forEach((function(e){e.setDirection(i)})),l.sdp=h.toString(),t.localSdp=h}(),e.callback({type:l.type,sdp:l.sdp,receivedSessionVersion:y,config:{maxVideoBW:e.maxVideoBW}}),u.a.info("Setting local description",l),v("processOffer - Local Description",l.type),t.peerConnection.setLocalDescription(l).then((function(){t.setSimulcastLayersBitrate()}))};return t.enqueuedCalls={negotiationQueue:{createOffer:n.protectFunction((function(e,r){e=void 0!==e&&e,r=void 0!==r&&r,v("queue - createOffer"),n.startEnqueuing(),e||r||(t.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1}),(e=t.peerConnectionFsm.createOffer(e))?e.catch(E.bind(i)):(n.stopEnqueuing(),n.nextInQueue())})),processOffer:n.protectFunction((function(e){v("queue - processOffer"),n.startEnqueuing(),(e=t.peerConnectionFsm.processOffer(e))?e.catch(E.bind(i)):(n.stopEnqueuing(),n.nextInQueue())})),negotiateMaxBW:n.protectFunction((function(e,r){v("queue - negotiateMaxBW"),(e=t.peerConnectionFsm.negotiateMaxBW(e,r))?e.catch(E.bind(i)):n.nextInQueue()})),processNewCandidate:n.protectFunction((function(r){v("queue - processNewCandidate");try{var o="object"==typeof r.candidate?r.candidate:JSON.parse(r.candidate);if("end"===o.candidate)n.nextInQueue();else{o.candidate=o.candidate.replace(/a=/g,""),o.sdpMLineIndex=parseInt(o.sdpMLineIndex,10);var a=new RTCIceCandidate(o);e.remoteDescriptionSet?(n.startEnqueuing(),t.peerConnectionFsm.addIceCandidate(a).catch(E.bind(i))):e.remoteCandidates.push(a)}}catch(e){u.a.error("Error parsing candidate",r.candidate,e.message)}})),addStream:n.protectFunction((function(e){v("queue - addStream"),n.startEnqueuing(),(e=t.peerConnectionFsm.addStream(e))?e.catch(E.bind(i)):(n.stopEnqueuing(),n.nextInQueue())})),removeStream:n.protectFunction((function(e){v("queue - removeStream"),n.startEnqueuing(),(e=t.peerConnectionFsm.removeStream(e))?e.catch(E.bind(i)):(n.stopEnqueuing(),n.nextInQueue())})),close:n.protectFunction((function(){v("queue - close"),n.startEnqueuing();var e=t.peerConnectionFsm.close();e?e.catch(E.bind(i)):(n.stopEnqueuing(),n.nextInQueue())}))}},t.protectedCalls={protectedAddStream:function(e){try{t.peerConnection.addStream(e)}catch(e){setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0)}return Promise.resolve()},protectedRemoveStream:function(e){try{t.peerConnection.removeStream(e),setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0)}catch(e){setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0)}return Promise.resolve()},protectedCreateOffer:function(e){e=void 0!==e&&e,n.startEnqueuing(),v("Creating offer",t.mediaConstraints);var r=[];return t.peerConnection.createOffer(t.mediaConstraints).then(b.bind(null,e)).catch((function(e){r.push("in protectedCreateOffer-createOffer, error: "+e)})).then((function(){return 0!==r.length?Promise.reject(r):Promise.resolve()}))},protectedProcessOffer:function(r){u.a.info("Protected process Offer,",r,"localDesc",l);var s=(m=o.a.SDPInfo.processString(r.sdp))&&m.origin&&m.origin.sessionVersion;if(y>=s)return u.a.warning("message: processOffer discarding old sdp sessionVersion: "+s+", latestSessionVersion: "+y),v("processOffer - dropped"),e.callback({type:"offer-dropped"}),setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),Promise.resolve();y=s,d.a.setMaxBW(m,e),m.medias.forEach((function(e){e.getSetup()!==a.a.ACTPASS&&e.setSetup(a.a.ACTPASS)})),r.sdp=m.toString(),t.remoteSdp=m;var c=[];return v("processOffer - Remote Description",r.type),t.peerConnection.setRemoteDescription(r).then((function(){e.remoteDescriptionSet=!0,v("processOffer - Create Answer")})).then((function(){return t.peerConnection.createAnswer(t.mediaConstraints)})).catch((function(e){c.push("in: protectedProcessOffer-createAnswer, error: "+e)})).then(T.bind(i)).catch((function(e){c.push("in: protectedProcessOffer-setLocalDescForAnswer, error: "+e)})).then((function(){return v("processOffer - Stop enqueueing"),setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),0!==c.length?Promise.reject(c):Promise.resolve()}))},protectedProcessAnswer:function(r){var a=(m=o.a.SDPInfo.processString(r.sdp))&&m.origin&&m.origin.sessionVersion;if(y>=a)return u.a.warning("processAnswer discarding old sdp, sessionVersion: "+a+", latestSessionVersion: "+y),v("processAnswer - dropped"),e.callback({type:"answer-dropped"}),setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),Promise.resolve();y=a,u.a.info("Set remote and local description"),d.a.setMaxBW(m,e),t.setStartVideoBW(m),t.setHardMinVideoBW(m),r.sdp=m.toString(),_(),v("processAnswer - Local Description",l.type),t.remoteSdp=m,f=r;var s=[];return t.peerConnection.setLocalDescription(l).then((function(){t.setSimulcastLayersBitrate(),v("processAnswer - Remote Description",r.type),t.peerConnection.setRemoteDescription(new RTCSessionDescription(r))})).then((function(){for(e.remoteDescriptionSet=!0,u.a.info("Candidates to be added: ",e.remoteCandidates.length,e.remoteCandidates);0<e.remoteCandidates.length;)t.peerConnectionFsm.addIceCandidate(e.remoteCandidates.shift()).catch(E.bind(i));for(u.a.info("Local candidates to send:",e.localCandidates.length);0<e.localCandidates.length;)e.callback({type:"candidate",candidate:e.localCandidates.shift()})})).catch((function(e){v("precessAnswer - error",e),s.push("in: protectedProcessAnswer, error: "+e)})).then((function(){return v("processAnswer - Stop enqueuing"),setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),0!==s.length?Promise.reject(s):Promise.resolve()}))},protectedNegotiateMaxBW:function(r,i){if(r.Sdp||r.maxAudioBW){n.startEnqueuing();var a=[];_(),v("protectedNegotiateBW - Local Description",l.type),t.peerConnection.setLocalDescription(l).then((function(){return t.setSimulcastLayersBitrate(),m=o.a.SDPInfo.processString(f.sdp),d.a.setMaxBW(m,e),f.sdp=m.toString(),t.remoteSdp=m,v("protectedNegotiateBW - Remote Description",f.type),t.peerConnection.setRemoteDescription(new RTCSessionDescription(f))})).then((function(){e.remoteDescriptionSet=!0,e.callback({type:"offer-noanswer",sdp:l.sdp,receivedSessionVersion:y})})).catch((function(e){i("error","updateSpec"),a.push("in: protectedNegotiateMaxBW error: "+e)})).then((function(){return setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),0!==a.length?Promise.reject(a):Promise.resolve()}))}},protectedAddIceCandidate:function(e){var r=[];return t.peerConnection.addIceCandidate(e).catch((function(e){r.push("in: protectedAddIceCandidate, error: "+e)})).then((function(){return setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),0!==r.length?Promise.reject(r):Promise.resolve()}))},protectedClose:function(){return t.peerConnection.close(),setTimeout((function(){n.stopEnqueuing(),n.nextInQueue()}),0),Promise.resolve()}},t.peerConnection.onicecandidate=function(t){(t=t.candidate)?(t={sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid,candidate:t.candidate}).candidate.match(/a=/)||(t.candidate="a="+t.candidate):(u.a.info("Gathered all candidates. Sending END candidate"),t={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"}),e.remoteDescriptionSet?e.callback({type:"candidate",candidate:t,receivedSessionVersion:y}):(e.localCandidates.push(t),u.a.info("Storing candidate: ",e.localCandidates.length,t))},t.setStartVideoBW=function(e){return u.a.error("startVideoBW not implemented for this browser"),e},t.setHardMinVideoBW=function(e){return u.a.error("hardMinVideoBw not implemented for this browser"),e},t.enableSimulcast=function(e){return u.a.error("Simulcast not implemented"),e},t.updateSimulcastLayersBitrate=function(e){t.simulcast&&(t.simulcast.spatialLayerBitrates=e,t.setSimulcastLayersBitrate())},t.setSimulcastLayersBitrate=function(){u.a.error("Simulcast not implemented")},t.setSimulcast=function(e){t.simulcast=e},t.setVideo=function(e){t.video=e},t.setAudio=function(e){t.audio=e},t.updateSpec=function(r,n,i){i=void 0===i?function(){}:i;var o=e.p2p&&r.maxVideoBW,a=!e.p2p&&r.maxVideoBW;r.maxVideoBW&&(u.a.debug("Maxvideo Requested:",r.maxVideoBW,"limit:",e.limitMaxVideoBW),r.maxVideoBW>e.limitMaxVideoBW&&(r.maxVideoBW=e.limitMaxVideoBW),e.maxVideoBW=r.maxVideoBW,u.a.debug("Result",e.maxVideoBW)),r.maxAudioBW&&(r.maxAudioBW>e.limitMaxAudioBW&&(r.maxAudioBW=e.limitMaxAudioBW),e.maxAudioBW=r.maxAudioBW),(o||r.maxAudioBW)&&t.enqueuedCalls.negotiationQueue.negotiateMaxBW(r,i),(a||r.minVideoBW||void 0!==r.slideShowMode||void 0!==r.muteStream||void 0!==r.qualityLayer||void 0!==r.slideShowBelowLayer||void 0!==r.video)&&(u.a.debug("MaxVideoBW Changed to ",r.maxVideoBW),u.a.debug("MinVideo Changed to ",r.minVideoBW),u.a.debug("SlideShowMode Changed to ",r.slideShowMode),u.a.debug("muteStream changed to ",r.muteStream),u.a.debug("Video Constraints",r.video),u.a.debug("Will activate slideshow when below layer",r.slideShowBelowLayer),e.callback({type:"updatestream",config:r},n))},t.createOffer=t.enqueuedCalls.negotiationQueue.createOffer,t.sendOffer=t.enqueuedCalls.negotiationQueue.createOffer.bind(null,!0,!0),t.addStream=t.enqueuedCalls.negotiationQueue.addStream,t.removeStream=t.enqueuedCalls.negotiationQueue.removeStream,t.close=t.enqueuedCalls.negotiationQueue.close,t.processSignalingMessage=function(e){v("processSignalingMessage, type: ",e.type),"offer"===e.type?t.enqueuedCalls.negotiationQueue.processOffer(e):"answer"===e.type?t.peerConnectionFsm.processAnswer(e):"candidate"===e.type?t.enqueuedCalls.negotiationQueue.processNewCandidate(e):"error"===e.type&&u.a.error("Received error signaling message, state:",e.previousType,n.isEnqueueing())},t.peerConnectionFsm=new c.a(t.protectedCalls),t}},function(e,t){var r=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:"foundation component transport priority ip port type raddr rport tcptype generation network-id network-cost".split(" "),format:function(e){var t="candidate:%s %d %s %d %s %d typ %s"+(null!=e.raddr?" raddr %s rport %d":"%v%v");return t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:/^imageattr:(\d+|\*)[\s\t]+(send|recv)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*)(?:[\s\t]+(recv|send)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*))?/,names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:/^simulcast:(send|recv) ([a-zA-Z0-9\-_~;,]+)(?:\s?(send|recv) ([a-zA-Z0-9\-_~;,]+))?$/,names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach((function(e){r[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},function(e,t){var r=function(e,t,r,n,i,o,a,s,c,d){this.foundation=e,this.componentId=t,this.transport=r,this.priority=n,this.address=i,this.port=o,this.type=a,this.generation=s,this.relAddr=c,this.relPort=d};r.prototype.clone=function(){return new r(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.generation,this.relAddr,this.relPort)},r.prototype.plain=function(){var e={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type,generation:this.generation};return this.relAddr&&(e.relAddr=this.relAddr),this.relPort&&(e.relPort=this.relPort),e},r.prototype.getFoundation=function(){return this.foundation},r.prototype.getComponentId=function(){return this.componentId},r.prototype.getTransport=function(){return this.transport},r.prototype.getPriority=function(){return this.priority},r.prototype.getAddress=function(){return this.address},r.prototype.getPort=function(){return this.port},r.prototype.getType=function(){return this.type},r.prototype.getGeneration=function(){return this.generation},r.prototype.getRelAddr=function(){return this.relAddr},r.prototype.getRelPort=function(){return this.relPort},e.exports=r},function(e,t){var r=function(e,t,r,n,i,o){this.codec=e,this.type=t,this.rate=r,this.encoding=n,this.params=i||{},this.feedback=o||[]};r.prototype.clone=function(){var e=new r(this.codec,this.type,this.rate,this.encoding,this.params,this.feedback);return this.rtx&&e.setRTX(this.rtx),e},r.prototype.plain=function(){return{codec:this.codec,type:this.type,rate:this.rate,encoding:this.encoding,params:this.params,feedback:this.feedback}},r.prototype.setRTX=function(e){this.rtx=e},r.prototype.getType=function(){return this.type},r.prototype.setType=function(e){this.type=e},r.prototype.getCodec=function(){return this.codec},r.prototype.getParams=function(){return this.params},r.prototype.setParam=function(e,t){this.params[e]=t},r.prototype.hasRTX=function(){return this.rtx},r.prototype.getRTX=function(){return this.rtx},r.prototype.getRate=function(){return this.rate},r.prototype.getEncoding=function(){return this.encoding},r.prototype.getFeedback=function(){return this.feedback},r.mapFromNames=function(e,t){var n=new Map,i=96;return e.forEach((function(e){var o="pcmu"===(e=e.toLowerCase())?0:"pcma"===e?8:i+=1;o=new r(e,o),t&&"ulpfec"!==e&&"flexfec-03"!==e&&"red"!==e&&(i+=1,o.setRTX(i)),n.set(o.getCodec().toLowerCase(),o)})),n},e.exports=r},function(e,t,r){var n=r(2),i=function(e,t,r){this.setup=e,this.hash=t,this.fingerprint=r};i.prototype.clone=function(){return new i(this.setup,this.hash,this.fingerprint)},i.prototype.plain=function(){return{setup:n.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}},i.prototype.getFingerprint=function(){return this.fingerprint},i.prototype.getHash=function(){return this.hash},i.prototype.getSetup=function(){return this.setup},i.prototype.setSetup=function(e){this.setup=e},e.exports=i},function(e,t){function r(e){e=new Uint8Array(e);for(var t=0;t<e.length;t+=1)e[t]=Math.floor(256*Math.random()+0);return e}function n(e){return Array.prototype.map.call(new Uint8Array(e),(function(e){return("00"+e.toString(16)).slice(-2)})).join("")}var i=function(e,t,r){this.ufrag=e,this.pwd=t,this.opts=r,this.endOfCandidates=this.lite=!1};i.prototype.clone=function(){var e=new i(this.ufrag,this.pwd,this.opts);return e.setLite(this.lite),e.setEndOfCandidates(this.endOfCandidates),e},i.prototype.plain=function(){var e={ufrag:this.ufrag,pwd:this.pwd};return this.lite&&(e.lite=this.lite),this.endOfCandidates&&(e.endOfCandidates=this.endOfCandidates),e},i.prototype.getUfrag=function(){return this.ufrag},i.prototype.getPwd=function(){return this.pwd},i.prototype.isLite=function(){return this.lite},i.prototype.getOpts=function(){return this.opts},i.prototype.setLite=function(e){this.lite=e},i.prototype.isEndOfCandidates=function(){return this.endOfCandidates},i.prototype.setEndOfCandidates=function(e){this.endOfCandidates=e},i.generate=function(){var e=new i,t=r(8),o=r(24);return e.ufrag=n(t),e.pwd=n(o),e},e.exports=i},function(e,t,r){var n=r(16),i=r(4),o=r(3),a=function(e,t,r){this.id=e,this.type=r,this.port=t,this.direction=i.SENDRECV,this.extensions=new Map,this.codecs=new Map,this.rids=new Map,this.simulcast_03=this.simulcast=null,this.bitrate=0,this.connection=this.dtls=this.ice=null,this.candidates=[]};a.prototype.clone=function(){var e=new a(this.id,this.port,this.type);return e.setDirection(this.direction),e.setBitrate(this.bitrate),e.setConnection(this.connection),this.codecs.forEach((function(t){e.addCodec(t.clone())})),this.extensions.forEach((function(t,r){e.addExtension(r,t)})),this.rids.forEach((function(t,r){e.addRID(r,t.clone())})),this.simulcast&&e.setSimulcast(this.simulcast.clone()),this.xGoogleFlag&&e.setXGoogleFlag(this.xGoogleFlag),this.ice&&e.setICE(this.ice.clone()),this.dtls&&e.setDTLS(this.dtls.clone()),this.candidates.forEach((function(t){e.addCandidate(t.clone())})),this.setup&&e.setSetup(this.setup),e},a.prototype.plain=function(){var e={id:this.id,port:this.port,type:this.type,connection:this.connection,direction:i.toString(this.direction),xGoogleFlag:this.xGoogleFlag,extensions:{},rids:[],codecs:[],candidates:[]};return this.bitrate&&(e.bitrate=this.bitrate),this.codecs.forEach((function(t){e.codecs.push(t.plain())})),this.extensions.forEach((function(t){e.extensions.push(t.plain())})),this.rids.forEach((function(t){e.rids.push(t.plain())})),this.simulcast&&(e.simulcast=this.simulcast.plain()),this.candidates.forEach((function(t){e.candidates.push(t.plain())})),e.ice=this.ice&&this.ice.plain(),e.dtls=this.dtls&&this.dtls.plain(),e},a.prototype.getType=function(){return this.type},a.prototype.getPort=function(){return this.port},a.prototype.getId=function(){return this.id},a.prototype.addExtension=function(e,t){this.extensions.set(e,t)},a.prototype.addRID=function(e){this.rids.set(e.getId(),e)},a.prototype.addCodec=function(e){this.codecs.set(e.getType(),e)},a.prototype.getCodecForType=function(e){return this.codecs.get(e)},a.prototype.getCodec=function(e){var t;return this.codecs.forEach((function(r){r.getCodec().toLowerCase()===e.toLowerCase()&&(t=r)})),t},a.prototype.hasCodec=function(e){return null!==this.getCodec(e)},a.prototype.getCodecs=function(){return this.codecs},a.prototype.getExtensions=function(){return this.extensions},a.prototype.getRIDs=function(){return this.rids},a.prototype.getRID=function(e){return this.rids.get(e)},a.prototype.getBitrate=function(){return this.bitrate},a.prototype.setBitrate=function(e){this.bitrate=e},a.prototype.getDirection=function(){return this.direction},a.prototype.setDirection=function(e){this.direction=e},a.prototype.getDTLS=function(){return this.dtls},a.prototype.setDTLS=function(e){this.dtls=e},a.prototype.getICE=function(){return this.ice},a.prototype.setICE=function(e){this.ice=e},a.prototype.addCandidate=function(e){this.candidates.push(e)},a.prototype.addCandidates=function(e){var t=this;e.forEach((function(e){t.addCandidate(e)}))},a.prototype.getCandidates=function(){return this.candidates},a.prototype.setXGoogleFlag=function(e){this.xGoogleFlag=e},a.prototype.getXGoogleFlag=function(){return this.xGoogleFlag},a.prototype.getConnection=function(){return this.connection},a.prototype.setConnection=function(e){this.connection=e},a.prototype.answer=function(e){var t=new a(this.id,this.port,this.type);if(t.setDirection(i.reverse(this.direction)),e.codecs&&this.codecs.forEach((function(r){if(e.codecs.has(r.getCodec().toLowerCase())){var n=e.codecs.get(r.getCodec().toLowerCase()).clone();n.setType(r.getType()),n.hasRTX()&&n.setRTX(r.getRTX()),t.addCodec(n)}})),this.extensions.forEach((function(r,n){e.extensions.has(n)&&t.addExtension(n,r)})),e.simulcast&&this.simulcast){var r=new n,s=this.simulcast.getSimulcastStreams(o.SEND);s&&s.forEach((function(e){var t=[];e.forEach((function(e){t.push(e.clone())})),r.addSimulcastAlternativeStreams(o.RECV,t)})),(s=this.simulcast.getSimulcastStreams(o.RECV))&&s.forEach((function(e){var t=[];e.forEach((function(e){t.push(e.clone())})),r.addSimulcastAlternativeStreams(o.SEND,t)})),this.rids.forEach((function(e){var r=e.clone();r.setDirection(o.reverse(e.getDirection())),t.addRID(r)})),t.setSimulcast(r)}return t},a.prototype.getSimulcast=function(){return this.simulcast},a.prototype.setSimulcast=function(e){this.simulcast=e},a.prototype.getSimulcast03=function(){return this.simulcast_03},a.prototype.setSimulcast03=function(e){this.simulcast_03=e},a.prototype.getSetup=function(){return this.setup},a.prototype.setSetup=function(e){this.setup=e},e.exports=a},function(e,t,r){var n=r(3),i=function(){this.send=[],this.recv=[],this.plainString=null};i.prototype.clone=function(){var e=new i;return this.send.forEach((function(t){var r=[];t.forEach((function(e){r.push(e.clone())})),e.addSimulcastAlternativeStreams(n.SEND,r)})),this.recv.forEach((function(t){var r=[];t.forEach((function(e){r.push(e.clone())})),e.addSimulcastAlternativeStreams(n.RECV,r)})),e},i.prototype.plain=function(){var e={send:[],recv:[]};return this.send.forEach((function(t){var r=[];t.forEach((function(e){r.push(e.plain())})),e.send.push(r)})),this.recv.forEach((function(t){var r=[];t.forEach((function(e){r.push(e.plain())})),e.recv.push(r)})),e},i.prototype.addSimulcastAlternativeStreams=function(e,t){return e===n.SEND?this.send.push(t):this.recv.push(t)},i.prototype.addSimulcastStream=function(e,t){return e===n.SEND?this.send.push([t]):this.recv.push([t])},i.prototype.getSimulcastStreams=function(e){return e===n.SEND?this.send:this.recv},i.prototype.setSimulcastPlainString=function(e){this.plainString=e},i.prototype.getSimulcastPlainString=function(){return this.plainString},e.exports=i},function(e,t){var r=function(e,t){var r=this;this.semantics=e,this.ssrcs=[],t.forEach((function(e){r.ssrcs.push(parseInt(e,10))}))};r.prototype.clone=function(){return new r(this.semantics,this.ssrcs)},r.prototype.plain=function(){var e={semantics:this.semantics,ssrcs:[]};return e.ssrcs=this.ssrcs,e},r.prototype.getSemantics=function(){return this.semantics},r.prototype.getSSRCs=function(){return this.ssrcs},e.exports=r},function(e,t){var r=function(e){this.ssrc=e};r.prototype.clone=function(){var e=new r(this.ssrc);e.setCName(this.cname),e.setStreamId(this.streamId),this.setTrackId(this.trackId)},r.prototype.plain=function(){var e={ssrc:this.ssrc};return this.cname&&(e.cname=this.cname),this.label&&(e.label=this.label),this.mslabel&&(e.mslabel=this.mslabel),this.streamId&&(e.streamId=this.streamId),this.trackId&&(e.trackid=this.trackId),e},r.prototype.getCName=function(){return this.cname},r.prototype.setCName=function(e){this.cname=e},r.prototype.getStreamId=function(){return this.streamId},r.prototype.setStreamId=function(e){this.streamId=e},r.prototype.getTrackId=function(){return this.trackId},r.prototype.setTrackId=function(e){this.trackId=e},r.prototype.getMSLabel=function(){return this.mslabel},r.prototype.setMSLabel=function(e){this.mslabel=e},r.prototype.getLabel=function(){return this.label},r.prototype.setLabel=function(e){this.label=e},r.prototype.getSSRC=function(){return this.ssrc},e.exports=r},function(e,t){var r=function(e){this.id=e,this.tracks=new Map};r.prototype.clone=function(){var e=new r(this.id);return this.tracks.forEach((function(t){e.addTrack(t.clone())})),e},r.prototype.plain=function(){var e={id:this.id,tracks:[]};return this.tracks.forEach((function(t){e.tracks.push(t.plain())})),e},r.prototype.getId=function(){return this.id},r.prototype.addTrack=function(e){this.tracks.set(e.getId(),e)},r.prototype.getFirstTrack=function(e){var t;return this.tracks.forEach((function(r){r.getMedia().toLowerCase()===e.toLowerCase()&&(t=r)})),t},r.prototype.getTracks=function(){return this.tracks},r.prototype.removeAllTracks=function(){this.tracks.clear()},r.prototype.getTrack=function(e){return this.tracks.get(e)},e.exports=r},function(e,t){var r=function(e,t){this.media=e,this.id=t,this.ssrcs=[],this.groups=[],this.encodings=[]};r.prototype.clone=function(){var e=new r(this.media,this.id);return this.mediaId&&e.setMediaId(this.mediaId),this.ssrcs.forEach((function(t){e.addSSRC(t)})),this.groups.forEach((function(t){e.addSourceGroup(t.clone())})),this.encodings.forEach((function(t){var r=[];t.forEach((function(e){r.push(e.cloned())})),e.addAlternativeEncoding(r)})),e},r.prototype.plain=function(){var e={media:this.media,id:this.id,ssrcs:[],groups:[],encodings:[]};return this.mediaId&&(e.mediaId=this.mediaId),this.ssrcs.forEach((function(t){e.ssrcs.push(t)})),this.groups.forEach((function(t){e.groups.push(t.plain())})),this.encodings.forEach((function(t){var r=[];t.forEach((function(e){r.push(e.plain())})),e.encodings.push(r)})),e},r.prototype.getMedia=function(){return this.media},r.prototype.setMediaId=function(e){this.mediaId=e},r.prototype.getMediaId=function(){return this.mediaId},r.prototype.getId=function(){return this.id},r.prototype.addSSRC=function(e){this.ssrcs.push(e)},r.prototype.getSSRCs=function(){return this.ssrcs},r.prototype.addSourceGroup=function(e){this.groups.push(e)},r.prototype.getSourceGroup=function(e){var t;return this.groups.forEach((function(r){r.getSemantics().toLowerCase()===e.toLowerCase()&&(t=r)})),t},r.prototype.getSourceGroups=function(){return this.groups},r.prototype.hasSourceGroup=function(e){var t=!1;return this.groups.forEach((function(r){r.getSemantics().toLowerCase()===e.toLowerCase()&&(t=!0)})),t},r.prototype.getEncodings=function(){return this.encodings},r.prototype.addAlternaticeEncodings=function(e){this.encodings.push(e)},r.prototype.setEncodings=function(e){this.encodings=e},e.exports=r},function(e,t,r){t.a={addSim:function(e){var t="a=ssrc-group:SIM";return e.forEach((function(e){t+=" "+e})),t+"\r\n"},addGroup:function(e,t){return"a=ssrc-group:FID "+e+" "+t+"\r\n"},addSpatialLayer:function(e,t,r,n,i,o){return"a=ssrc:"+i+" cname:"+e+"\r\na=ssrc:"+i+" msid:"+t+"\r\na=ssrc:"+i+" mslabel:"+r+"\r\na=ssrc:"+i+" label:"+n+"\r\na=ssrc:"+o+" cname:"+e+"\r\na=ssrc:"+o+" msid:"+t+"\r\na=ssrc:"+o+" mslabel:"+r+"\r\na=ssrc:"+o+" label:"+n+"\r\n"},setMaxBW:function(e,t){if(t.p2p){if(t.video&&t.maxVideoBW){var r=e.getMedia("video");r&&r.setBitrate(t.maxVideoBW)}t.audio&&t.maxAudioBW&&(e=e.getMedia("audio"))&&e.setBitrate(t.maxAudioBW)}},enableOpusNacks:function(e){var t=e.match(/a=rtpmap:(.*)opus.*\r\n/);return null!==t&&(e=e.replace(t[0],t[0]+"a=rtcp-fb:"+t[1]+"nack\r\n")),e},setParamForCodecs:function(e,t,r,n){e.medias.forEach((function(e){e.id===t&&e.codecs.forEach((function(e){e.setParam(r,n)}))}))}}},function(e,t,r){var n=this,i=r(1),o=r(8),a=r(7),s=r(44),c=r(45),d=r(47),u=r(0);t.a=function(e,t){var r=Object(i.b)(t);r.stream=t.stream,r.url=t.url,r.recording=t.recording,r.room=void 0,r.showing=!1,r.local=!1,r.video=t.video,r.audio=t.audio,r.screen=t.screen,r.videoSize=t.videoSize,r.videoFrameRate=t.videoFrameRate,r.extensionId=t.extensionId,r.desktopStreamId=t.desktopStreamId,r.audioMuted=!1,r.videoMuted=!1,r.unsubscribing={callbackReceived:!1,pcEventReceived:!1},r.p2p=!1,r.ConnectionHelpers=void 0===e?o.a:e,void 0!==r.url&&(t.label="ei_"+s.a.getRandomValue());var p=function(e){e.stream.id===r.getLabel()&&r.emit(Object(i.f)({type:"added",stream:e.stream}))},l=function(e){e.stream.id===r.getLabel()&&r.emit(Object(i.f)({type:"removed",stream:r}))},f=function(e){r.emit(Object(i.f)({type:"icestatechanged",msg:e}))};if(!(void 0===r.videoSize||r.videoSize instanceof Array&&4===r.videoSize.length))throw Error("Invalid Video Size");void 0!==t.local&&!0!==t.local||(r.local=!0),r.getID=function(){return r.local&&!t.streamID?"local":t.streamID},r.getLabel=function(){return r.stream&&r.stream.id?r.stream.id:t.label},r.getAttributes=function(){return t.attributes},r.setAttributes=function(e){r.local?r.emit(Object(i.f)({type:"internal-set-attributes",stream:r,attrs:e})):u.a.error("Failed to set attributes data. This Stream object has not been published.")},r.updateLocalAttributes=function(e){t.attributes=e},r.hasAudio=function(){return!1!==t.audio&&void 0!==t.audio},r.hasVideo=function(){return!1!==t.video&&void 0!==t.video},r.hasData=function(){return!1!==t.data&&void 0!==t.data},r.hasScreen=function(){return t.screen},r.hasMedia=function(){return t.audio||t.video||t.screen},r.isExternal=function(){return void 0!==r.url||void 0!==r.recording},r.addPC=function(e,t){t?(r.p2p=!0,void 0===r.pc&&(r.pc=Object(a.a)()),r.pc.add(t,e),e.on("ice-state-change",f)):(r.pc&&(r.pc.off("add-stream",p),r.pc.off("remove-stream",l),r.pc.off("ice-state-change",f)),r.pc=e,r.pc.on("add-stream",p),r.pc.on("remove-stream",l),r.pc.on("ice-state-change",f))},r.sendData=function(e){r.local&&r.hasData()?r.emit(Object(i.f)({type:"internal-send-data",stream:r,msg:e})):u.a.error("Failed to send data. This Stream object has not been published.")},r.init=function(){try{if((t.audio||t.video||t.screen)&&void 0===t.url){u.a.info("Requested access to local media");var e=t.video;!0===e||!0===t.screen?(e=!0===e||null===e?{}:e,void 0!==r.videoSize&&(e.width={min:r.videoSize[0],max:r.videoSize[2]},e.height={min:r.videoSize[1],max:r.videoSize[3]}),void 0!==r.videoFrameRate&&(e.frameRate={min:r.videoFrameRate[0],max:r.videoFrameRate[1]})):!0===t.screen&&void 0===e&&(e=!0),r.ConnectionHelpers.GetUserMedia({video:e,audio:t.audio,fake:t.fake,screen:t.screen,extensionId:r.extensionId,desktopStreamId:r.desktopStreamId},(function(e){u.a.info("User has granted access to local media."),r.stream=e,r.dispatchEvent(Object(i.f)({type:"access-accepted"})),r.stream.getTracks().forEach((function(e){u.a.info("getTracks",e),e.onended=function(){r.stream.getTracks().forEach((function(e){e.onended=null}));var t=Object(i.f)({type:"stream-ended",stream:r,msg:e.kind});r.dispatchEvent(t)}}))}),(function(e){u.a.error("Failed to get access to local media. Error was "+e.name+" with message "+e.message+"."),e=Object(i.f)({type:"access-denied",msg:e}),r.dispatchEvent(e)}))}else{var n=Object(i.f)({type:"access-accepted"});r.dispatchEvent(n)}}catch(t){u.a.error("Failed to get access to local media. Error was "+t+"."),e=Object(i.f)({type:"access-denied",msg:t}),r.dispatchEvent(e)}},r.close=function(){r.local&&(void 0!==r.room&&r.room.unpublish(r),r.hide(),void 0!==r.stream&&r.stream.getTracks().forEach((function(e){e.onended=null,e.stop()})),r.stream=void 0),r.pc&&!r.p2p?(r.pc.off("add-stream",p),r.pc.off("remove-stream",l),r.pc.off("ice-state-change",f)):r.pc&&r.p2p&&r.pc.forEach((function(e){e.off("add-stream",p),e.off("remove-stream",l),e.off("ice-state-change",f)})),r.removeAllListeners()},r.play=function(e,t){t=t||{},r.elementID=e,r.hasVideo()||r.hasScreen()?void 0!==e&&(e=Object(c.a)({id:r.getID(),stream:r,elementID:e,options:t}),r.player=e,r.showing=!0):r.hasAudio()&&(e=Object(d.a)({id:r.getID(),stream:r,elementID:e,options:t}),r.player=e,r.showing=!0)},r.stop=function(){r.showing&&void 0!==r.player&&(r.player.destroy(),r.showing=!1)},r.show=r.play,r.hide=r.stop;var h=function(){if(void 0!==r.player&&void 0!==r.stream){var e=r.player.video,t=document.defaultView.getComputedStyle(e),n=parseInt(t.getPropertyValue("width"),10),i=parseInt(t.getPropertyValue("height"),10),o=parseInt(t.getPropertyValue("left"),10),a=(t=parseInt(t.getPropertyValue("top"),10),"object"==typeof r.elementID&&"function"==typeof r.elementID.appendChild?r.elementID:document.getElementById(r.elementID)),s=document.defaultView.getComputedStyle(a);a=parseInt(s.getPropertyValue("width"),10);s=parseInt(s.getPropertyValue("height"),10);var c=document.createElement("canvas");return c.id="testing",c.width=a,c.height=s,c.setAttribute("style","display: none"),c.getContext("2d").drawImage(e,o,t,n,i),c}return null};r.getVideoFrameURL=function(e){var t=h();return null!==t?e?t.toDataURL(e):t.toDataURL():null},r.getVideoFrame=function(){var e=h();return null!==e?e.getContext("2d").getImageData(0,0,e.width,e.height):null},r.checkOptions=function(e,t){!0===t?(e.audio||e.screen)&&(u.a.warning("Cannot update type of subscription"),e.audio=void 0,e.screen=void 0):!1===r.local&&(!0===e.video&&!1===r.hasVideo()&&(u.a.warning("Trying to subscribe to video when there is no video, won't subscribe to video"),e.video=!1),!0===e.audio&&!1===r.hasAudio()&&(u.a.warning("Trying to subscribe to audio when there is no audio, won't subscribe to audio"),e.audio=!1)),!1!==r.local||r.hasVideo()||!0!==e.slideShowMode||(u.a.warning("Cannot enable slideShowMode if it is not a video subscription, please check your parameters"),e.slideShowMode=!1)};var m=function(e){if(e=void 0===e?function(){}:e,r.room&&r.room.p2p)u.a.warning("muteAudio/muteVideo are not implemented in p2p streams"),e("error");else{r.stream&&r.pc||(u.a.warning("muteAudio/muteVideo cannot be called until a stream is published or subscribed"),e("error"));for(var t=0;t<r.stream.getVideoTracks().length;t+=1)r.stream.getVideoTracks()[t].enabled=!r.videoMuted;t={muteStream:{audio:r.audioMuted,video:r.videoMuted}},r.checkOptions(t,!0),r.pc.updateSpec(t,r.getID(),e)}};r.muteAudio=function(e,t){r.audioMuted=e,m(void 0===t?function(){}:t)},r.muteVideo=function(e,t){r.videoMuted=e,m(void 0===t?function(){}:t)},r._setStaticQualityLayer=function(e,t,n){n=void 0===n?function(){}:n,r.room&&r.room.p2p?(u.a.warning("setStaticQualityLayer is not implemented in p2p streams"),n("error")):(e={qualityLayer:{spatialLayer:e,temporalLayer:t}},r.checkOptions(e,!0),r.pc.updateSpec(e,r.getID(),n))},r._setDynamicQualityLayer=function(e){if(r.room&&r.room.p2p)u.a.warning("setDynamicQualityLayer is not implemented in p2p streams"),e("error");else{var t={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};r.checkOptions(t,!0),r.pc.updateSpec(t,r.getID(),e)}},r._enableSlideShowBelowSpatialLayer=function(e,t,n){t=void 0===t?0:t,n=void 0===n?function(){}:n,r.room&&r.room.p2p?(u.a.warning("enableSlideShowBelowSpatialLayer is not implemented in p2p streams"),n("error")):(e={slideShowBelowLayer:{enabled:e,spatialLayer:t}},r.checkOptions(e,!0),u.a.debug("Calling updateSpec with config",e),r.pc.updateSpec(e,r.getID(),n))},r._setMinSpatialLayer=r._enableSlideShowBelowSpatialLayer.bind(n,!0);var y=function(e,t,n){!0!==t&&(t=!1),0<(e=(e="string"==typeof e?[e]:e)instanceof Array?e:[]).length&&r.room.sendControlMessage(r,"control",{name:"controlhandlers",enable:n,publisherSide:t,handlers:e})};return r.disableHandlers=function(e,t){y(e,t,!1)},r.enableHandlers=function(e,t){y(e,t,!0)},r.updateSimulcastLayersBitrate=function(e){r.pc&&r.local&&r.pc.updateSimulcastLayersBitrate(e)},r.updateConfiguration=function(e,t){if(t=void 0===t?function(){}:t,void 0!==e)if(r.pc)if(r.checkOptions(e,!0),r.local)if(r.room.p2p)for(var n=0;n<r.pc.length;n+=1)r.pc[n].updateSpec(e,r.getID(),t);else r.pc.updateSpec(e,r.getID(),t);else r.pc.updateSpec(e,r.getID(),t);else t("This stream has no peerConnection attached, ignoring")},r}},function(e,t,r){var n=r(5),i=r(46);t.a=function(e){var t,r=Object(n.a)({});r.elementID=e.elementID,r.id=e.id,r.div=document.createElement("div"),r.div.setAttribute("id","bar_"+r.id),r.div.setAttribute("class","licode_bar"),r.bar=document.createElement("div"),r.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)"),r.bar.setAttribute("id","subbar_"+r.id),r.bar.setAttribute("class","licode_subbar"),r.link=document.createElement("a"),r.link.setAttribute("href","http://www.lynckia.com/"),r.link.setAttribute("class","licode_link"),r.link.setAttribute("target","_blank"),r.logo=document.createElement("img"),r.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;"),r.logo.setAttribute("class","licode_logo"),r.logo.setAttribute("alt","Lynckia"),r.logo.setAttribute("src",r.url+"/assets/star.svg");var o=function(e){var n=e;"block"!==e?n="none":clearTimeout(t),r.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+n)};return r.display=function(){o("block")},r.hide=function(){t=setTimeout(o,1e3)},document.getElementById(r.elementID).appendChild(r.div),r.div.appendChild(r.bar),r.bar.appendChild(r.link),r.link.appendChild(r.logo),e.stream.screen||void 0!==e.options&&void 0!==e.options.speaker&&!0!==e.options.speaker||(r.speaker=Object(i.a)({elementID:"subbar_"+r.id,id:r.id,stream:e.stream,media:e.media})),r.display(),r.hide(),r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),e=r(25);var n=r(1),i=r(22),o=r(0);r(49),r={Room:e.a.bind(null,void 0,void 0,void 0),LicodeEvent:n.d,RoomEvent:n.e,StreamEvent:n.f,ConnectionEvent:n.a,Stream:i.a.bind(null,void 0),UnboundStream:i.a,Logger:o.a},t.default=r},function(e,t,n){var i=n(26),o=n(8),a=n(1),s=n(42),c=n(22),d=n(7),u=n(48),p=n(0);t.a=function(e,t,n,l){var f=Object(a.b)(l);f.remoteStreams=Object(d.a)(),f.localStreams=Object(d.a)(),f.roomID="",f.state=0,f.p2p=!1,f.minConnectionQualityLevel="",f.ConnectionHelpers=void 0===t?o.a:t,f.erizoConnectionManager=void 0===n?new i.a:new n.ErizoConnectionManager;var h=Object(s.a)(e);f.socket=h;var m=f.remoteStreams,y=f.localStreams,g=function(e){e.removeAllListeners(),e.pc&&!f.p2p&&e.pc.removeStream(e),p.a.debug("Removed stream"),e.stream&&(e.hide(),e.stop(),e.close(),delete e.stream),e.pc&&(e.local&&f.p2p?e.pc.forEach((function(t,r){t.close(),e.pc.remove(r)})):(f.erizoConnectionManager.maybeCloseConnection(e.pc),delete e.pc))},v=function(e,t){p.a.info("Stream subscribed"),e.stream=t.stream,f.p2p||e.pc.addStream(e),e.state="subscribed",e=Object(a.f)({type:"stream-subscribed",stream:e}),f.dispatchEvent(e)},E=function(e){p.a.debug("maybeDispatchStreamUnsubscribed - unsubscribe id "+e.getID(),e.unsubscribing),e&&e.unsubscribing.callbackReceived&&(e.unsubscribing.pcEventReceived||e.failed)?(p.a.info("Dispatching Stream unsubscribed "+e.getID()),e.unsubscribing.callbackReceived=!1,e.unsubscribing.pcEventReceived=!1,g(e),delete e.failed,e.state="unsubscribed",e=Object(a.f)({type:"stream-unsubscribed",stream:e}),f.dispatchEvent(e)):p.a.debug("Not dispatching stream unsubscribed yet "+e.getID())},S=function(){var e=Object(a.a)({type:"connection-failed"});f.dispatchEvent(e)},_=function(e,t,r){0!==f.state&&e&&!e.failed&&(e.failed=!0,t=Object(a.f)({type:"stream-failed",msg:t||"Stream failed after connection",stream:e,origin:void 0===r?"unknown":r}),f.dispatchEvent(t),t=e.pc,e.local?f.unpublish(e):e.unsubscribing.callbackReceived?E(e):f.unsubscribe(e),t&&l.singlePC&&f.erizoConnectionManager.maybeCloseConnection(t,!0))},b=function(e,t){return{callback:function(r,n){h.sendSDP("streamMessageP2P",{streamId:e.getID(),streamIds:n,peerSocket:t,msg:r})},audio:e.hasAudio(),video:e.hasVideo(),iceServers:f.iceServers,maxAudioBW:e.maxAudioBW,maxVideoBW:e.maxVideoBW,limitMaxAudioBW:l.maxAudioBW,limitMaxVideoBW:l.maxVideoBW,forceTurn:e.forceTurn,p2p:!0}},T=function(e){f.remoteStreams.forEach((function(t){t.local||t.getLabel()!==e||(t.unsubscribing.pcEventReceived=!0,E(t))}))},C=function(e,t,r,n,i){var o={callback:function(n,i){i=void 0===i?e.getID():i,p.a.info("Sending message",n,e.getID(),i),n&&n.type&&"updatestream"===n.type?h.sendSDP("streamMessage",{streamId:i,erizoId:r,msg:n,browser:e.pc&&e.pc.browser},void 0,(function(){})):h.sendSDP("connectionMessage",{connectionId:t,erizoId:r,msg:n,browser:e.pc&&e.pc.browser},void 0,(function(){}))},connectionId:t,nop2p:!0,audio:n.audio&&e.hasAudio(),video:n.video&&e.hasVideo(),maxAudioBW:n.maxAudioBW,maxVideoBW:n.maxVideoBW,limitMaxAudioBW:l.maxAudioBW,limitMaxVideoBW:l.maxVideoBW,label:e.getLabel(),iceServers:f.iceServers,forceTurn:e.forceTurn,p2p:!1,streamRemovedListener:T};return i||(o.simulcast=n.simulcast,o.startVideoBW=n.startVideoBW,o.hardMinVideoBW=n.hardMinVideoBW),o},R=function(e,t,r,n){var i=C(e,t,r,n,!0),o=f.erizoConnectionManager.getOrBuildErizoConnection(i,r,l.singlePC);e.addPC(o),o.on("connection-failed",(function(){S()})),e.on("added",v.bind(null,e)),e.on("icestatechanged",(function(t){p.a.info(e.getID()+" - iceConnectionState: "+t.msg.state),"failed"===t.msg.state&&(_(e,"ICE Connection Failed","ice-client"),l.singlePC&&i.callback({type:"failed"}))}))},A=function(e){var t=e.stream;e=e.msg,t.local?h.sendMessage("sendDataStream",{id:t.getID(),msg:e}):p.a.error("You can not send data through a remote stream")},O=function(e){var t=e.stream;e=e.attrs,t.local?(t.updateLocalAttributes(e),h.sendMessage("updateStreamAttributes",{id:t.getID(),attrs:e})):p.a.error("You can not update attributes in a remote stream")};e=function(e,t){t.args?e.apply(null,[].concat(r.arrayFromIterable(t.args))):e()};var I=function(e,t,r){return{state:e,data:t.hasData(),audio:t.hasAudio(),video:t.hasVideo(),label:t.getLabel(),screen:t.hasScreen(),attributes:t.getAttributes(),metadata:r.metadata,createOffer:r.createOffer,muteStream:r.muteStream}},P=function(e,t,r,n){n=void 0===n?function(){}:n,null===e?(p.a.error("Error when publishing the stream",r),n(void 0,r)):(p.a.info("Stream published"),t.getID=function(){return e},t.on("internal-send-data",A),t.on("internal-set-attributes",O),y.add(e,t),t.room=f,n(e))},w=function(e,t,r){r=void 0===r?function(){}:r,p.a.info("Publishing to Erizo Normally, is createOffer",t.createOffer);var n=I("erizo",e,t);n.minVideoBW=t.minVideoBW,n.maxVideoBW=t.maxVideoBW,n.scheme=t.scheme,h.sendSDP("publish",n,void 0,(function(n,i,o,a){null===n?(p.a.error("Error publishing stream",a),r(void 0,a)):(P(n,e,a,void 0),function(e,t,r,n){var i=C(e,t,r,n),o=f.erizoConnectionManager.getOrBuildErizoConnection(i,r,l.singlePC);e.addPC(o),o.on("connection-failed",(function(){S()})),e.on("icestatechanged",(function(t){p.a.info(e.getID()+" - iceConnectionState: "+t.msg.state),"failed"===t.msg.state&&(_(e,"ICE Connection Failed","ice-client"),l.singlePC&&i.callback({type:"failed"}))})),e.pc.addStream(e)}(e,o,i,t),r(n))}))},k=function(e,t){e=t&&e.hasVideo();var r=t&&t.width,n=t&&t.height;return t=t&&t.frameRate,r||n||t?{width:r,height:n,frameRate:t}:e};return f.connect=function(e){e=void 0===e?{}:e;var t=u.a.decodeBase64(l.token);0!==f.state&&p.a.warning("Room already connected, roomId: "+f.roomID),f.state=1,h.connect(JSON.parse(t),e,(function(e){var t=[],r=e.streams||[],n=e.id;f.p2p=e.p2p,f.iceServers=e.iceServers,f.state=2,l.singlePC=e.singlePC,l.defaultVideoBW=e.defaultVideoBW,l.maxVideoBW=e.maxVideoBW;for(var i=Object.keys(r),o=0;o<i.length;o+=1){var s=r[i[o]];(e=Object(c.a)(f.ConnectionHelpers,{streamID:s.id,local:!1,audio:s.audio,video:s.video,data:s.data,label:s.label,screen:s.screen,attributes:s.attributes})).room=f,e.state="unsubscribed",t.push(e),m.add(s.id,e)}f.roomID=n,p.a.info("Connected to room, roomId "+f.roomID),t=Object(a.e)({type:"room-connected",streams:t}),f.dispatchEvent(t)}),(function(e){p.a.error("Error connecting to room, roomId: "+f.roomID+", Error:",e),e=Object(a.e)({type:"room-error",message:e}),f.dispatchEvent(e)}))},f.disconnect=function(){p.a.debug("Disconnection requested");var e=Object(a.e)({type:"room-disconnected",message:"expected-disconnection"});f.dispatchEvent(e)},f.publish=function(e,t,r){r=void 0===r?function(){}:r,(t=void 0===t?{}:t).maxVideoBW=t.maxVideoBW||l.defaultVideoBW,t.maxVideoBW>l.maxVideoBW&&(t.maxVideoBW=l.maxVideoBW),void 0===t.minVideoBW&&(t.minVideoBW=0),t.minVideoBW>l.defaultVideoBW&&(t.minVideoBW=l.defaultVideoBW),e.forceTurn=t.forceTurn,t.simulcast=t.simulcast||!1,t.muteStream={audio:e.audioMuted,video:e.videoMuted},e&&e.local&&!e.failed&&!y.has(e.getID())?e.hasMedia()?e.isExternal()?function(e,t,r){if(r=void 0===r?function(){}:r,e.url)var n="url",i=e.url;else n="recording",i=e.recording;p.a.info("Checking publish options for",e.getID()),e.checkOptions(t),h.sendSDP("publish",I(n,e,t),i,(function(t,n){P(t,e,n,r)}))}(e,t,r):f.p2p?function(e,t,r){r=void 0===r?function(){}:r,e.maxAudioBW=t.maxAudioBW,e.maxVideoBW=t.maxVideoBW,h.sendSDP("publish",I("p2p",e,t),void 0,(function(t,n){P(t,e,n,r)}))}(e,t,r):w(e,t,r):e.hasData()&&function(e,t,r){r=void 0===r?function(){}:r,h.sendSDP("publish",I("data",e,t),void 0,(function(t,n){P(t,e,n,r)}))}(e,t,r):(p.a.error("Trying to publish invalid stream, stream:",e),r(void 0,"Invalid Stream"))},f.startRecording=function(e,t){t=void 0===t?function(){}:t,void 0===e?(p.a.error("Trying to start recording on an invalid stream, stream:",e),t(void 0,"Invalid Stream")):(p.a.debug("Start Recording stream, streamId: "+e.getID()),h.sendMessage("startRecorder",{to:e.getID()},(function(r,n){null===r?(p.a.error("Error on start recording, streamId: "+e.getID()+", error:",n),t(void 0,n)):(p.a.info("Start recording",r),t(r))})))},f.stopRecording=function(e,t){t=void 0===t?function(){}:t,h.sendMessage("stopRecorder",{id:e},(function(r,n){null===r?(p.a.error("Error on stop recording, recordingId: "+e+", error:",n),t(void 0,n)):(p.a.info("Stop recording",e),t(!0))}))},f.unpublish=function(e,t){if(t=void 0===t?function(){}:t,e&&e.local){if(h.sendMessage("unpublish",e.getID(),(function(r,n){null===r?(p.a.error("Error unpublishing stream, streamId: "+e.getID()+", error:",n),t(void 0,n)):(delete e.failed,t(!0))})),p.a.info("Stream unpublished, streamId: "+e.getID()),e.room=void 0,e.hasMedia()&&!e.isExternal()){var r=y.has(e.getID())?y.get(e.getID()):e;g(r)}y.remove(e.getID()),e.getID=function(){},e.off("internal-send-data",A),e.off("internal-set-attributes",O)}else p.a.error("Cannot unpublish, stream does not exist or is not local"),t(void 0,"Cannot unpublish, stream does not exist or is not local")},f.sendControlMessage=function(e,t,r){e&&e.getID()&&(t={type:"control",action:r},h.sendSDP("streamMessage",{streamId:e.getID(),msg:t}))},f.subscribe=function(e,t,r){if(t=void 0===t?{}:t,r=void 0===r?function(){}:r,!e||e.local||e.failed)t="Error on subscribe",e.state="unsubscribed",e?e.local?(p.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),t="Local copy of stream"):e.failed&&(p.a.warning("Cannot subscribe to failed stream, streamId: "+e.getID()+", unsubscribing:",e.unsubscribing," failed: ",e.failed),t="Failed stream"):(p.a.warning("Cannot subscribe to invalid stream, streamId: "+e.getID()),t="Invalid or undefined stream"),r(void 0,t);else if("unsubscribed"!==e.state)p.a.warning("Cannot subscribe to a subscribed stream, streamId: "+e.getID()),r(void 0,"Stream already subscribed");else{if(e.state="subscribing",e.hasMedia())if(e.hasVideo()||e.hasScreen()||(t.video=!1),e.hasAudio()||(t.audio=!1),t.muteStream={audio:e.audioMuted,video:e.videoMuted},e.forceTurn=t.forceTurn,f.p2p){var n=m.get(e.getID());n.maxAudioBW=t.maxAudioBW,n.maxVideoBW=t.maxVideoBW,h.sendSDP("subscribe",{streamId:e.getID(),metadata:t.metadata}),r(!0)}else!function(e,t,r){r=void 0===r?function(){}:r,t.maxVideoBW=t.maxVideoBW||l.defaultVideoBW,t.maxVideoBW>l.maxVideoBW&&(t.maxVideoBW=l.maxVideoBW),t.audio=void 0===t.audio||t.audio,t.video=void 0===t.video||t.video,t.data=void 0===t.data||t.data,t.offerFromErizo=void 0===t.offerFromErizo||t.offerFromErizo,e.checkOptions(t);var n={streamId:e.getID(),audio:t.audio&&e.hasAudio(),video:k(e,t.video),maxVideoBW:t.maxVideoBW,data:t.data&&e.hasData(),browser:f.ConnectionHelpers.getBrowser(),createOffer:t.createOffer,offerFromErizo:t.offerFromErizo,metadata:t.metadata,muteStream:t.muteStream,slideShowMode:t.slideShowMode};h.sendSDP("subscribe",n,void 0,(function(n,i,o,a){null===n?(p.a.error("Error subscribing to stream, streamId: "+e.getID()+", error:",a),e.state="unsubscribed",r(void 0,a)):(p.a.info("Subscriber added",i,o),R(e,o,i,t),t.offerFromErizo||e.pc.sendOffer(),r(!0))}))}(e,t,r);else{if(!e.hasData()||!1===t.data)return p.a.warning("There is nothing to subscribe to in stream, streamId: "+e.getID()),e.state="unsubscribed",void r(void 0,"Nothing to subscribe to");!function(e,t,r){r=void 0===r?function(){}:r,h.sendSDP("subscribe",{streamId:e.getID(),data:t.data,metadata:t.metadata},void 0,(function(t,n){null===t?(p.a.error("Error subscribing to stream, streamId: "+e.getID()+", error:",n),e.state="unsubscribed",r(void 0,n)):(p.a.info("Stream subscribed"),t=Object(a.f)({type:"stream-subscribed",stream:e}),f.dispatchEvent(t),r(!0))}))}(e,t,r)}p.a.info("Subscribing to: "+e.getID())}},f.unsubscribe=function(e,t){t=void 0===t?function(){}:t,void 0!==h&&(e&&!e.local?"subscribed"!==e.state?(p.a.warning("Cannot unsubscribe to a stream that is not subscribed, streamId: "+e.getID()),t(void 0,"Stream not subscribed")):(e.state="unsubscribing",h.sendMessage("unsubscribe",e.getID(),(function(r,n){null===r?(e.state="subscribed",t(void 0,n)):(t(!0),e.unsubscribing.callbackReceived=!0,E(e))}),(function(){e.state="subscribed",p.a.error("Error calling unsubscribe, streamId: "+e.getID())}))):(e.state="unsubscribed",t(void 0,"Error unsubscribing, stream does not exist or is not local")))},f.autoSubscribe=function(e,t,r,n){h&&h.sendMessage("autoSubscribe",{selectors:e,negativeSelectors:t,options:r},(function(e){e&&n(e)}))},f.getStreamStats=function(e,t){return t=void 0===t?function(){}:t,h?e?void h.sendMessage("getStreamStats",e.getID(),(function(e){e&&t(e)})):"Error getting stats - no stream":"Error getting stats - no socket"},f.getStreamsByAttribute=function(e,t){var r=[];return m.forEach((function(n){void 0!==n.getAttributes()&&n.getAttributes()[e]===t&&r.push(n)})),r},f.on("room-disconnected",(function(){f.state=0,h.state=h.DISCONNECTED,m.forEach((function(e,t){g(e),m.remove(t),e&&!e.failed&&(e=Object(a.f)({type:"stream-removed",stream:e}),f.dispatchEvent(e))})),m=Object(d.a)(),y.forEach((function(e,t){g(e),y.remove(t)})),y=Object(d.a)();try{h.disconnect()}catch(e){p.a.debug("Socket already disconnected")}h=void 0})),h.on("onAddStream",e.bind(null,(function(e){if(!m.has(e.id)){var t=Object(c.a)(f.Connection,{streamID:e.id,local:y.has(e.id),audio:e.audio,video:e.video,data:e.data,label:e.label,screen:e.screen,attributes:e.attributes});t.room=f,t.state="unsubscribed",m.add(e.id,t),e=Object(a.f)({type:"stream-added",stream:t}),f.dispatchEvent(e)}}))),h.on("stream_message_erizo",e.bind(null,(function(e){"auto-streams-subscription"===e.context?function(e){var t,r=e.streamIds,n=e.erizoId,i=e.connectionId,o=e.options;switch(e.type){case"multiple-initializing":r.forEach((function(e){t=m.get(e),R(t,i,n,o)}))}}(e.mess):"auto-streams-unsubscription"===e.context?function(e){var t;(e=e.streamIds).forEach((function(e){t=m.get(e)})),e.forEach((function(e){t=m.get(e),g(t),delete t.failed}))}(e.mess):p.a.debug("Failed applying a stream message from erizo",e)}))),h.on("stream_message_p2p",e.bind(null,(function(e){var t=y.get(e.streamId);t&&!t.failed?t.pc.get(e.peerSocket).processSignalingMessage(e.msg):((t=m.get(e.streamId)).pc||function(e,t){var r=f.erizoConnectionManager.getOrBuildErizoConnection(b(e,t));e.addPC(r),r.on("connection-failed",(function(){S()})),e.on("added",v.bind(null,e)),e.on("icestatechanged",(function(t){p.a.info(e.getID()+" - iceConnectionState: "+t.msg.state),"failed"===t.msg.state&&_(e,"ICE Connection Failed","ice-client")}))}(t,e.peerSocket),t.pc.processSignalingMessage(e.msg))}))),h.on("connection_message_erizo",e.bind(null,(function(e){if("quality_level"===e.evt.type)!function(e){var t=e.evt.level,r=Number.MAX_SAFE_INTEGER,n="";y.forEach((function(i){!i.failed&&i.pc&&(i.pc.connectionId===e.connectionId&&i.pc.setQualityLevel(t),(i=i.pc.getQualityLevel()).index<r&&(r=i.index,n=i.message))})),m.forEach((function(i){i.failed&&i.pc&&(i.pc.connectionId===e.connectionId&&i.pc.setQualityLevel(t),(i=i.pc.getQualityLevel()).index<r&&(r=i.index,n=i.message))})),n!==f.minConnectionQualityLevel&&(f.minConnectionQualityLevel=n,f.dispatchEvent(Object(a.e)({type:"quality-level",message:n})))}(e);else{var t=f.erizoConnectionManager.getErizoConnection(e.connectionId);t?t.processSignalingMessage(e.evt):p.a.warning("Received signaling message to unknown connectionId",e.connectionId)}}))),h.on("publish_me",e.bind(null,(function(e){!function(e,t){var r=f.erizoConnectionManager.getOrBuildErizoConnection(b(e,t));e.addPC(r,t),r.on("connection-failed",(function(){S()})),e.on("icestatechanged",(function(r){p.a.info(e.getID()+" - iceConnectionState: "+r.msg.state),"failed"===r.msg.state&&(e.pc.get(t).close(),e.pc.remove(t))})),r.addStream(e)}(y.get(e.streamId),e.peerSocket)}))),h.on("unpublish_me",e.bind(null,(function(e){var t=y.get(e.streamId);t&&(e=e.peerSocket,void 0!==t.pc&&t.pc.has(e)&&(t.pc.get(e).close(),t.pc.remove(e)))}))),h.on("onBandwidthAlert",e.bind(null,(function(e){if(p.a.info("Bandwidth Alert on",e.streamID,"message",e.message,"BW:",e.bandwidth),e.streamID){var t=m.get(e.streamID);t&&!t.failed&&(e=Object(a.f)({type:"bandwidth-alert",stream:t,msg:e.message,bandwidth:e.bandwidth}),t.dispatchEvent(e))}}))),h.on("onDataStream",e.bind(null,(function(e){var t=m.get(e.id);e=Object(a.f)({type:"stream-data",msg:e.msg,stream:t}),t.dispatchEvent(e)}))),h.on("onUpdateAttributeStream",e.bind(null,(function(e){var t=m.get(e.id),r=Object(a.f)({type:"stream-attributes-update",attrs:e.attrs,stream:t});t.updateLocalAttributes(e.attrs),t.dispatchEvent(r)}))),h.on("onRemoveStream",e.bind(null,(function(e){var t=y.get(e.id);t?_(t,"Stream removed from server","server"):(t=m.get(e.id))&&(g(t),m.remove(e.id),e=Object(a.f)({type:"stream-removed",stream:t}),f.dispatchEvent(e))}))),h.on("disconnect",e.bind(null,(function(){if(p.a.info("Socket disconnected, lost connection to ErizoController"),0!==f.state){p.a.error("Unexpected disconnection from ErizoController");var e=Object(a.e)({type:"room-disconnected",message:"unexpected-disconnection"});f.dispatchEvent(e)}}))),h.on("connection_failed",e.bind(null,(function(e){if(e.streamId){var t="ICE Connection Failed on "+e.type+" "+e.streamId+" "+f.state;p.a.error(t),e="publish"===e.type?y.get(e.streamId):m.get(e.streamId),_(e,t,"ice-server")}}))),h.on("error",e.bind(null,(function(e){p.a.error("Cannot connect to erizo Controller"),e=Object(a.e)({type:"room-error",message:e}),f.dispatchEvent(e)}))),f}},function(e,t,n){var i=n(27),o=n(39),a=n(40),s=n(0),c=n(1),d=n(7),u=n(8),p=c.c,l=103,f=["high-packet-losses","low-packet-losses","good"],h=function(e,t){var r=p.call(this)||this;if(s.a.debug("Building a new Connection"),r.stack={},r.erizoId=t,r.streamsMap=Object(d.a)(),l+=1,e.sessionId=l,r.sessionId=l,r.connectionId=e.connectionId,r.qualityLevel="good",e.onEnqueueingTimeout=function(){r.emit(Object(c.a)({type:"connection-failed",id:r.connectionId}))},e.streamRemovedListener||(e.streamRemovedListener=function(){}),r.streamRemovedListener=e.streamRemovedListener,r.browser=u.a.getBrowser(),"fake"===r.browser)s.a.warning("Publish/subscribe video/audio streams not supported in erizofc yet"),r.stack=Object(a.a)(e);else if("mozilla"===r.browser)s.a.debug("Firefox Stack"),r.stack=Object(o.a)(e);else if("safari"===r.browser)s.a.debug("Safari using Chrome Stable Stack"),r.stack=Object(i.a)(e);else{if("chrome-stable"!==r.browser&&"electron"!==r.browser)throw s.a.error("No stack available for this browser"),Error("WebRTC stack not available");s.a.debug("Chrome Stable Stack"),r.stack=Object(i.a)(e)}return r.stack.updateSpec||(r.stack.updateSpec=function(e,t){t=void 0===t?function(){}:t,s.a.error("Update Configuration not implemented in this browser"),t("unimplemented")}),r.stack.setSignallingCallback||(r.stack.setSignallingCallback=function(){s.a.error("setSignallingCallback is not implemented in this stack")}),r.stack.peerConnection&&(r.peerConnection=r.stack.peerConnection,r.stack.peerConnection.onaddstream=function(e){r.emit(Object(c.a)({type:"add-stream",stream:e.stream}))},r.stack.peerConnection.onremovestream=function(e){r.emit(Object(c.a)({type:"remove-stream",stream:e.stream})),r.streamRemovedListener(e.stream.id)},r.stack.peerConnection.oniceconnectionstatechange=function(){r.emit(Object(c.a)({type:"ice-state-change",state:r.stack.peerConnection.iceConnectionState}))}),r};r.inherits(h,p),h.prototype.close=function(){s.a.debug("Closing ErizoConnection"),this.streamsMap.clear(),this.stack.close()},h.prototype.createOffer=function(e,t){this.stack.createOffer(e,t)},h.prototype.sendOffer=function(){this.stack.sendOffer()},h.prototype.addStream=function(e){s.a.debug("message: Adding stream to Connection, streamId: "+e.getID()),this.streamsMap.add(e.getID(),e),e.local&&this.stack.addStream(e.stream)},h.prototype.removeStream=function(e){var t=e.getID();this.streamsMap.has(t)?(this.streamsMap.remove(t),e.local?this.stack.removeStream(e.stream):0===this.streamsMap.size()&&this.streamRemovedListener(e.getLabel())):s.a.debug("message: Cannot remove stream not in map, streamId: "+t)},h.prototype.processSignalingMessage=function(e){this.stack.processSignalingMessage(e)},h.prototype.sendSignalingMessage=function(e){this.stack.sendSignalingMessage(e)},h.prototype.setSimulcast=function(e){this.stack.setSimulcast(e)},h.prototype.setVideo=function(e){this.stack.setVideo(e)},h.prototype.setAudio=function(e){this.stack.setAudio(e)},h.prototype.updateSpec=function(e,t,r){this.stack.updateSpec(e,t,r)},h.prototype.updateSimulcastLayersBitrate=function(e){this.stack.updateSimulcastLayersBitrate(e)},h.prototype.setQualityLevel=function(e){this.qualityLevel=f[e]},h.prototype.getQualityLevel=function(){return{message:this.qualityLevel,index:f.indexOf(this.qualityLevel)}},(e=function(){this.ErizoConnectionsMap=new Map}).prototype.getErizoConnection=function(e){var t;return this.ErizoConnectionsMap.forEach((function(r){Object.keys(r).forEach((function(n){r[n].connectionId===e&&(t=r[n])}))})),t},e.prototype.getOrBuildErizoConnection=function(e,t,r){if(r=void 0!==r&&r,s.a.debug("message: getOrBuildErizoConnection, erizoId: "+t),void 0===t)return new h(e);if(r)this.ErizoConnectionsMap.has(t)?r=this.ErizoConnectionsMap.get(t):(r={},this.ErizoConnectionsMap.set(t,r)),r["single-pc"]||(r["single-pc"]=new h(e,t)),r=r["single-pc"];else if(r=new h(e,t),this.ErizoConnectionsMap.has(t))this.ErizoConnectionsMap.get(t)[r.sessionId]=r;else{var n={};n[r.sessionId]=r,this.ErizoConnectionsMap.set(t,n)}return e.simulcast&&r.setSimulcast(e.simulcast),e.video&&r.setVideo(e.video),e.audio&&r.setVideo(e.audio),r},e.prototype.maybeCloseConnection=function(e,t){t=void 0!==t&&t,s.a.debug("Trying to remove connection "+e.sessionId+"\n       with erizoId "+e.erizoId),(0===e.streamsMap.size()||t)&&(s.a.debug("No streams in connection "+e.sessionId+", erizoId: "+e.erizoId),void 0!==this.ErizoConnectionsMap.get(e.erizoId)&&this.ErizoConnectionsMap.get(e.erizoId)["single-pc"]&&!t?s.a.debug("Will not remove empty connection "+e.erizoId+" - it is singlePC"):(e.close(),void 0!==this.ErizoConnectionsMap.get(e.erizoId)&&(delete this.ErizoConnectionsMap.get(e.erizoId)["single-pc"],delete this.ErizoConnectionsMap.get(e.erizoId)[e.sessionId])))},t.a=e},function(e,t,r){var n=r(9),i=r(21),o=r(0);t.a=function(e){o.a.info("Starting Chrome stable stack",e);var t=Object(n.a)(e);t.mediaConstraints={offerToReceiveVideo:!0,offerToReceiveAudio:!0},t.enableSimulcast=function(e){var r=e;if(!t.simulcast||null!==r.match(/a=ssrc-group:SIM/g))return r;if(!(e=r.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/))||0>=e.length)return r;var n=t.simulcast.numSpatialLayers||2,o=parseInt(e[1],10),a=parseInt(e[2],10),s=r.match(new RegExp("a=ssrc:"+e[1]+" cname:(.*)\r?\n"))[1],c=r.match(new RegExp("a=ssrc:"+e[1]+" msid:(.*)\r?\n"))[1],d=r.match(new RegExp("a=ssrc:"+e[1]+" mslabel:(.*)\r?\n"))[1],u=r.match(new RegExp("a=ssrc:"+e[1]+" label:(.*)\r?\n"))[1];r.match(new RegExp("a=ssrc:"+e[1]+".*\r?\n","g")).forEach((function(e){r=r.replace(e,"")})),r.match(new RegExp("a=ssrc:"+e[2]+".*\r?\n","g")).forEach((function(e){r=r.replace(e,"")}));for(var p=[o],l=[a],f=1;f<n;f+=1)p.push(o+1e3*f),l.push(a+1e3*f);for(n=i.a.addSim(p),f=0;f<p.length;f+=1)o=p[f],a=l[f],n+=i.a.addGroup(o,a);for(f=0;f<p.length;f+=1)o=p[f],a=l[f],n+=i.a.addSpatialLayer(s,c,d,u,o,a);return r.replace(e[0],n+"a=x-google-flag:conference\r\n")};var r=function(e){if("function"!=typeof e.getParameters||"function"!=typeof e.setParameters)o.a.warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var r=e.getParameters();Object.keys(t.simulcast.spatialLayerBitrates).forEach((function(e){void 0!==r.encodings[e]&&(o.a.debug("Setting bitrate for layer "+e+", bps: "+t.simulcast.spatialLayerBitrates[e]),r.encodings[e].maxBitrate=t.simulcast.spatialLayerBitrates[e])})),e.setParameters(r).then((function(e){o.a.debug("Success setting simulcast layer bitrates",e)})).catch((function(e){o.a.warning("Error setting simulcast layer bitrates",e)}))}};return t.setSimulcastLayersBitrate=function(){o.a.debug("Maybe set simulcast Layers bitrate",t.simulcast),t.simulcast&&t.simulcast.spatialLayerBitrates&&t.peerConnection.getSenders().forEach((function(e){"video"===e.track.kind&&r(e)}))},t.setStartVideoBW=function(r){t.video&&e.startVideoBW&&(o.a.debug("startVideoBW requested: "+e.startVideoBW),i.a.setParamForCodecs(r,"video","x-google-start-bitrate",e.startVideoBW))},t.setHardMinVideoBW=function(r){t.video&&e.hardMinVideoBW&&(o.a.debug("hardMinVideoBW requested: "+e.hardMinVideoBW),i.a.setParamForCodecs(r,"video","x-google-min-bitrate",e.hardMinVideoBW))},t}},function(e,t,r){t=r(29);var n=r(11),i=r(12),o=r(13),a=r(14),s=r(15),c=r(2),d=r(17),u=r(18),p=r(19),l=r(20);r=r(4),e.exports={SDPInfo:t,CandidateInfo:n,CodecInfo:i,DTLSInfo:o,ICEInfo:a,MediaInfo:s,Setup:c,SourceGroupInfo:d,SourceInfo:u,StreamInfo:p,TrackInfo:l,Direction:r}},function(e,t,n){function i(e,t){var r=new Map;t.rtp.forEach((function(n){var i=n.payload,o=n.codec,a=n.rate;n=n.encoding;var s={},c=[];t.fmtp.forEach((function(e){e.payload===i&&e.config.split(";").forEach((function(e){e=e.split("="),s[e[0].trim()]=(e[1]||"").trim()}))})),t.rtcpFb&&t.rtcpFb.forEach((function(e){e.payload===i&&c.push({type:e.type,subtype:e.subtype})})),"RTX"===o.toUpperCase()?r.set(parseInt(s.apt,10),i):e.addCodec(new p(o,i,a,n,s,c))})),r.forEach((function(t,r){(r=e.getCodecForType(r))&&r.setRTX(t)}))}function o(e,t){(t=t.rids)&&t.forEach((function(t){var r=new R(t.id,g.byValue(t.direction)),n=[],i=new Map;if(t.params){var o=d.parseParams(t.params);Object.keys(o).forEach((function(e){"pt"===e?n=o[e].split(","):i.set(e,o[e])})),r.setFormats(n),r.setParams(i)}e.addRID(r)}))}function a(e,t,r){var n=t.simulcast["dir"+e];if(e=t.simulcast["list"+e],n){var i=g.byValue(n);d.parseSimulcastStreamList(e).forEach((function(e){var t=[];e.forEach((function(e){t.push(new C(e.scid,e.paused))})),r.addSimulcastAlternativeStreams(i,t)}))}}function s(e,t){var r=[];if(t.simulcast){var n=new T;a("1",t,n),a("2",t,n),n.getSimulcastStreams(g.SEND).forEach((function(t){var n=[];t.forEach((function(t){var r=new b(t.getId(),t.isPaused());(t=e.getRID(r.getId()))&&(t.getFormats().forEach((function(t){(t=e.getCodecForType(t))&&r.addCodec(t)})),r.setParams(t.getParams()),n.push(r))})),n.length&&r.push(n)})),e.setSimulcast(n)}return t.simulcast_03&&((n=new T).setSimulcastPlainString(t.simulcast_03.value),e.setSimulcast03(n)),r}function c(e,t,r){var n,i,o,a=new Map,s=r.type;r.ssrcs&&r.ssrcs.forEach((function(r){var c=r.id,d=r.attribute;r=r.value,(o=a.get(c))||(o=new E(c),a.set(o.getSSRC(),o)),"cname"===d.toLowerCase()?o.setCName(r):"mslabel"===d.toLowerCase()?o.setMSLabel(r):"label"===d.toLowerCase()?o.setLabel(r):"msid"===d.toLowerCase()&&(c=(d=r.split(" "))[0],d=d[1],o.setStreamId(c),o.setTrackId(d),(i=t.getStream(c))||(i=new S(c),t.addStream(i)),(n=i.getTrack(d))||((n=new _(s,d)).setEncodings(e),i.addTrack(n)),n.addSSRC(o))}));if(r.msid){var c,d=(c=r.msid.split(" "))[0],u=c[1];(c=t.getStream(d))||(c=new S(d),t.addStream(c));var p=c.getTrack(u);p||((p=new _(s,u)).setMediaId(r.mid),p.setEncodings(e),c.addTrack(p)),a.forEach((function(e,t){(e=a.get(t)).getStreamId()||(e.setStreamId(d),e.setTrackId(u),p.addSSRC(e))}))}r.ssrcGroups&&r.ssrcGroups.forEach((function(e){var r=e.ssrcs.split(" ");e=new v(e.semantics,r),r=a.get(parseInt(r[0],10)),t.getStream(r.getStreamId()).getTrack(r.getTrackId()).addSourceGroup(e)}))}var d=n(30),u=n(11),p=n(12),l=n(13),f=n(14),h=n(15),m=n(2),y=n(4),g=n(3),v=n(17),E=n(18),S=n(19),_=n(20),b=n(33),T=n(16),C=n(34),R=n(35),A=function(e){this.version=e||1,this.name="sdp-semantic",this.streams=new Map,this.medias=[],this.candidates=[],this.dtls=this.ice=this.connection=null};A.prototype.clone=function(){var e=new A(this.version);return e.name=this.name,e.setConnection(this.connection),this.medias.forEach((function(t){e.addMedia(t.clone())})),this.streams.forEach((function(t){e.addStream(t.clone())})),this.candidates.forEach((function(t){e.addCandidate(t.clone())})),e.setICE(this.ice.clone()),e.setDTLS(this.dtls.clone()),e},A.prototype.plain=function(){var e={version:this.version,name:this.name,streams:[],medias:[],candidates:[],connection:this.connection};return this.medias.forEach((function(t){e.medias.push(t.plain())})),this.streams.forEach((function(t){e.streams.push(t.plain())})),this.candidates.forEach((function(t){e.candidates.push(t.plain())})),e.ice=this.ice&&this.ice.plain(),e.dtls=this.dtls&&this.dtls.plain(),e},A.prototype.setVersion=function(e){this.version=e},A.prototype.setOrigin=function(e){this.origin=e},A.prototype.setName=function(e){this.name=e},A.prototype.getConnection=function(){return this.connection},A.prototype.setConnection=function(e){this.connection=e},A.prototype.setTiming=function(e){this.timing=e},A.prototype.addMedia=function(e){this.medias.push(e)},A.prototype.getMedia=function(e){var t;return this.medias.forEach((function(r){r.getType().toLowerCase()===e.toLowerCase()&&(t=r)})),t},A.prototype.getMedias=function(e){if(!e)return this.medias;var t=[];return this.medias.forEach((function(r){r.getType().toLowerCase()===e.toLowerCase()&&t.push(r)})),t},A.prototype.getMediaById=function(e){var t;return this.medias.forEach((function(r){r.getId().toLowerCase()===e.toLowerCase()&&(t=r)})),t},A.prototype.getVersion=function(){return this.version},A.prototype.getDTLS=function(){return this.dtls},A.prototype.setDTLS=function(e){this.dtls=e},A.prototype.getICE=function(){return this.ice},A.prototype.setICE=function(e){this.ice=e},A.prototype.addCandidate=function(e){this.candidates.push(e)},A.prototype.addCandidates=function(e){var t=this;e.forEach((function(e){t.addCandidate(e)}))},A.prototype.getCandidates=function(){return this.candidates},A.prototype.getStream=function(e){return this.streams.get(e)},A.prototype.getStreams=function(){return this.streams},A.prototype.getFirstStream=function(){return 0<this.streams.values().length?this.streams.values()[0]:null},A.prototype.addStream=function(e){this.streams.set(e.getId(),e)},A.prototype.removeStream=function(e){this.streams.delete(e.getId())},A.prototype.toJSON=function(){var e={version:0,media:[]};e.version=this.version||0,e.origin=this.origin||{username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"},e.name=this.name||"semantic-sdp",e.connection=this.getConnection(),e.timing=this.timing||{start:0,stop:0};var t=this.getICE();t&&(t.isLite()&&(e.icelite="ice-lite"),e.iceOptions=t.getOpts(),e.iceUfrag=t.getUfrag(),e.icePwd=t.getPwd()),e.msidSemantic=this.msidSemantic||{semantic:"WMS",token:"*"},e.groups=[];var n={type:"BUNDLE",mids:[]},i=this.getDTLS();i&&(e.fingerprint={type:i.getHash(),hash:i.getFingerprint()},e.setup=m.toString(i.getSetup())),this.medias.forEach((function(r){var o={type:r.getType(),port:r.getPort(),protocol:"UDP/TLS/RTP/SAVPF",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};o.direction=y.toString(r.getDirection()),o.rtcpMux="rtcp-mux",o.connection=r.getConnection(),o.xGoogleFlag=r.getXGoogleFlag(),o.mid=r.getId(),n.mids.push(r.getId()),o.rtcp=r.rtcp,0<r.getBitrate()&&o.bandwidth.push({type:"AS",limit:r.getBitrate()}),r.getCandidates().forEach((function(e){o.candidates.push({foundation:e.getFoundation(),component:e.getComponentId(),transport:e.getTransport(),priority:e.getPriority(),ip:e.getAddress(),port:e.getPort(),type:e.getType(),relAddr:e.getRelAddr(),relPort:e.getRelPort(),generation:e.getGeneration()})})),(t=r.getICE())&&(t.isLite()&&(o.icelite="ice-lite"),o.iceOptions=t.getOpts(),o.iceUfrag=t.getUfrag(),o.icePwd=t.getPwd(),t.isEndOfCandidates()&&(o.endOfCandidates=t.isEndOfCandidates())),(i=r.getDTLS())&&(o.fingerprint={type:i.getHash(),hash:i.getFingerprint()},o.setup=m.toString(i.getSetup())),r.setup&&(o.setup=m.toString(r.setup)),r.getCodecs().forEach((function(e){o.rtp.push({payload:e.getType(),codec:e.getCodec(),rate:e.getRate(),encoding:e.getEncoding()});var t=e.getParams();0<Object.keys(t).length&&o.fmtp.push({payload:e.getType(),config:Object.keys(t).map((function(e){return e+(t[e]?"="+t[e]:"")})).join(";")}),e.getFeedback().forEach((function(t){o.rtcpFb.push({payload:e.getType(),type:t.type,subtype:t.subtype})})),e.hasRTX()&&(o.rtp.push({payload:e.getRTX(),codec:"rtx",rate:e.getRate(),encoding:e.getEncoding()}),o.fmtp.push({payload:e.getRTX(),config:"apt="+e.getType()}))}));var a=[];o.rtp.forEach((function(e){a.push(e.payload)})),o.payloads=a.join(" "),r.getExtensions().forEach((function(e,t){o.ext.push({value:t,uri:e})})),r.getRIDs().forEach((function(e){var t={id:e.getId(),direction:g.toString(e.getDirection()),params:""};e.getFormats().length&&(t.params="pt="+e.getFormats().join(",")),e.getParams().forEach((function(e,r){t.params+=(t.params.length?";":"")+r+"="+e})),o.rids.push(t)}));var s=r.getSimulcast();if(r=r.getSimulcast03(),s){var c=1;o.simulcast={};var d=s.getSimulcastStreams(g.SEND);s=s.getSimulcastStreams(g.RECV);if(d&&d.length){var u="";d.forEach((function(e){var t="";e.forEach((function(e){t+=(t.length?",":"")+(e.isPaused()?"~":"")+e.getId()})),u+=(u.length?";":"")+t})),o.simulcast["dir"+c]="send",o.simulcast["list"+c]=u,c+=1}if(s&&s.length){var p=[];s.forEach((function(e){var t="";e.forEach((function(e){t+=(t.length?",":"")+(e.isPaused()?"~":"")+e.getId()})),p+=(p.length?";":"")+t})),o.simulcast["dir"+c]="recv",o.simulcast["list"+c]=p,c+=1}}r&&(o.simulcast_03={value:r.getSimulcastPlainString()}),e.media.push(o)})),n.mids.sort(),e.media.sort((function(e,t){return e.mid<t.mid?-1:e.mid>t.mid?1:0}));for(var o=r.makeIterator(this.streams.values()),a=o.next();!a.done;a=o.next()){a=a.value;for(var s=r.makeIterator(a.getTracks().values()),c=s.next();!c.done;c=s.next()){c=c.value;for(var d={},u=r.makeIterator(e.media),p=u.next();!p.done;d={md:d.md},p=u.next())if(d.md=p.value,c.getMediaId()){if(c.getMediaId()===d.md.mid){c.getSourceGroups().forEach(function(e){return function(t){e.md.ssrcGroups.push({semantics:t.getSemantics(),ssrcs:t.getSSRCs().join(" ")})}}(d)),c.getSSRCs().forEach(function(e){return function(t){e.md.ssrcs.push({id:t.ssrc,attribute:"cname",value:t.getCName()})}}(d)),a.getId()&&c.getId()&&(d.md.msid=a.getId()+" "+c.getId());break}}else if(d.md.type.toLowerCase()===c.getMedia().toLowerCase()){c.getSourceGroups().forEach(function(e){return function(t){e.md.ssrcGroups.push({semantics:t.getSemantics(),ssrcs:t.getSSRCs().join(" ")})}}(d)),c.getSSRCs().forEach(function(e){return function(t){e.md.ssrcs.push({id:t.ssrc,attribute:"cname",value:t.getCName()}),t.getStreamId()&&t.getTrackId()&&e.md.ssrcs.push({id:t.ssrc,attribute:"msid",value:t.getStreamId()+" "+t.getTrackId()}),t.getMSLabel()&&e.md.ssrcs.push({id:t.ssrc,attribute:"mslabel",value:t.getMSLabel()}),t.getLabel()&&e.md.ssrcs.push({id:t.ssrc,attribute:"label",value:t.getLabel()})}}(d));break}}}return n.mids=n.mids.join(" "),e.groups.push(n),e},A.prototype.toString=function(){var e=this.toJSON();return d.write(e)},A.processString=function(e){return e=d.parse(e),A.process(e)},A.process=function(e){var t=new A;t.setVersion(e.version),t.setTiming(e.timing),t.setConnection(e.connection),t.setOrigin(e.origin),t.msidSemantic=e.msidSemantic,t.name=e.name;var r=e.iceUfrag,n=e.icePwd,a=e.iceOptions;(r||n||a)&&t.setICE(new f(r,n,a));var d=e.fingerprint;if(d){var p=d.type,g=d.hash,v=null;e.setup&&(v=m.byValue(e.setup)),t.setDTLS(new l(v,p,g))}return e.media.forEach((function(e){var p=new h(e.mid,e.port,e.type);if(p.setXGoogleFlag(e.xGoogleFlag),p.rtcp=e.rtcp,p.setConnection(e.connection),e.bandwidth&&0<e.bandwidth.length&&e.bandwidth.forEach((function(e){"AS"===e.type&&p.setBitrate(e.limit)})),r=e.iceUfrag,n=e.icePwd,a=e.iceOptions,r||n||a){var g=new f(r,n,a);e.endOfCandidates&&g.setEndOfCandidates("end-of-candidates"),p.setICE(g)}if(d=e.fingerprint){g=d.type;var v=d.hash,E=m.ACTPASS;e.setup&&(E=m.byValue(e.setup)),p.setDTLS(new l(E,g,v))}e.setup&&p.setSetup(m.byValue(e.setup)),g=y.SENDRECV,e.direction&&(g=y.byValue(e.direction.toUpperCase())),p.setDirection(g),(g=e.candidates)&&g.forEach((function(e){p.addCandidate(new u(e.foundation,e.component,e.transport,e.priority,e.ip,e.port,e.type,e.generation,e.relAddr,e.relPort))})),i(p,e),(g=e.ext)&&g.forEach((function(e){p.addExtension(e.value,e.uri)})),o(p,e),c(g=s(p,e),t,e),t.addMedia(p)})),t},e.exports=A},function(e,t,r){e=r(31),r=r(32),t.write=r,t.parse=e.parse,t.parseFmtpConfig=e.parseFmtpConfig,t.parseParams=e.parseParams,t.parsePayloads=e.parsePayloads,t.parseRemoteCandidates=e.parseRemoteCandidates,t.parseImageAttributes=e.parseImageAttributes,t.parseSimulcastStreamList=e.parseSimulcastStreamList},function(e,t,r){var n=function(e){return String(Number(e))===e?Number(e):e},i=r(10),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);for("m"===t&&(r.push({rtp:[],fmtp:[]}),a=r[r.length-1]),e=0;e<(i[t]||[]).length;e+=1){if((s=i[t][e]).reg.test(o)){t=s,e=a,s=o,o=t.name&&t.names,t.push&&!e[t.push]?e[t.push]=[]:o&&!e[t.name]&&(e[t.name]={});o=t.push?{}:o?e[t.name]:e;var s=s.match(t.reg),c=o,d=t.names,u=t.name;if(u&&!d)c[u]=n(s[1]);else for(u=0;u<d.length;u+=1)null!=s[u+1]&&(c[d[u]]=n(s[u+1]));t.push&&e[t.push].push(o);break}}})),t.media=r,t};var a=function(e,t){return 2===(t=t.split(/=(.+)/,2)).length&&(e[t[0]]=n(t[1])),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){var t=[];e=e.split(" ").map(n);for(var r=0;r<e.length;r+=3)t.push({component:e[r],ip:e[r+1],port:e[r+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t=!1;return"~"!==e[0]?e=n(e):(e=n(e.substring(1,e.length)),t=!0),{scid:e,paused:t}}))}))}},function(e,t,r){var n=r(10),i=/%[sdv%]/g,o=function(e){var t=1,r=arguments,n=r.length;return e.replace(i,(function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},a=function(e,t,r){var n=t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format;if(e=[e+"="+n],t.names)for(n=0;n<t.names.length;n+=1){var i=t.names[n];t.name?e.push(r[t.name][i]):e.push(r[t.names[n]])}else e.push(r[t.name]);return o.apply(null,e)},s="vosiuepcbtrza".split(""),c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.innerOrder||c,i=[];return(t.outerOrder||s).forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(a(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(a(t,r,e))}))}))})),e.media.forEach((function(e){i.push(a("m",n.m[0],e)),r.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(a(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(a(t,r,e))}))}))}))})),i.join("\r\n")+"\r\n"}},function(e,t){var r=function(e,t){this.id=e,this.paused=t,this.codecs=new Map,this.params=new Map};r.prototype.clone=function(){var e=new r(this.id,this.paused);return this.codecs.forEach((function(t){e.addCodec(t.cloned())})),e.setParams(this.params),e},r.prototype.plain=function(){var e=this,t={id:this.id,paused:this.paused,codecs:{},params:{}};return this.codecs.keys().forEach((function(r){t.codecs[r]=e.codecs.get(r).plain()})),this.params.keys().forEach((function(r){t.params[r]=e.params.get(r).param})),t},r.prototype.getId=function(){return this.id},r.prototype.getCodecs=function(){return this.codecs},r.prototype.addCodec=function(e){this.codecs.set(e.getType(),e)},r.prototype.getParams=function(){return this.params},r.prototype.setParams=function(e){this.params=new Map(e)},r.prototype.isPaused=function(){return this.paused},e.exports=r},function(e,t){var r=function(e,t){this.paused=t,this.id=e};r.prototype.clone=function(){return new r(this.id,this.paused)},r.prototype.plain=function(){return{id:this.id,paused:this.paused}},r.prototype.isPaused=function(){return this.paused},r.prototype.getId=function(){return this.id},e.exports=r},function(e,t,r){var n=r(3),i=function(e,t){this.id=e,this.direction=t,this.formats=[],this.params=new Map};i.prototype.clone=function(){var e=new i(this.id,this.direction);return e.setFormats(this.formats),e.setParams(this.params),e},i.prototype.plain=function(){var e={id:this.id,direction:n.toString(this.direction),formats:this.formats,params:{}};return this.params.forEach((function(t,r){e.params[r]=t})),e},i.prototype.getId=function(){return this.id},i.prototype.getDirection=function(){return this.direction},i.prototype.setDirection=function(e){this.direction=e},i.prototype.getFormats=function(){return this.formats},i.prototype.setFormats=function(e){var t=this;this.formats=[],e.forEach((function(e){t.formats.push(parseInt(e,10))}))},i.prototype.getParams=function(){return this.params},i.prototype.setParams=function(e){this.params=new Map(e)},e.exports=i},function(e,t,r){e=r(37),e=r.n(e);var n=r(0);r=["initial","failed","stable"],r=e.a.factory({init:"initial",transitions:[{name:"create-offer",from:r,to:"stable"},{name:"add-ice-candidate",from:r,to:function(){return this.state}},{name:"process-answer",from:r,to:"stable"},{name:"process-offer",from:r,to:"stable"},{name:"negotiate-max-bw",from:r,to:"stable"},{name:"add-stream",from:r,to:function(){return this.state}},{name:"remove-stream",from:r,to:function(){return this.state}},{name:"close",from:r,to:"closed"},{name:"error",from:"*",to:"failed"}],data:function(e){return{baseStackCalls:e,history:[]}},methods:{getHistory:function(){return this.history},onBeforeClose:function(e){return n.a.info("FSM onBeforeClose from: "+e.from+", to: "+e.to),this.baseStackCalls.protectedClose()},onBeforeAddIceCandidate:function(e,t){return n.a.info("FSM onBeforeAddIceCandidate, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedAddIceCandidate(t)},onBeforeAddStream:function(e,t){return n.a.info("FSM onBeforeAddStream, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedAddStream(t)},onBeforeRemoveStream:function(e,t){return n.a.info("FSM onBeforeRemoveStream, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedRemoveStream(t)},onBeforeCreateOffer:function(e,t){return n.a.info("FSM onBeforeCreateOffer, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedCreateOffer(t)},onBeforeProcessOffer:function(e,t){return n.a.info("FSM onBeforeProcessOffer, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedProcessOffer(t)},onBeforeProcessAnswer:function(e,t){return n.a.info("FSM onBeforeProcessAnswer from: "+e.from+", to: "+e.to),this.baseStackCalls.protectedProcessAnswer(t)},onBeforeNegotiateMaxBW:function(e,t,r){return n.a.info("FSM onBeforeNegotiateMaxBW from: "+e.from+", to: "+e.to),this.baseStackCalls.protectedNegotiateMaxBW(t,r)},onStable:function(e){n.a.info("FSM reached STABLE, from "+e.from+", to: "+e.to)},onClosed:function(e){n.a.info("FSM reached close, from "+e.from+", to: "+e.to)},onTransition:function(e){n.a.debug("FSM onTransition, transition: "+e.transition+", from "+e.from+", to: "+e.to),this.history.push({from:e.from,to:e.to,transition:e.transition}),200<this.history.length&&this.history.shift()},onError:function(e,t){n.a.warning("FSM Error Transition Failed, message: "+t+", from: "+e.from+", to: "+e.to+", printing history:"),this.history.forEach((function(e){n.a.warning(e)}))},onInvalidTransition:function(e,t,r){"closed"===t?n.a.info("Trying to transition a closed FSM, transition: "+e+", from: "+t+", to: "+r):n.a.warning("FSM Error Invalid transition: "+e+", from: "+t+", to: "+r)},onPendingTransition:function(e,t,r){n.a.warning("FSM Error Pending transition: "+e+", from: "+t+", to: "+r)}}}),t.a=r},function(e,t,r){e.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,r){e.exports=function(e,t){var r,n;for(r=1;r<arguments.length;r++){var i=arguments[r];for(n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e}},function(e,t,r){var n=r(0);e.exports={build:function(e,t){var r,i=t.plugins;for(t=0,r=i.length;t<r;t++){var o=i[t];o.methods&&n(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)}},hook:function(e,t,r){var n,i,o=e.config.plugins;for(e=[e.context],r&&(e=e.concat(r)),r=0,n=o.length;r<n;r++){var a=o[r];(i=o[r][t])&&i.apply(a,e)}}}},function(e,t,r){function n(e){if(0===e.length)return e;var t=e.split(/[_-]/);if(1===t.length&&t[0][0].toLowerCase()===t[0][0])return e;var r=t[0].toLowerCase();for(e=1;e<t.length;e++)r=r+t[e].charAt(0).toUpperCase()+t[e].substring(1).toLowerCase();return r}n.prepended=function(e,t){return e+(t=n(t))[0].toUpperCase()+t.substring(1)},e.exports=n},function(e,t,r){function n(e,t){this.options=e=e||{},this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}var i=r(0),o=r(2);i(n.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=o.prepended("onEnter",e),this.lifecycle.onLeave[e]=o.prepended("onLeave",e),this.lifecycle.on[e]=o.prepended("on",e)},addTransition:function(e){0>this.transitions.indexOf(e)&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=o.prepended("onBefore",e),this.lifecycle.onAfter[e]=o.prepended("onAfter",e),this.lifecycle.on[e]=o.prepended("on",e)},mapTransition:function(e){var t=e.name,r=e.from,n=e.to;return this.addState(r),"function"!=typeof n&&this.addState(n),this.addTransition(t),this.map[r][t]=e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(i({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(i({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var r;for(t=0,r=(e=e||[]).length;t<r;t++){var n=e[t];"function"==typeof n&&(e[t]=n=n()),n.configure&&n.configure(this)}return e},configureTransitions:function(e){var t,r,n=this.defaults.wildcard;for(r=0;r<e.length;r++){var i=e[r],o=Array.isArray(i.from)?i.from:[i.from||n],a=i.to||n;for(t=0;t<o.length;t++)this.mapTransition({name:i.name,from:o[t],to:a})}},transitionFor:function(e,t){var r=this.defaults.wildcard;return this.map[e][t]||this.map[r][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=n},function(e,t,r){function n(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}var i=r(0),o=r(6),a=r(1),s=[null,[]];i(n.prototype,{init:function(e){if(i(this.context,this.config.data.apply(this.context,e)),a.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?0<=e.indexOf(this.state):this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var r=this.config.defaults.wildcard;return"function"==typeof(e=(e=this.config.transitionFor(this.state,e))&&e.to)?e.apply(this.context,t):e===r?this.state:e},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,r,n){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==r;return r?this.isPending()?this.context.onPendingTransition(e,t,r):(this.config.addState(r),this.beginTransit(),n.unshift({transition:e,from:t,to:r,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):s,o?this.observersForEvent(i.onLeave[t]):s,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:s,o?this.observersForEvent(i.onEnter.state):s,o?this.observersForEvent(i.onEnter[r]):s,o?this.observersForEvent(i.on[r]):s,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],n)):this.context.onInvalidTransition(e,t,r)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,r=0,n=this.observers.length,i=[];r<n;r++)(t=this.observers[r])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,r,n){if(0===e.length)return this.endTransit(void 0===n||n);var i=e[0][0],o=e[0][1],s=e[0][2];return(t[0].event=i)&&s&&i!==r&&a.hook(this,"lifecycle",t),0===o.length?(e.shift(),this.observeEvents(e,t,i,n)):(r=(r=o.shift())[i].apply(r,t))&&"function"==typeof r.then?r.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===r?this.endTransit(!1):this.observeEvents(e,t,i,r)},onInvalidTransition:function(e,t,r){throw new o("transition is invalid in current state",e,t,r,this.state)},onPendingTransition:function(e,t,r){throw new o("transition is invalid while previous transition is still in progress",e,t,r,this.state)}}),e.exports=n},function(e,t,r){function n(e){return i(this||{},e)}function i(e,t){return o(e,t=new d(t,n)),e._fsm(),e}function o(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");c.build(e,t),Object.defineProperties(e,l),a(e,p),a(e,t.methods),t.allTransitions().forEach((function(t){e[s(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}})),e._fsm=function(){this._fsm=new u(this,t),this._fsm.init(arguments)}}var a=r(0),s=r(2),c=r(1),d=r(3),u=r(4),p={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,r){return this._fsm.onInvalidTransition(e,t,r)},onPendingTransition:function(e,t,r){return this._fsm.onPendingTransition(e,t,r)}},l={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};n.version="3.0.1",n.factory=function(e,t){if("function"==typeof e){var r=e;e=t||{}}else r=function(){this._fsm.apply(this,arguments)},e=e||{};return e=new d(e,n),o(r.prototype,e),r.prototype._fsm.config=e,r},n.apply=i,n.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=n},function(e,t,r){e.exports=function(e,t,r,n,i){this.message=e,this.transition=t,this.from=r,this.to=n,this.current=i}}])},function(e,t,n){(e=function(e,t){this._enqueuing=!1,this._queuedArgs=[],this.maxEnqueueingTime=void 0===e?3e4:e,this.onEnqueueingTimeout=void 0===t?function(){}:t}).prototype.protectFunction=function(e){return this._protectedFunction.bind(this,e)},e.prototype.isEnqueueing=function(){return this._enqueuing},e.prototype.startEnqueuing=function(){var e=this;this._enqueuing=!0,clearTimeout(this._enqueueingTimeout),this._enqueueingTimeout=setTimeout((function(){e.onEnqueueingTimeout&&e.onEnqueueingTimeout()}),this.maxEnqueueingTime)},e.prototype.stopEnqueuing=function(){this._enqueuing=!1,clearTimeout(this._enqueueingTimeout)},e.prototype.nextInQueue=function(){if(0<this._queuedArgs.length){var e=this._queuedArgs.shift();e.protectedFunction.apply(null,[].concat(r.arrayFromIterable(e.args)))}},e.prototype.dequeueAll=function(){var e=this._queuedArgs;this._queuedArgs=[],e.forEach((function(e){e.protectedFunction.apply(null,[].concat(r.arrayFromIterable(e.args)))}))},e.prototype._protectedFunction=function(e,t){for(var n=[],i=1;i<arguments.length;++i)n[i-1]=arguments[i];this.isEnqueueing()?this._enqueue.apply(this,[].concat([e],r.arrayFromIterable(n))):e.apply(null,[].concat(r.arrayFromIterable(n)))},e.prototype._enqueue=function(e,t){for(var r=[],n=1;n<arguments.length;++n)r[n-1]=arguments[n];this._queuedArgs.push({protectedFunction:e,args:r})},t.a=e},function(e,t,r){var n=r(0),i=r(9);t.a=function(e){n.a.info("Starting Firefox stack");var t=Object(i.a)(e),r=[{rid:"low",scaleResolutionDownBy:3},{rid:"med",scaleResolutionDownBy:2},{rid:"high"}],o=function(e){var n=t.simulcast.numSpatialLayers||2,i=r.length,o=(n=n<i?n:i,e.getParameters()||{});o.encodings=[];for(var a=i-1;a>=i-n;--a)o.encodings.push(r[a]);return e.setParameters(o)},a=function(){if(!t.simulcast)return[];var e=[];return t.peerConnection.getSenders().forEach((function(t){"video"===t.track.kind&&e.push(o(t))})),e};t.enableSimulcast=function(e){return e};var s=t.createOffer;return t.createOffer=function(e,t,r){t=void 0!==t&&t,r=void 0===r?"":r;var n=[];!0!==e&&(n=a()),Promise.all(n).then((function(){s(e,t,r)}))},t}},function(e,t,r){var n=r(0);t.a=function(e){var t={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){n.a.info("Close FcStack")},createOffer:function(){n.a.debug("FCSTACK: CreateOffer")},addStream:function(e){n.a.debug("FCSTACK: addStream",e)},processSignalingMessage:function(e){n.a.debug("FCSTACK: processSignaling",e),void 0!==t.signalCallback&&t.signalCallback(e)},sendSignalingMessage:function(t){n.a.debug("FCSTACK: Sending signaling Message",t),e.callback(t)},setSignalingCallback:function(e){e=void 0===e?function(){}:e,n.a.debug("FCSTACK: Setting signalling callback"),t.signalCallback=e}};return t}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){n.d(t,"a",(function(){return c})),e=n(43);var i=n.n(e),o=n(0),a=n(1),s=function(e,t){return(e=Object(a.d)({type:e})).args=t.args,e},c=function(e){var t=Object(a.b)(),n=function(){},c=[];r.initSymbol(),t.CONNECTED=Symbol("connected"),r.initSymbol(),t.RECONNECTING=Symbol("reconnecting"),r.initSymbol(),t.DISCONNECTED=Symbol("disconnected"),t.state=t.DISCONNECTED,t.IO=void 0===e?i.a:e;var d,u=function(e,r){for(var n=[],i=1;i<arguments.length;++i)n[i-1]=arguments[i];t.emit(s(e,{args:n}))},p=function(){t.state===t.CONNECTED&&c.forEach((function(e){t.sendMessage.apply(t,[].concat(r.arrayFromIterable(e)))}))};return t.connect=function(e,r,i,a){i=void 0===i?n:i,a=void 0===a?n:a,d=t.IO.connect((e.secure?"wss://":"ws://")+e.host,{reconnection:!0,reconnectionAttempts:3,secure:e.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1});var s=1e3,c=d.io.engine.transport.ws.onclose;d.io.engine.transport.ws.onclose=function(e){o.a.warning("WebSocket closed, code:",e.code),s=e.code,c(e)},t.socket=d,d.on("onAddStream",u.bind(t,"onAddStream")),d.on("stream_message_erizo",u.bind(t,"stream_message_erizo")),d.on("stream_message_p2p",u.bind(t,"stream_message_p2p")),d.on("connection_message_erizo",u.bind(t,"connection_message_erizo")),d.on("publish_me",u.bind(t,"publish_me")),d.on("unpublish_me",u.bind(t,"unpublish_me")),d.on("onBandwidthAlert",u.bind(t,"onBandwidthAlert")),d.on("onDataStream",u.bind(t,"onDataStream")),d.on("onUpdateAttributeStream",u.bind(t,"onUpdateAttributeStream")),d.on("onRemoveStream",u.bind(t,"onRemoveStream")),d.on("onAutomaticStreamsSubscription",u.bind(t,"onAutomaticStreamsSubscription")),d.on("disconnect",(function(e){o.a.debug("disconnect",t.id,e),1e3!==s?t.state=t.RECONNECTING:(u("disconnect",e),d.close())})),d.on("connection_failed",(function(e){o.a.error("connection failed, id:",t.id),u("connection_failed",e)})),d.on("error",(function(e){o.a.warning("socket error, id:",t.id,", error:",e.message),u("error")})),d.on("connect_error",(function(e){o.a.warning("connect error, id:",t.id,", error:",e.message)})),d.on("connect_timeout",(function(e){o.a.warning("connect timeout, id:",t.id,", error:",e.message)})),d.on("reconnecting",(function(e){o.a.debug("reconnecting, id:",t.id,", attempet:",e)})),d.on("reconnect",(function(e){o.a.debug("reconnected, id:",t.id,", attempet:",e),t.state=t.CONNECTED,d.emit("reconnected",t.id),p()})),d.on("reconnect_attempt",(function(e){o.a.debug("reconnect attempt, id:",t.id,", attempet:",e)})),d.on("reconnect_error",(function(e){o.a.debug("error reconnecting, id:",t.id,", error:",e.message)})),d.on("reconnect_failed",(function(){o.a.warning("reconnect failed, id:",t.id),t.state=t.DISCONNECTED,u("disconnect","reconnect failed")})),r.token=e,t.sendMessage("token",r,(function(e){t.state=t.CONNECTED,t.id=e.clientId,i(e)}),a)},t.disconnect=function(){t.state=t.DISCONNECTED,d.disconnect()},t.sendMessage=function(e,r,i,a){i=void 0===i?n:i,a=void 0===a?n:a,t.state===t.DISCONNECTED&&"token"!==e?o.a.error("Trying to send a message over a disconnected Socket"):t.state===t.RECONNECTING?c.push([e,r,i,a]):d.emit(e,r,(function(e,t){"success"===e?i(t):"error"===e?a(t):i(e,t)}))},t.sendSDP=function(e,i,a,s){s=void 0===s?n:s,t.state===t.DISCONNECTED?o.a.error("Trying to send a message over a disconnected Socket"):d.emit(e,i,a,(function(e){for(var t=[],n=0;n<arguments.length;++n)t[n-0]=arguments[n];s.apply(null,[].concat(r.arrayFromIterable(t)))}))},t}},function(e,t,n){e.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,n){function i(e,t){var r;"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),t=t||{};var n=(e=a(e)).source,i=e.id,s=e.path;return s=u[i]&&s in u[i].nsps,t.forceNew||t["force new connection"]||!1===t.multiplex||s?(d("ignoring socket cache for %s",n),r=c(n,t)):(u[i]||(d("new io instance for %s",n),u[i]=c(n,t)),r=u[i]),e.query&&!t.query&&(t.query=e.query),r.socket(e.path,t)}r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(1),s=n(7),c=n(13),d=n(3)("socket.io-client");e.exports=t=i;var u=t.managers={};t.protocol=s.protocol,t.connect=i,t.Manager=n(13),t.Socket=n(39)},function(e,t,r){(function(t){var n=r(2),i=r(3)("socket.io-client:url");e.exports=function(e,r){var o=e;return r=r||t.location,null==e&&(e=r.protocol+"//"+r.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==r?r.protocol+"//"+e:"https://"+e),i("parse %s",e),o=n(e)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/",e=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host,o.id=o.protocol+"://"+e+":"+o.port,o.href=o.protocol+"://"+e+(r&&r.port===o.port?"":":"+o.port),o}}).call(t,function(){return this}())},function(e,t){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length)),e=r.exec(e||"");for(var a={},s=14;s--;)a[n[s]]=e[s]||"";return-1!=i&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t,r){(function(n){function i(){try{var e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){r="color: "+this.color,e.splice(1,0,r,"color: inherit");var n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var o=t;if("undefined"!=typeof chrome&&void 0!==chrome.storage)var a=chrome.storage.local;else e:{try{a=window.localStorage;break e}catch(e){}a=void 0}o.storage=a,t.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" "),t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(t,r(4))},function(e,t){function r(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function i(e){if(u===setTimeout)return setTimeout(e,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(p===clearTimeout)return clearTimeout(e);if((p===n||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function a(){h&&l&&(h=!1,l.length?f=l.concat(f):m=-1,f.length&&s())}function s(){if(!h){var e=i(a);h=!0;for(var t=f.length;t;){for(l=f,f=[];++m<t;)l&&l[m].run();m=-1,t=f.length}l=null,h=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function d(){}e=e.exports={};try{var u="function"==typeof setTimeout?setTimeout:r}catch(e){u=r}try{var p="function"==typeof clearTimeout?clearTimeout:n}catch(e){p=n}var l,f=[],h=!1,m=-1;e.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new c(e,t)),1!==f.length||h||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.prependListener=d,e.prependOnceListener=d,e.listeners=function(e){return[]},e.binding=function(e){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t,r){function n(e){function r(){if(r.enabled){var e=+new Date;r.diff=e-(i||e),r.prev=i,i=r.curr=e;var n=Array(arguments.length);for(e=0;e<n.length;e++)n[e]=arguments[e];n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var o=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,i){return"%%"===e?e:(o++,"function"==typeof(i=t.formatters[i])&&(e=i.call(r,n[o]),n.splice(o,1),o--),e)})),t.formatArgs.call(r,n),(r.log||t.log||console.log.bind(console)).apply(r,n)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}var i;(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&("-"===(e=r[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n=0;for(r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=r(6),t.names=[],t.skips=[],t.formatters={}},function(e,t){function r(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var n=1e3,i=60*n,o=60*i,a=24*o,s=365.25*a;e.exports=function(e,t){t=t||{};var c=typeof e;if("string"===c&&0<e.length)return function(e){if(!(100<(e=String(e)).length)&&(e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e))){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return t*s;case"days":case"day":case"d":return t*a;case"hours":case"hour":case"hrs":case"hr":case"h":return t*o;case"minutes":case"minute":case"mins":case"min":case"m":return t*i;case"seconds":case"second":case"secs":case"sec":case"s":return t*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t}}}(e);if("number"===c&&!1===isNaN(e))return t.long?r(e,a,"day")||r(e,o,"hour")||r(e,i,"minute")||r(e,n,"second")||e+" ms":e>=a?Math.round(e/a)+"d":e>=o?Math.round(e/o)+"h":e>=i?Math.round(e/i)+"m":e>=n?Math.round(e/n)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){function n(){}function i(e){var r=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data&&(r+=JSON.stringify(e.data)),c("encoded %j as %s",e,r),r}function o(){this.reconstructor=null}function a(e){this.reconPack=e,this.buffers=[]}function s(){return{type:t.ERROR,data:"parser error"}}var c=r(3)("socket.io-parser");e=r(8);var d=r(9),u=r(11),p=r(12);t.protocol=4,t.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" "),t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=n,t.Decoder=o,n.prototype.encode=function(e,r){e.type!==t.EVENT&&e.type!==t.ACK||!d(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),c("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){u.removeBlobs(e,(function(e){var r=u.deconstructPacket(e);e=i(r.packet),(r=r.buffers).unshift(e),t(r)}))}(e,r):r([e=i(e)])},e(o.prototype),o.prototype.add=function(e){if("string"==typeof e){var r,n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])e=s();else{if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(r="";"-"!==e.charAt(++n)&&(r+=e.charAt(n),n!=e.length););if(r!=Number(r)||"-"!==e.charAt(n))throw Error("Illegal attachments");i.attachments=Number(r)}if("/"===e.charAt(n+1))for(i.nsp="";++n&&","!==(r=e.charAt(n))&&(i.nsp+=r,n!==e.length););else i.nsp="/";if(""!==(r=e.charAt(n+1))&&Number(r)==r){for(i.id="";++n;){if(null==(r=e.charAt(n))||Number(r)!=r){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){e:{n=e.substr(n);try{i.data=JSON.parse(n)}catch(e){n=s();break e}n=i}i=n}c("decoded %s as %j",e,i),e=i}t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?(this.reconstructor=new a(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e)}else{if(!p(e)&&!e.base64)throw Error("Unknown type: "+e);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",e))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(e){return this.buffers.push(e),this.buffers.length===this.reconPack.attachments?(e=u.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),e):null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,r){function n(e){if(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n,i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1);if(r=this._callbacks["$"+e])for(var r,n=0,i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){(function(t){var n=r(10),i=Object.prototype.toString,o="function"==typeof t.Blob||"[object BlobConstructor]"===i.call(t.Blob),a="function"==typeof t.File||"[object FileConstructor]"===i.call(t.File);e.exports=function e(r){if(!r||"object"!=typeof r)return!1;if(n(r)){for(var i=0,s=r.length;i<s;i++)if(e(r[i]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(r)||"function"==typeof t.ArrayBuffer&&r instanceof ArrayBuffer||o&&r instanceof Blob||a&&r instanceof File)return!0;if(r.toJSON&&"function"==typeof r.toJSON&&1===arguments.length)return e(r.toJSON(),!0);for(i in r)if(Object.prototype.hasOwnProperty.call(r,i)&&e(r[i]))return!0;return!1}}).call(t,function(){return this}())},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){(function(e){var n=r(10),i=r(12),o=Object.prototype.toString,a="function"==typeof e.Blob||"[object BlobConstructor]"===o.call(e.Blob),s="function"==typeof e.File||"[object FileConstructor]"===o.call(e.File);t.deconstructPacket=function(e){var t=[];return e.data=function e(t,r){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:r.length};return r.push(t),o}if(n(t)){o=Array(t.length);for(var a=0;a<t.length;a++)o[a]=e(t[a],r);return o}if("object"==typeof t&&!(t instanceof Date)){for(a in o={},t)o[a]=e(t[a],r);return o}return t}(e.data,t),e.attachments=t.length,{packet:e,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(n(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],r);else if("object"==typeof t)for(i in t)t[i]=e(t[i],r);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var r=0,o=e;!function e(c,d,u){if(!c)return c;if(a&&c instanceof Blob||s&&c instanceof File){r++;var p=new FileReader;p.onload=function(){u?u[d]=this.result:o=this.result,--r||t(o)},p.readAsArrayBuffer(c)}else if(n(c))for(p=0;p<c.length;p++)e(c[p],p,c);else if("object"==typeof c&&!i(c))for(p in c)e(c[p],p,c)}(o),r||t(o)}}).call(t,function(){return this}())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,function(){return this}())},function(e,t,n){function i(e,t){if(!(this instanceof i))return new i(e,t);e&&"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],e=t.parser||c,this.encoder=new e.Encoder,this.decoder=new e.Decoder,(this.autoConnect=!1!==t.autoConnect)&&this.open()}r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(14),s=n(39);t=n(8);var c=n(7),d=n(41),u=n(42),p=n(3)("socket.io-client:manager"),l=n(37),f=n(43),h=Object.prototype.hasOwnProperty;e.exports=i,i.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},i.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},i.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},t(i.prototype),i.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},i.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},i.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},i.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},i.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},i.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},i.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},i.prototype.open=i.prototype.connect=function(e,t){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri);var r=this.engine=a(this.uri,this.opts),n=this;this.readyState="opening",this.skipReconnect=!1;var i=d(r,"open",(function(){n.onopen(),e&&e()}));if(t=d(r,"error",(function(t){if(p("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()})),!1!==this._timeout){var o=this._timeout;p("connect attempt will timeout after %d",o);var s=setTimeout((function(){p("connect attempt timed out after %d",o),i.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",o)}),o);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(i),this.subs.push(t),this},i.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(d(e,"data",u(this,"ondata"))),this.subs.push(d(e,"ping",u(this,"onping"))),this.subs.push(d(e,"pong",u(this,"onpong"))),this.subs.push(d(e,"error",u(this,"onerror"))),this.subs.push(d(e,"close",u(this,"onclose"))),this.subs.push(d(this.decoder,"decoded",u(this,"ondecoded")))},i.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},i.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},i.prototype.ondata=function(e){this.decoder.add(e)},i.prototype.ondecoded=function(e){this.emit("packet",e)},i.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},i.prototype.socket=function(e,t){function r(){~l(i.connecting,n)||i.connecting.push(n)}var n=this.nsps[e];if(!n){n=new s(this,e,t),this.nsps[e]=n;var i=this;n.on("connecting",r),n.on("connect",(function(){n.id=i.generateId(e)})),this.autoConnect&&r()}return n},i.prototype.destroy=function(e){~(e=l(this.connecting,e))&&this.connecting.splice(e,1),this.connecting.length||this.close()},i.prototype.packet=function(e){p("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(r){for(var n=0;n<r.length;n++)t.engine.write(r[n],e.options);t.encoding=!1,t.processPacketQueue()})))},i.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},i.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},i.prototype.close=i.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},i.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},i.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();p("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var r=setTimeout((function(){e.skipReconnect||(p("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(p("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(p("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(r)}})}},i.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,r){e.exports=r(15)},function(e,t,r){e.exports=r(16),e.exports.parser=r(23)},function(e,t,r){(function(t){function n(e,r){if(!(this instanceof n))return new n(e,r);r=r||{},e&&"object"==typeof e&&(r=e,e=null),e?(e=d(e),r.hostname=e.host,r.secure="https"===e.protocol||"wss"===e.protocol,r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=d(r.host).host),this.secure=null!=r.secure?r.secure:t.location&&"https:"===location.protocol,r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.agent=r.agent||!1,this.hostname=r.hostname||(t.location?location.hostname:"localhost"),this.port=r.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=r.query||{},"string"==typeof this.query&&(this.query=p.decode(this.query)),this.upgrade=!1!==r.upgrade,this.path=(r.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!r.forceJSONP,this.jsonp=!1!==r.jsonp,this.forceBase64=!!r.forceBase64,this.enablesXDR=!!r.enablesXDR,this.timestampParam=r.timestampParam||"t",this.timestampRequests=r.timestampRequests,this.transports=r.transports||["polling","websocket"],this.transportOptions=r.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=r.policyPort||843,this.rememberUpgrade=r.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=r.onlyBinaryUpgrades,this.perMessageDeflate=!1!==r.perMessageDeflate&&(r.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=r.pfx||null,this.key=r.key||null,this.passphrase=r.passphrase||null,this.cert=r.cert||null,this.ca=r.ca||null,this.ciphers=r.ciphers||null,this.rejectUnauthorized=void 0===r.rejectUnauthorized||r.rejectUnauthorized,this.forceNode=!!r.forceNode,(e="object"==typeof t&&t).global===e&&(r.extraHeaders&&0<Object.keys(r.extraHeaders).length&&(this.extraHeaders=r.extraHeaders),r.localAddress&&(this.localAddress=r.localAddress)),this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null,this.open()}var i=r(17),o=r(8),a=r(3)("engine.io-client:socket"),s=r(37),c=r(23),d=r(2),u=r(38),p=r(31);e.exports=n,n.priorWebsocketSuccess=!1,o(n.prototype),n.protocol=c.protocol,n.Socket=n,n.Transport=r(22),n.transports=r(17),n.parser=r(23),n.prototype.createTransport=function(e){a('creating transport "%s"',e);var t,r=this.query,n={};for(t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);return n.EIO=c.protocol,n.transport=e,r=this.transportOptions[e]||{},this.id&&(n.sid=this.id),new i[e]({query:n,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0})},n.prototype.open=function(){if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},n.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},n.prototype.probe=function(e){function t(){if(l.onlyBinaryUpgrades){var t=!this.supportsBinary&&l.transport.supportsBinary;p=p||t}p||(a('probe transport "%s" opened',e),u.send([{type:"ping",data:"probe"}]),u.once("packet",(function(t){p||("pong"===t.type&&"probe"===t.data?(a('probe transport "%s" pong',e),l.upgrading=!0,l.emit("upgrading",u),u&&(n.priorWebsocketSuccess="websocket"===u.name,a('pausing current transport "%s"',l.transport.name),l.transport.pause((function(){p||"closed"!==l.readyState&&(a("changing transport and sending upgrade packet"),d(),l.setTransport(u),u.send([{type:"upgrade"}]),l.emit("upgrade",u),u=null,l.upgrading=!1,l.flush())})))):(a('probe transport "%s" failed',e),(t=Error("probe error")).transport=u.name,l.emit("upgradeError",t)))})))}function r(){p||(p=!0,d(),u.close(),u=null)}function i(t){var n=Error("probe error: "+t);n.transport=u.name,r(),a('probe transport "%s" failed because of error: %s',e,t),l.emit("upgradeError",n)}function o(){i("transport closed")}function s(){i("socket closed")}function c(e){u&&e.name!==u.name&&(a('"%s" works - aborting "%s"',e.name,u.name),r())}function d(){u.removeListener("open",t),u.removeListener("error",i),u.removeListener("close",o),l.removeListener("close",s),l.removeListener("upgrading",c)}a('probing transport "%s"',e);var u=this.createTransport(e,{probe:1}),p=!1,l=this;n.priorWebsocketSuccess=!1,u.once("open",t),u.once("error",i),u.once("close",o),this.once("close",s),this.once("upgrading",c),u.open()},n.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},n.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(u(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},n.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},n.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},n.prototype.sendPacket=function(e,t,r,n){"function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((r=r||{}).compress=!1!==r.compress,e={type:e,data:t,options:r},this.emit("packetCreate",e),this.writeBuffer.push(e),n&&this.once("flush",n),this.flush())},n.prototype.close=function(){function e(){n.onClose("forced close"),a("socket closing - telling transport to close"),n.transport.close()}function t(){n.removeListener("upgrade",t),n.removeListener("upgradeError",t),e()}function r(){n.once("upgrade",t),n.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}return this},n.prototype.onError=function(e){a("socket error %j",e),n.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},n.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(a('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},n.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~s(this.transports,e[r])&&t.push(e[r]);return t}}).call(t,function(){return this}())},function(e,t,r){(function(e){var n=r(18),i=r(20),o=r(34),a=r(35);t.polling=function(t){var r=!1,a=!1,s=!1!==t.jsonp;if(e.location&&(a="https:"===location.protocol,(r=location.port)||(r=a?443:80),r=t.hostname!==location.hostname||r!==t.port,a=t.secure!==a),t.xdomain=r,t.xscheme=a,"open"in new n(t)&&!t.forceJSONP)return new i(t);if(!s)throw Error("JSONP disabled");return new o(t)},t.websocket=a}).call(t,function(){return this}())},function(e,t,r){(function(t){var n=r(19);e.exports=function(e){var r=e.xdomain,i=e.xscheme;e=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!r||n))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!i&&e)return new XDomainRequest}catch(e){}if(!r)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,r){(function(t){function n(){}function i(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var r="https:"===location.protocol,n=location.port;n||(n=r?443:80),this.xd=e.hostname!==t.location.hostname||n!==e.port,this.xs=e.secure!==r}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var s=r(18),c=r(21),d=r(8),u=r(32),p=r(3)("engine.io-client:polling-xhr");e.exports=i,e.exports.Request=o,u(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new o(e)},i.prototype.doWrite=function(e,t){e=this.request({method:"POST",data:e,isBinary:"string"!=typeof e&&void 0!==e});var r=this;e.on("success",t),e.on("error",(function(e){r.onError("xhr post error",e)})),this.sendXhr=e},i.prototype.doPoll=function(){p("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},d(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var r=this.xhr=new s(e),n=this;try{p("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?r.setRequestHeader("Content-type","application/octet-stream"):r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{r.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in r&&(r.withCredentials=!0),this.requestTimeout&&(r.timeout=this.requestTimeout),this.hasXDR()?(r.onload=function(){n.onLoad()},r.onerror=function(){n.onError(r.responseText)}):r.onreadystatechange=function(){if(2===r.readyState){try{var e=r.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(r.responseType="arraybuffer")}4===r.readyState&&(200===r.status||1223===r.status?n.onLoad():setTimeout((function(){n.onError(r.status)}),0))},p("xhr data %s",this.data),r.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}t.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(e){}t.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){try{try{var e=this.xhr.getResponseHeader("Content-Type")}catch(e){}var t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",a):t.addEventListener&&t.addEventListener("beforeunload",a,!1))}).call(t,function(){return this}())},function(e,t,r){function n(e){var t=e&&e.forceBase64;d&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=r(22),o=r(31),a=r(23);t=r(32);var s=r(33),c=r(3)("engine.io-client:polling");e.exports=n;var d=null!=new(r(18))({xdomain:!1}).responseType;t(n,i),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){c("paused"),r.readyState="paused",e()}var r=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--n||t()}))),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){c("pre-pause writing complete"),--n||t()})))}else t()},n.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;c("polling got data %s",e),a.decodePayload(e,this.socket.binaryType,(function(e,r,n){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function e(){c("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},n.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,r)}))},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},function(e,t,r){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=r(23);t=r(8),e.exports=n,t(n.prototype),n.prototype.onError=function(e,t){return(e=Error(e)).type="TransportError",e.description=t,this.emit("error",e),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!==this.readyState)throw Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){e=i.decodePacket(e,this.socket.binaryType),this.onPacket(e)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,r){(function(e){function n(e,t,r){var n=Array(e.length);r=c(e.length,r);for(var i=function(e,r,i){t(r,(function(t,r){n[e]=r,i(t,n)}))},o=0;o<e.length;o++)i(o,e[o],r)}var i,o=r(24),a=r(9),s=r(25),c=r(26),d=r(27);e&&e.ArrayBuffer&&(i=r(29));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),p="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||p;t.protocol=3;var f=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=o(f),m={type:"error",data:"parser error"},y=r(30);t.encodePacket=function(r,n,i,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof i&&(o=i,i=null);var a=void 0===r.data?void 0:r.data.buffer||r.data;if(e.ArrayBuffer&&a instanceof ArrayBuffer){if(n){for(i=r.data,n=new Uint8Array(i),(i=new Uint8Array(1+i.byteLength))[0]=f[r.type],r=0;r<n.length;r++)i[r+1]=n[r];r=o(i.buffer)}else r=t.encodeBase64Packet(r,o);return r}return y&&a instanceof e.Blob?(n?l?r=function(e,r,n){if(!r)return t.encodeBase64Packet(e,n);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,r,!0,n)},i.readAsArrayBuffer(e.data)}(r,n,o):((n=new Uint8Array(1))[0]=f[r.type],r=o(r=new y([n.buffer,r.data]))):r=t.encodeBase64Packet(r,o),r):a&&a.base64?o("b"+t.packets[r.type]+r.data.data):(n=f[r.type],void 0!==r.data&&(n+=i?d.encode(String(r.data),{strict:!1}):String(r.data)),o(""+n))},t.encodeBase64Packet=function(r,n){var i="b"+t.packets[r.type];if(y&&r.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(r.data)}try{var a=String.fromCharCode.apply(null,new Uint8Array(r.data))}catch(e){r=new Uint8Array(r.data),a=Array(r.length);for(var s=0;s<r.length;s++)a[s]=r[s];a=String.fromCharCode.apply(null,a)}return i+=e.btoa(a),n(i)},t.decodePacket=function(e,r,n){if(void 0===e)return m;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),r);if(r=n){r=e;try{r=d.decode(r,{strict:!1})}catch(e){r=!1}r=!1===(e=r)}return r?m:(n=e.charAt(0),Number(n)==n&&h[n]?1<e.length?{type:h[n],data:e.substring(1)}:{type:h[n]}:m)}return n=new Uint8Array(e)[0],e=s(e,1),y&&"blob"===r&&(e=new y([e])),{type:h[n],data:e}},t.decodeBase64Packet=function(e,t){var r=h[e.charAt(0)];return i?(e=i.decode(e.substr(1)),"blob"===t&&y&&(e=new y([e])),{type:r,data:e}):{type:r,data:{base64:!0,data:e.substr(1)}}},t.encodePayload=function(e,r,i){"function"==typeof r&&(i=r,r=null);var o=a(e);return r&&o?y&&!l?t.encodePayloadAsBlob(e,i):t.encodePayloadAsArrayBuffer(e,i):e.length?void n(e,(function(e,n){t.encodePacket(e,!!o&&r,!1,(function(e){n(null,e.length+":"+e)}))}),(function(e,t){return i(t.join(""))})):i("0:")},t.decodePayload=function(e,r,n){if("string"!=typeof e)return t.decodePayloadAsBinary(e,r,n);var i;if("function"==typeof r&&(n=r,r=null),""===e)return n(m,0,1);for(var o,a,s="",c=0,d=e.length;c<d;c++){var u=e.charAt(c);if(":"===u){if(""===s||s!=(o=Number(s))||s!=(a=e.substr(c+1,o)).length)return n(m,0,1);if(a.length){if(i=t.decodePacket(a,r,!1),m.type===i.type&&m.data===i.data)return n(m,0,1);if(!1===n(i,c+o,d))return}c+=o,s=""}else s+=u}return""!==s?n(m,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,r){return e.length?void n(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){return r(null,e)}))}),(function(e,t){e=t.reduce((function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2}),0);var n=new Uint8Array(e),i=0;return t.forEach((function(e){var t="string"==typeof e,r=e;if(t){r=new Uint8Array(e.length);for(var o=0;o<e.length;o++)r[o]=e.charCodeAt(o);r=r.buffer}for(n[i++]=t?0:1,e=r.byteLength.toString(),o=0;o<e.length;o++)n[i++]=parseInt(e[o]);for(n[i++]=255,r=new Uint8Array(r),o=0;o<r.length;o++)n[i++]=r[o]})),r(n.buffer)})):r(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,r){n(e,(function(e,r){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);e=n.buffer,t[0]=0}n=(e instanceof ArrayBuffer?e.byteLength:e.size).toString();var o=new Uint8Array(n.length+1);for(i=0;i<n.length;i++)o[i]=parseInt(n[i]);o[n.length]=255,y&&(e=new y([t.buffer,o.buffer,e]),r(null,e))}))}),(function(e,t){return r(new y(t))}))},t.decodePayloadAsBinary=function(e,r,n){"function"==typeof r&&(n=r,r=null);for(var i=[];0<e.byteLength;){for(var o=new Uint8Array(e),a=0===o[0],c="",d=1;255!==o[d];d++){if(310<c.length)return n(m,0,1);c+=o[d]}if(e=s(e,2+c.length),c=parseInt(c),o=s(e,0,c),a)try{o=String.fromCharCode.apply(null,new Uint8Array(o))}catch(e){for(a=new Uint8Array(o),o="",d=0;d<a.length;d++)o+=String.fromCharCode(a[d])}i.push(o),e=s(e,c)}var u=i.length;i.forEach((function(e,i){n(t.decodePacket(e,r,!0),i,u)}))}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t,r=[],n=Object.prototype.hasOwnProperty;for(t in e)n.call(e,t)&&r.push(t);return r}},function(e,t){e.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(0>t&&(t+=n),0>r&&(r+=n),r>n&&(r=n),t>=n||t>=r||0===n)return new ArrayBuffer(0);e=new Uint8Array(e),n=new Uint8Array(r-t);for(var i=0;t<r;t++,i++)n[i]=e[t];return n.buffer}},function(e,t){function r(){}e.exports=function(e,t,n){function i(e,r){if(0>=i.count)throw Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}var o=!1;return n=n||r,i.count=e,0===e?t():i}},function(e,t,r){var n;(function(e,i){!function(i){function o(e){for(var t,r,n=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&56319>=t&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function a(e,t){if(55296<=e&&57343>=e){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function s(){if(p>=u)throw Error("Invalid byte index");var e=255&d[p];if(p++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function c(e){var t,r;if(p>u)throw Error("Invalid byte index");if(p==u)return!1;if(t=255&d[p],p++,0==(128&t))return t;if(192==(224&t)){if(128<=(r=(31&t)<<6|s()))return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(r=(15&t)<<12|s()<<6|s()))return a(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(r=(7&t)<<18|s()<<12|s()<<6|s())&&1114111>=r)return r;throw Error("Invalid UTF-8 detected")}"object"==typeof e&&e&&e.exports;var d,u,p,l=String.fromCharCode,f={version:"2.1.2",encode:function(e,t){t=!1!==(t=t||{}).strict;for(var r=(e=o(e)).length,n=-1,i="";++n<r;){var s=e[n],c=t;if(0==(4294967168&s))c=l(s);else{var d="";0==(4294965248&s)?d=l(s>>6&31|192):0==(4294901760&s)?(a(s,c)||(s=65533),d=l(s>>12&15|224),d+=l(s>>6&63|128)):0==(4292870144&s)&&(d=l(s>>18&7|240),d+=l(s>>12&63|128),d+=l(s>>6&63|128)),c=d+l(63&s|128)}i+=c}return i},decode:function(e,t){var r;for(t=!1!==(t=t||{}).strict,d=o(e),u=d.length,p=0,e=[];!1!==(r=c(t));)e.push(r);r=e.length;for(var n=-1,i="";++n<r;)65535<(t=e[n])&&(i+=l((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=l(t);return i}};void 0===(n=function(){return f}.call(t,r,t,e))||(e.exports=n)}()}).call(t,r(28)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!function(){for(var e=new Uint8Array(256),r=0;64>r;r++)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(r)]=r;t.encode=function(e){var t=new Uint8Array(e),r=t.length,n="";for(e=0;e<r;e+=3)n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t[e]>>2],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&t[e])<<4|t[e+1]>>4],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&t[e+1])<<2|t[e+2]>>6],n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&t[e+2]];return 2==r%3?n=n.substring(0,n.length-1)+"=":1==r%3&&(n=n.substring(0,n.length-2)+"=="),n},t.decode=function(t){var r=.75*t.length,n=t.length,i=0;"="===t[t.length-1]&&(r--,"="===t[t.length-2]&&r--);var o=new ArrayBuffer(r),a=new Uint8Array(o);for(r=0;r<n;r+=4){var s=e[t.charCodeAt(r)],c=e[t.charCodeAt(r+1)],d=e[t.charCodeAt(r+2)],u=e[t.charCodeAt(r+3)];a[i++]=s<<2|c>>4,a[i++]=(15&c)<<4|d>>2,a[i++]=(3&d)<<6|63&u}return o}}()},function(e,t){(function(t){function r(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var i=new Uint8Array(r.byteLength);i.set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=i.buffer}e[t]=n}}}var n,i=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder;try{var o=2===new Blob(["hi"]).size}catch(e){o=!1}if(n=o)try{n=2===new Blob([new Uint8Array([1,2])]).size}catch(e){n=!1}var a=i&&i.prototype.append&&i.prototype.getBlob;e.exports=o?n?t.Blob:function(e,t){return r(e),new Blob(e,t||{})}:a?function(e,t){t=t||{};var n=new i;r(e);for(var o=0;o<e.length;o++)n.append(e[o]);return t.type?n.getBlob(t.type):n.getBlob()}:void 0}).call(t,function(){return this}())},function(e,t){t.encode=function(e){var t,r="";for(t in e)e.hasOwnProperty(t)&&(r.length&&(r+="&"),r+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return r},t.decode=function(e){for(var t={},r=0,n=(e=e.split("&")).length;r<n;r++){var i=e[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t){function r(e){var t="";do{t=o[e%a]+t,e=Math.floor(e/a)}while(0<e);return t}function n(){var e=r(+new Date);return e!==i?(c=0,i=e):e+"."+r(c++)}for(var i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,s={},c=0,d=0;d<a;d++)s[o[d]]=d;n.encode=r,n.decode=function(e){var t=0;for(d=0;d<e.length;d++)t=t*a+s[e.charAt(d)];return t},e.exports=n},function(e,t,r){(function(t){function n(){}function i(e){o.call(this,e),this.query=this.query||{},s||(t.___eio||(t.___eio=[]),s=t.___eio),this.index=s.length;var r=this;s.push((function(e){r.onData(e)})),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",(function(){r.script&&(r.script.onerror=n)}),!1)}var o=r(21),a=r(32);e.exports=i;var s,c=/\n/g,d=/\\n/g;a(i,o),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(t,r):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},i.prototype.doWrite=function(e,t){function r(){n(),t()}function n(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{i=document.createElement('<iframe src="javascript:0" name="'+o.iframeId+'">')}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var i,o=this;if(!this.form){var a=document.createElement("form"),s=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=u,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),n(),e=e.replace(d,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&r()}:this.iframe.onload=r}}).call(t,function(){return this}())},function(e,t,r){(function(t){function n(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=u&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=p),i.call(this,e)}var i=r(22),o=r(23),a=r(31),s=r(32),c=r(33),d=r(3)("engine.io-client:websocket"),u=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{var p=r(36)}catch(e){}var l=u;l||"undefined"!=typeof window||(l=p),e.exports=n,s(n,i),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new l(e,t):new l(e):new l(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},n.prototype.write=function(e){var r=this;this.writable=!1;for(var n=e.length,i=0,a=n;i<a;i++)!function(e){o.encodePacket(e,r.supportsBinary,(function(i){if(!r.usingBrowserWebSocket){var o={};e.options&&(o.compress=e.options.compress),r.perMessageDeflate&&("string"==typeof i?t.Buffer.byteLength(i):i.length)<r.perMessageDeflate.threshold&&(o.compress=!1)}try{r.usingBrowserWebSocket?r.ws.send(i):r.ws.send(i,o)}catch(e){d("websocket closed before onclose event")}--n||(r.emit("flush"),setTimeout((function(){r.writable=!0,r.emit("drain")}),0))}))}(e[i])},n.prototype.onClose=function(){i.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},n.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===n.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t){(function(t){var r=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):r.test(e.replace(n,"@").replace(i,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,n){function i(e,t,r){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(7);t=n(8);var s=n(40),c=n(41),d=n(42),u=n(3)("socket.io-client:socket"),p=n(31);e.exports=i;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=t.prototype.emit;t(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",d(this,"onopen")),c(e,"packet",d(this,"onpacket")),c(e,"close",d(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},i.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},i.prototype.emit=function(e){if(l.hasOwnProperty(e))return f.apply(this,arguments),this;var t=s(arguments),r={type:a.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},i.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},i.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===o(this.query)?p.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:a.CONNECT,query:e})}else this.packet({type:a.CONNECT})},i.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},i.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case a.CONNECT:this.onconnect();break;case a.EVENT:case a.BINARY_EVENT:this.onevent(e);break;case a.ACK:case a.BINARY_ACK:this.onack(e);break;case a.DISCONNECT:this.ondisconnect();break;case a.ERROR:this.emit("error",e.data)}},i.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},i.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var n=s(arguments);u("sending ack %j",n),t.packet({type:a.ACK,id:e,data:n})}}},i.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:a.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},i.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},function(e,t){e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&1>=e.jitter?e.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}}])},function(e,t,r){e={getRandomValue:function(){var e=new Uint16Array(1);return window.crypto.getRandomValues(e),e[0]}},t.a=e},function(e,t,r){var n=r(5),i=r(23);t.a=function(e){var t=Object(n.a)({});t.id=e.id,t.stream=e.stream.stream,t.elementID=e.elementID;return t.destroy=function(){t.video.pause(),t.parentNode.removeChild(t.div)},t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),t.div.setAttribute("class","licode_player"),t.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"),!1!==e.options.loader&&(t.loader=document.createElement("img"),t.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),t.loader.setAttribute("id","back_"+t.id),t.loader.setAttribute("class","licode_loader"),t.loader.setAttribute("src",t.url+"/assets/loader.gif")),t.video=document.createElement("video"),t.video.setAttribute("id","stream"+t.id),t.video.setAttribute("class","licode_stream"),t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: cover"),t.video.setAttribute("autoplay","autoplay"),t.video.setAttribute("playsinline","playsinline"),e.stream.local&&(t.video.setAttribute("muted","muted"),t.video.volume=0),t.container=void 0!==t.elementID?"object"==typeof t.elementID&&"function"==typeof t.elementID.appendChild?t.elementID:document.getElementById(t.elementID):document.body,t.container.appendChild(t.div),t.parentNode=t.div.parentNode,t.loader&&t.div.appendChild(t.loader),t.div.appendChild(t.video),t.containerWidth=0,t.containerHeight=0,!1!==e.options.bar?(t.bar=Object(i.a)({elementID:"player_"+t.id,id:t.id,stream:e.stream,media:t.video,options:e.options}),t.div.onmouseover=function(){t.bar.display()},t.div.onmouseout=function(){t.bar.hide()}):t.media=t.video,t.video.srcObject=t.stream,t}},function(e,t,r){var n=r(5);t.a=function(e){var t=Object(n.a)({}),r=50;if(t.elementID=e.elementID,t.media=e.media,t.id=e.id,t.stream=e.stream,t.div=document.createElement("div"),t.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;"),t.icon=document.createElement("img"),t.icon.setAttribute("id","volume_"+t.id),t.icon.setAttribute("src",t.url+"/assets/sound48.png"),t.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;"),t.div.appendChild(t.icon),t.icon.onclick=function(){t.media.muted?(t.media.muted=!1,t.icon.setAttribute("src",t.url+"/assets/sound48.png"),t.stream.local?t.stream.stream.getAudioTracks()[0].enabled=!0:(t.picker.value=r,t.media.volume=t.picker.value/100)):(t.media.muted=!0,t.icon.setAttribute("src",t.url+"/assets/mute48.png"),t.stream.local?t.stream.stream.getAudioTracks()[0].enabled=!1:(r=t.picker.value,t.picker.value=0,t.media.volume=0))},!t.stream.local){t.picker=document.createElement("input"),t.picker.setAttribute("id","picker_"+t.id),t.picker.type="range",t.picker.min=0,t.picker.max=100,t.picker.step=10,t.picker.value=r,t.picker.setAttribute("orient","vertical"),t.div.appendChild(t.picker),t.media.volume=t.picker.value/100,t.media.muted=!1,t.picker.oninput=function(){0<t.picker.value?(t.media.muted=!1,t.icon.setAttribute("src",t.url+"/assets/sound48.png")):(t.media.muted=!0,t.icon.setAttribute("src",t.url+"/assets/mute48.png")),t.media.volume=t.picker.value/100};var i=function(e){t.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+t.div.offsetHeight+"px; display: "+e)};t.div.onmouseover=function(){i("block")},t.div.onmouseout=function(){i("none")},i("none")}return document.getElementById(t.elementID).appendChild(t.div),t}},function(e,t,r){var n=r(5),i=r(23);t.a=function(e){var t=Object(n.a)({});if(t.id=e.id,t.stream=e.stream.stream,t.elementID=e.elementID,t.audio=document.createElement("audio"),t.audio.setAttribute("id","stream"+t.id),t.audio.setAttribute("class","licode_stream"),t.audio.setAttribute("style","width: 100%; height: 100%; position: absolute"),t.audio.setAttribute("autoplay","autoplay"),e.stream.local&&(t.audio.volume=0),void 0!==t.elementID){t.destroy=function(){t.audio.pause(),t.parentNode.removeChild(t.div)};t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),t.div.setAttribute("class","licode_player"),t.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),t.container="object"==typeof t.elementID&&"function"==typeof t.elementID.appendChild?t.elementID:document.getElementById(t.elementID),t.container.appendChild(t.div),t.parentNode=t.div.parentNode,t.div.appendChild(t.audio),!1!==e.options.bar?(t.bar=Object(i.a)({elementID:"player_"+t.id,id:t.id,stream:e.stream,media:t.audio,options:e.options}),t.div.onmouseover=function(){t.bar.display()},t.div.onmouseout=function(){t.bar.hide()}):t.media=t.audio}else t.destroy=function(){t.audio.pause(),t.parentNode.removeChild(t.audio)},document.body.appendChild(t.audio),t.parentNode=document.body;return t.audio.srcObject=t.stream,t}},function(e,t,r){e=function(){for(var e,t,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),n=[],i=0;i<r.length;i+=1)n[r[i]]=i;var o=function(){if(!e||t>=e.length)return-1;var r=255&e.charCodeAt(t);return t+=1,r},a=function(){if(!e)return-1;for(;;){if(t>=e.length)return-1;var r=e.charAt(t);if(t+=1,n[r])return n[r];if("A"===r)return 0}},s=function(e){return 1===(e=e.toString(16)).length&&(e="0"+e),unescape("%"+e)};return{encodeBase64:function(n){var i;e=n,t=0,n="";var a=Array(3),s=0;for(i=!1;!i&&-1!==(a[0]=o());)a[1]=o(),a[2]=o(),n+=r[a[0]>>2],-1!==a[1]?(n+=r[a[0]<<4&48|a[1]>>4],-1!==a[2]?(n+=r[a[1]<<2&60|a[2]>>6],n+=r[63&a[2]]):(n+=r[a[1]<<2&60],n+="=",i=!0)):(n+=r[a[0]<<4&48],n+="=",n+="=",i=!0),76<=(s+=4)&&(n+="\n",s=0);return n},decodeBase64:function(r){var n;e=r,t=0,r="";var i=Array(4);for(n=!1;!n&&-1!==(i[0]=a())&&-1!==(i[1]=a());)i[2]=a(),i[3]=a(),r+=s(i[0]<<2&255|i[1]>>4),-1!==i[2]?(r+=s(i[1]<<4&255|i[2]>>2),-1!==i[3]?r+=s(i[2]<<6&255|i[3]):n=!0):n=!0;return r}}}(),t.a=e},function(e,t,r){(function(t){e.exports=t.adapter=r(51)}).call(t,r(50))},function(e,t){t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,n){e.exports=function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){if(o)return o(a,!0);throw(s=Error("Cannot find module '"+a+"'")).code="MODULE_NOT_FOUND",s}s=r[a]={exports:{}},t[a][0].call(s.exports,(function(e){return i(t[a][1][e]||e)}),s,s.exports,e,t,r,n)}return r[a].exports}for(var o=!1,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){e=(0,(e=e("./adapter_factory.js")).adapterFactory)({window:window}),t.exports=e},{"./adapter_factory.js":2}],2:[function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=i.log,n=i.detectBrowser(e),u={browserDetails:n,commonShim:d,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(n.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome){r("Chrome shim is not included in this adapter release.");break}r("adapter.js shimming chrome."),u.browserShim=o,o.shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;case"firefox":if(!s||!s.shimPeerConnection||!t.shimFirefox){r("Firefox shim is not included in this adapter release.");break}r("adapter.js shimming firefox."),u.browserShim=s,s.shimGetUserMedia(e),s.shimPeerConnection(e),s.shimOnTrack(e),s.shimRemoveStream(e),s.shimSenderGetStats(e),s.shimReceiverGetStats(e),s.shimRTCDataChannel(e),s.shimAddTransceiver(e),s.shimCreateOffer(e),s.shimCreateAnswer(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"edge":if(!a||!a.shimPeerConnection||!t.shimEdge){r("MS edge shim is not included in this adapter release.");break}r("adapter.js shimming edge."),u.browserShim=a,a.shimGetUserMedia(e),a.shimGetDisplayMedia(e),a.shimPeerConnection(e),a.shimReplaceTrack(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"safari":if(!c||!t.shimSafari){r("Safari shim is not included in this adapter release.");break}r("adapter.js shimming safari."),u.browserShim=c,c.shimRTCIceServerUrls(e),c.shimCreateOfferLegacy(e),c.shimCallbacksAPI(e),c.shimLocalStreamsAPI(e),c.shimRemoteStreamsAPI(e),c.shimTrackEventTransceiver(e),c.shimGetUserMedia(e),d.shimRTCIceCandidate(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return u};var i=n(e("./utils")),o=n(e("./chrome/chrome_shim")),a=n(e("./edge/edge_shim")),s=n(e("./firefox/firefox_shim")),c=n(e("./safari/safari_shim")),d=n(e=e("./common_shim"))},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,n){function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var n=t.apply(this,arguments);return this._shimmedLocalStreams[r.id]?-1===this._shimmedLocalStreams[r.id].indexOf(n)&&this._shimmedLocalStreams[r.id].push(n):this._shimmedLocalStreams[r.id]=[r,n],n};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var n=this.getSenders();r.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===n.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(r){var n=t._shimmedLocalStreams[r].indexOf(e);-1!==n&&t._shimmedLocalStreams[r].splice(n,1),1===t._shimmedLocalStreams[r].length&&delete t._shimmedLocalStreams[r]})),i.apply(this,arguments)}}Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0,r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var c=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==(void 0===e?"undefined":a(e))||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)d.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(n){var i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.track.id})):{track:n.track},o=new Event("track");o.track=n.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)})),t.stream.getTracks().forEach((function(n){var i=e.RTCPeerConnection.prototype.getReceivers?r.getReceivers().find((function(e){return e.track&&e.track.id===n.id})):{track:n},o=new Event("track");o.track=n,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],r.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===t.kind?e.createDTMFSender(t):null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var i=r.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){r._senders.push(t(r,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var r=t._senders.find((function(t){return t.track===e}));r&&t._senders.splice(t._senders.indexOf(r),1)}))}}else if("object"===(void 0===e?"undefined":a(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,r=(i=Array.prototype.slice.call(arguments))[0],n=i[1],i=i[2];if(0<arguments.length&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach((function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return 2<=arguments.length?t.apply(this,[function(e){n(a(o(e)))},r]):new Promise((function(r,n){t.apply(e,[function(e){r(a(o(e)))},n])})).then(n,i)}}},n.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return d.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=n.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),d.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return d.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,o=void 0;return this.getSenders().forEach((function(e){e.track===t&&(r?o=!0:r=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(n?o=!0:n=e),e.track===t})),o||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=o,n.shimAddTrackRemoveTrack=function(e){function t(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){t=e._reverseStreams[t],r=r.replace(new RegExp(e._streams[t.id].id,"g"),t.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function r(e,t){var r=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){t=e._reverseStreams[t],r=r.replace(new RegExp(t.id,"g"),e._streams[t.id].id)})),new RTCSessionDescription({type:t.type,sdp:r})}if(e.RTCPeerConnection){var n=d.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&65<=n.version)return o(e);var a=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=a.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var s=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(r.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}s.apply(this,[t])};var c=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,r){var n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");return this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},(i=this._streams[r.id])?(i.addTrack(t),Promise.resolve().then((function(){n.dispatchEvent(new Event("negotiationneeded"))}))):(i=new e.MediaStream([t]),this._streams[r.id]=i,this._reverseStreams[i.id]=r,this.addStream(i)),this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(r){var n=e.RTCPeerConnection.prototype[r],o=i({},r,(function(){var e=this,r=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){n=t(e,n),r[0].apply(null,[n])},function(e){r[1]&&r[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(r){return t(e,r)}))}));e.RTCPeerConnection.prototype[r]=o[r]}));var u=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=r(this,arguments[0]),u.apply(this,arguments)):u.apply(this,arguments)};var p=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=p.get.apply(this);return""===e.type?e:t(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var r=void 0;Object.keys(this._streams).forEach((function(n){t._streams[n].getTracks().find((function(t){return e.track===t}))&&(r=t._streams[n])})),r&&(1===r.getTracks().length?this.removeStream(this._reverseStreams[r.id]):r.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}},n.shimPeerConnection=function(e){var t=d.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){53>t.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=i({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>t.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){d.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||("function"!=typeof t?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):e.navigator.mediaDevices.getDisplayMedia=function(r){return t(r).then((function(t){var n=r.video&&r.video.width,i=r.video&&r.video.height;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:r.video&&r.video.frameRate||3}},n&&(r.video.mandatory.maxWidth=n),i&&(r.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(r)}))})}},{}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var r=o.detectBrowser(e),n=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(r){if("require"!==r&&"advanced"!==r&&"mediaSource"!==r){var n="object"===i(e[r])?e[r]:{ideal:e[r]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];var a={};"number"==typeof n.ideal?(a[o("min",r)]=n.ideal,t.optional.push(a),(a={})[o("max",r)]=n.ideal):a[o("",r)]=n.ideal,t.optional.push(a)}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",r)]=n.exact):["min","max"].forEach((function(e){void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,r)]=n[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,o){if(61<=r.version)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)&&((c=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])})((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),c(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)),e&&"object"===i(e.video)){var s=(s=e.video.facingMode)&&("object"===(void 0===s?"undefined":i(s))?s:{ideal:s}),c=66>r.version;if(!(!s||"user"!==s.exact&&"environment"!==s.exact&&"user"!==s.ideal&&"environment"!==s.ideal||t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete e.video.facingMode;var d=void 0;if("environment"===s.exact||"environment"===s.ideal?d=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(d=["front"]),d)return t.mediaDevices.enumerateDevices().then((function(t){var r=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return d.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!r&&t.length&&d.includes("back")&&(r=t[t.length-1]),r&&(e.video.deviceId=s.exact?{exact:r.deviceId}:{ideal:r.deviceId}),e.video=n(e.video),a("chrome: "+JSON.stringify(e)),o(e)}))}e.video=n(e.video)}return a("chrome: "+JSON.stringify(e)),o(e)},c=function(e){return 64<=r.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,r,n){s(e,(function(e){t.webkitGetUserMedia(e,r,(function(e){n&&n(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils.js")),a=o.log},{"../utils.js":15}],6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var r=new t(e);e=o.default.parseCandidate(e.candidate);var n=Object.assign(r,e);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,a.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var r=function(e){return!(!e||!e.sdp)&&((e=o.default.splitSections(e.sdp)).shift(),e.some((function(e){return(e=o.default.parseMLine(e))&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")})))},n=function(e){return null===(e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/))||2>e.length?-1:(e=parseInt(e[1],10))!=e?-1:e},i=function(e){var r=65536;return"firefox"===t.browser&&(r=57>t.version?-1===e?16384:2147483637:60>t.version?57===t.version?65535:65536:2147483637),r},s=function(e,r){var n=65536;return"firefox"===t.browser&&57===t.version&&(n=65535),0<(e=o.default.matchPrefix(e.sdp,"a=max-message-size:")).length?n=parseInt(e[0].substr(19),10):"firefox"===t.browser&&-1!==r&&(n=2147483637),n},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&76<=t.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),r(arguments[0])){var e=n(arguments[0]),o=i(e),a=void(e=s(arguments[0],e));a=0===o&&0===e?Number.POSITIVE_INFINITY:0===o||0===e?Math.max(o,e):Math.min(o,e),o={},Object.defineProperty(o,"maxMessageSize",{get:function(){return a}}),this._sctp=o}return c.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){function t(e,t){var r=e.send;e.send=function(){var n=(n=arguments[0]).length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return r.apply(e,arguments)}}if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},a.wrapPeerConnectionEvent(e,"datachannel",(function(e){return t(e.channel,e.target),e}))}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var r=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);if(!("chrome"===t.browser&&71<=t.version)){var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),r.apply(this,arguments)}}}};var o=(t=e("sdp"))&&t.__esModule?t:{default:t},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),15025>t.version)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=(0,s.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,a.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils")),a=e("./filtericeservers"),s=(e=e("rtcpeerconnection-shim"))&&e.__esModule?e:{default:e}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&n.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){return 0!==e.indexOf("stun:")&&((e=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp"))&&!r?r=!0:e&&!r)})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator))}},{}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=(e=e&&e.navigator).mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return t(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0,r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),n.shimOnTrack=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=s.detectBrowser(e);if("object"===(void 0===e?"undefined":i(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),53>t.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var r=e.RTCPeerConnection.prototype[t],n=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=n[t]})),68>t.version){var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),r=e[1],i=e[2];return o.apply(this,[e[0]||null]).then((function(e){if(53>t.version&&!r)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,i)}}},n.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r});var r=e.RTCPeerConnection.prototype.addTrack;r&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(this,[]);return r.forEach((function(t){return t._pc=e})),r}),s.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(r){r.track&&e.getTracks().includes(r.track)&&t.removeTrack(r)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1];(n=e&&"sendEncodings"in e)&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(1<=parseFloat(e.scaleResolutionDownBy)))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(0<=parseFloat(e.maxFramerate)))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var n,i=(n=r.sender).getParameters();"encodings"in i||(i.encodings=e.sendEncodings,this.setParametersPromises.push(n.setParameters(i).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=this,r=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,r)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=this,r=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,r)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}}};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(r){return r&&r.video?(!0===r.video?r.video={mediaSource:t}:r.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(r)):((r=new DOMException("getDisplayMedia without video constraints is undefined")).name="NotFoundError",r.code=8,Promise.reject(r))})}},{}],13:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function(e){var t=o.detectBrowser(e),r=e&&e.navigator;if(e=e&&e.MediaStreamTrack,r.getUserMedia=function(e,t,n){o.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),r.mediaDevices.getUserMedia(e).then(t,n)},!(55<t.version&&"autoGainControl"in r.mediaDevices.getSupportedConstraints())){var n=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=r.mediaDevices.getUserMedia.bind(r.mediaDevices);if(r.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),n(e.audio,"autoGainControl","mozAutoGainControl"),n(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},e&&e.prototype.getSettings){var s=e.prototype.getSettings;e.prototype.getSettings=function(){var e=s.apply(this,arguments);return n(e,"mozAutoGainControl","autoGainControl"),n(e,"mozNoiseSuppression","noiseSuppression"),e}}if(e&&e.prototype.applyConstraints){var c=e.prototype.applyConstraints;e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),n(e,"autoGainControl","mozAutoGainControl"),n(e,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[e])}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,n){function i(e){return e&&void 0!==e.video?Object.assign({},e,{video:a.compactObject(e.video)}):e}Object.defineProperty(n,"__esModule",{value:!0}),r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(n){return t.call(r,n,e)})),e.getVideoTracks().forEach((function(n){return t.call(r,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var r=arguments[1];return r&&(this._localStreams?this._localStreams.includes(r)||this._localStreams.push(r):this._localStreams=[r]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach((function(e){n.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e,t.dispatchEvent(r)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(0<=e._remoteStreams.indexOf(t))){e._remoteStreams.push(t);var r=new Event("addstream");r.stream=t,e.dispatchEvent(r)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection){var t=(e=e.RTCPeerConnection.prototype).createOffer,r=e.createAnswer,n=e.setLocalDescription,i=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(e,r){var n=t.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return r?(n.then(e,r),Promise.resolve()):n},e.createAnswer=function(e,t){var n=r.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return t?(n.then(e,t),Promise.resolve()):n};var s=function(e,t,r){return e=n.apply(this,[e]),r?(e.then(t,r),Promise.resolve()):e};e.setLocalDescription=s,s=function(e,t,r){return e=i.apply(this,[e]),r?(e.then(t,r),Promise.resolve()):e},e.setRemoteDescription=s,s=function(e,t,r){return e=a.apply(this,[e]),r?(e.then(t,r),Promise.resolve()):e},e.addIceCandidate=s}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var r=(e=t.mediaDevices).getUserMedia.bind(e);t.mediaDevices.getUserMedia=function(e){return r(i(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,r,n){t.mediaDevices.getUserMedia(e).then(r,n)}.bind(t))},n.shimConstraints=i,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,r){if(e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(a.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,n.push(o)):n.push(e.iceServers[i])}e.iceServers=n}return new t(e,r)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var r=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveAudio||r||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind})),!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(e("../utils"))},{"../utils":15}],15:[function(e,t,n){function i(e,t,r){return(e=e.match(t))&&e.length>=r&&parseInt(e[r],10)}function o(e,t,r){t&&!r.has(t.id)&&(r.set(t.id,t),Object.keys(t).forEach((function(n){n.endsWith("Id")?o(e,e.get(t[n]),r):n.endsWith("Ids")&&t[n].forEach((function(t){o(e,e.get(t),r)}))})))}Object.defineProperty(n,"__esModule",{value:!0}),r.initSymbol(),r.initSymbol(),r.initSymbolIterator();var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return r.initSymbol(),r.initSymbol(),r.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.extractVersion=i,n.wrapPeerConnectionEvent=function(e,t,r){if(e.RTCPeerConnection){var n=(e=e.RTCPeerConnection.prototype).addEventListener;e.addEventListener=function(e,i){if(e!==t)return n.apply(this,arguments);var o=function(e){(e=r(e))&&i(e)};return this._eventMap=this._eventMap||{},this._eventMap[i]=o,n.apply(this,[e,o])};var i=e.removeEventListener;e.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r])return i.apply(this,arguments);var n=this._eventMap[r];return delete this._eventMap[r],i.apply(this,[e,n])},Object.defineProperty(e,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?Error("Argument type: "+(void 0===e?"undefined":a(e))+". Please use a boolean."):(s=e)?"adapter.js logging disabled":"adapter.js logging enabled"},n.disableWarnings=function(e){return"boolean"!=typeof e?Error("Argument type: "+(void 0===e?"undefined":a(e))+". Please use a boolean."):(c=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){"object"!==("undefined"==typeof window?"undefined":a(window))||s||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},n.deprecated=function(e,t){c&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};return void 0!==e&&e.navigator?(t.mozGetUserMedia?(r.browser="firefox",r.version=i(t.userAgent,/Firefox\/(\d+)\./,1)):t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer?(r.browser="chrome",r.version=i(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/)?(r.browser="edge",r.version=i(t.userAgent,/Edge\/(\d+).(\d+)$/,2)):e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)?(r.browser="safari",r.version=i(t.userAgent,/AppleWebKit\/(\d+)\./,1),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype):r.browser="Not a supported browser.",r):(r.browser="Not a browser.",r)},n.compactObject=function e(t){return"[object Object]"!==Object.prototype.toString.call(t)?t:Object.keys(t).reduce((function(r,n){var i=(o="[object Object]"===Object.prototype.toString.call(t[n]))?e(t[n]):t[n],o=o&&!Object.keys(i).length;return void 0===i||o?r:Object.assign(r,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},n,i))}),{})},n.walkStats=o,n.filterStats=function(e,t,r){var n=r?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var a=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((function(t){e.forEach((function(r){r.type===n&&r.trackId===t.id&&o(e,r,i)}))})),i};var s=!0,c=!0},{}],16:[function(e,t,r){function n(e,t,r,n,i){return t=c.writeRtpDescription(e.kind,t),t+=c.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=c.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),t+="a=mid:"+e.mid+"\r\n",t=e.rtpSender&&e.rtpReceiver?t+"a=sendrecv\r\n":e.rtpSender?t+"a=sendonly\r\n":e.rtpReceiver?t+"a=recvonly\r\n":t+"a=inactive\r\n",e.rtpSender&&(r=e.rtpSender._initialTrackId||e.rtpSender.track.id,e.rtpSender._initialTrackId=r,t=t+"a="+(n="msid:"+(n?n.id:"-")+" "+r+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+n,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+n,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+c.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+c.localCName+"\r\n"),t}function i(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},n=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]},i=function(e,t,r,i){return e=n(e.parameters.apt,r),t=n(t.parameters.apt,i),e&&t&&e.name.toLowerCase()===t.name.toLowerCase()};return e.codecs.forEach((function(n){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(n.name.toLowerCase()===a.name.toLowerCase()&&n.clockRate===a.clockRate&&("rtx"!==n.name.toLowerCase()||!n.parameters||!a.parameters.apt||i(n,a,e.codecs,t.codecs))){(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(n.numChannels,a.numChannels),r.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var n=0;n<t.headerExtensions.length;n++){var i=t.headerExtensions[n];if(e.uri===i.uri){r.headerExtensions.push(i);break}}})),r}function o(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function a(e,t){var r=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return r||e.addRemoteCandidate(t),!r}function s(e,t){return(t=Error(t)).name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}var c=e("sdp");t.exports=function(e,t){function r(t,r){r.addTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,r,n,i){var o=new Event("track");o.track=r,o.receiver=n,o.transceiver={receiver:n},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var u=function(r){var n=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){n[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._remoteDescription=this._localDescription=null,this.signalingState="stable",this.iceGatheringState=this.connectionState=this.iceConnectionState="new",r=JSON.parse(JSON.stringify(r||{})),this.usingBundle="max-bundle"===r.bundlePolicy,"negotiate"===r.rtcpMuxPolicy)throw s("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(r.rtcpMuxPolicy||(r.rtcpMuxPolicy="require"),r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all"}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced"}if(r.iceServers=function(e,t){var r=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof n;return i&&(n=[n]),n=n.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||r?0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport=udp"):r=!0})),delete e.url,e.urls=i?n[0]:n,!!n.length}}))}(r.iceServers||[],t),this._iceGatherers=[],r.iceCandidatePoolSize)for(var o=r.iceCandidatePoolSize;0<o;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}));else r.iceCandidatePoolSize=0;this._config=r,this.transceivers=[],this._sdpSessionId=c.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"!=typeof this["on"+e])||this["on"+e](t)},u.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length;return e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0},this.usingBundle&&r?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(r=this._createIceAndDtlsTransports(),e.iceTransport=r.iceTransport,e.dtlsTransport=r.dtlsTransport),t||this.transceivers.push(e),e},u.prototype.addTrack=function(t,r){if(this._isClosed)throw s("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find((function(e){return e.track===t})))throw s("InvalidAccessError","Track already exists.");for(var n,i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(n=this.transceivers[i]);return n||(n=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(r)&&this.localStreams.push(r),n.track=t,n.stream=r,n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport),n.rtpSender},u.prototype.addStream=function(e){var r=this;if(15025<=t)e.getTracks().forEach((function(t){r.addTrack(t,e)}));else{var n=e.clone();e.getTracks().forEach((function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",(function(e){r.enabled=e.enabled}))})),n.getTracks().forEach((function(e){r.addTrack(e,n)}))}},u.prototype.removeTrack=function(t){if(this._isClosed)throw s("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var r=this.transceivers.find((function(e){return e.rtpSender===t}));if(!r)throw s("InvalidAccessError","Sender was not created by this connection.");var n=r.stream;r.rtpSender.stop(),r.rtpSender=null,r.track=null,r.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(n)&&-1<this.localStreams.indexOf(n)&&this.localStreams.splice(this.localStreams.indexOf(n),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var r=t.getSenders().find((function(t){return t.track===e}));r&&t.removeTrack(r)}))},u.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},u.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},u.prototype._createIceGatherer=function(t,r){var n=this;if(r&&0<t)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;i.state=r?"completed":"gathering",null!==n.transceivers[t].bufferedCandidateEvents&&n.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},u.prototype._gather=function(t,r){var n=this,i=this.transceivers[r].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates),i.onlocalcandidate=function(e){if(!(n.usingBundle&&0<r)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:r};var a=e.candidate;(e=!a||0===Object.keys(a).length)?"new"!==i.state&&"gathering"!==i.state||(i.state="completed"):("new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment,a=c.writeCandidate(a),o.candidate=Object.assign(o.candidate,c.parseCandidate(a)),o.candidate.candidate=a,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}),(a=c.getMediaSections(n._localDescription.sdp))[o.candidate.sdpMLineIndex]=e?a[o.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":a[o.candidate.sdpMLineIndex]+"a="+o.candidate.candidate+"\r\n",n._localDescription.sdp=c.getDescription(n._localDescription.sdp)+a.join(""),a=n.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state})),"gathering"!==n.iceGatheringState&&(n.iceGatheringState="gathering",n._emitGatheringStateChange()),e||n._dispatchEvent("icecandidate",o),a&&(n._dispatchEvent("icecandidate",new Event("icecandidate")),n.iceGatheringState="complete",n._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},u.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var n=new e.RTCDtlsTransport(r);return n.ondtlsstatechange=function(){t._updateConnectionState()},n.onerror=function(){Object.defineProperty(n,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:r,dtlsTransport:n}},u.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer),(t=this.transceivers[e].iceTransport)&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport),(t=this.transceivers[e].dtlsTransport)&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)},u.prototype._transceive=function(e,r,n){var o=i(e.localCapabilities,e.remoteCapabilities);r&&e.rtpSender&&(o.encodings=e.sendEncodingParameters,o.rtcp={cname:c.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(o.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(o)),n&&e.rtpReceiver&&0<o.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&15019>t&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),o.encodings=e.recvEncodingParameters.length?e.recvEncodingParameters:[{}],o.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(o.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(o.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(o))},u.prototype.setLocalDescription=function(e){var t=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(s("TypeError",'Unsupported type "'+e.type+'"'));if(!o("setLocalDescription",e.type,t.signalingState)||t._isClosed)return Promise.reject(s("InvalidStateError","Can not set local "+e.type+" in state "+t.signalingState));if("offer"===e.type){var r=c.splitSections(e.sdp),n=r.shift();r.forEach((function(e,r){e=c.parseRtpParameters(e),t.transceivers[r].localCapabilities=e})),t.transceivers.forEach((function(e,r){t._gather(e.mid,r)}))}else if("answer"===e.type){r=c.splitSections(t._remoteDescription.sdp),n=r.shift();var a=0<c.matchPrefix(n,"a=ice-lite").length;r.forEach((function(e,r){var o=t.transceivers[r],s=o.iceGatherer,d=o.iceTransport,u=o.dtlsTransport,p=o.localCapabilities,l=o.remoteCapabilities;if(!(c.isRejected(e)&&0===c.matchPrefix(e,"a=bundle-only").length||o.rejected)){var f=c.getIceParameters(e,n);e=c.getDtlsParameters(e,n),a&&(e.role="server"),t.usingBundle&&0!==r||(t._gather(o.mid,r),"new"===d.state&&d.start(s,f,a?"controlling":"controlled"),"new"===u.state&&u.start(e)),r=i(p,l),t._transceive(o,0<r.codecs.length,!1)}}))}return t._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?t._updateSignalingState("have-local-offer"):t._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(n){var u=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(s("TypeError",'Unsupported type "'+n.type+'"'));if(!o("setRemoteDescription",n.type,u.signalingState)||u._isClosed)return Promise.reject(s("InvalidStateError","Can not set remote "+n.type+" in state "+u.signalingState));var p={};u.remoteStreams.forEach((function(e){p[e.id]=e}));var l=[],f=c.splitSections(n.sdp),h=f.shift(),m=0<c.matchPrefix(h,"a=ice-lite").length,y=0<c.matchPrefix(h,"a=group:BUNDLE ").length;u.usingBundle=y;var g=c.matchPrefix(h,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!g&&0<=g.substr(14).split(" ").indexOf("trickle"),f.forEach((function(o,s){var d=c.splitLines(o),f=c.getKind(o),g=c.isRejected(o)&&0===c.matchPrefix(o,"a=bundle-only").length,v=d[0].substr(2).split(" ")[2],E=(d=c.getDirection(o,h),c.parseMsid(o)),S=c.getMid(o)||c.generateIdentifier();if(g||"application"===f&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))u.transceivers[s]={mid:S,kind:f,protocol:v,rejected:!0};else{!g&&u.transceivers[s]&&u.transceivers[s].rejected&&(u.transceivers[s]=u._createTransceiver(f,!0));var _=c.parseRtpParameters(o);if(!g){var b=c.getIceParameters(o,h),T=c.getDtlsParameters(o,h);T.role="client"}v=c.parseRtpEncodingParameters(o);var C=c.parseRtcpParameters(o),R=0<c.matchPrefix(o,"a=end-of-candidates",h).length,A=c.matchPrefix(o,"a=candidate:").map((function(e){return c.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!g&&y&&0<s&&u.transceivers[s]&&(u._disposeIceAndDtlsTransports(s),u.transceivers[s].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[s].iceTransport=u.transceivers[0].iceTransport,u.transceivers[s].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[s].rtpSender&&u.transceivers[s].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[s].rtpReceiver&&u.transceivers[s].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==n.type||g)"answer"!==n.type||g||(P=(O=u.transceivers[s]).iceGatherer,f=O.iceTransport,S=O.dtlsTransport,I=O.rtpReceiver,g=O.sendEncodingParameters,o=O.localCapabilities,u.transceivers[s].recvEncodingParameters=v,u.transceivers[s].remoteCapabilities=_,u.transceivers[s].rtcpParameters=C,A.length&&"new"===f.state&&(!m&&!R||y&&0!==s?A.forEach((function(e){a(O.iceTransport,e)})):f.setRemoteCandidates(A)),y&&0!==s||("new"===f.state&&f.start(P,b,"controlling"),"new"===S.state&&S.start(T)),!i(O.localCapabilities,O.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&O.sendEncodingParameters[0].rtx&&delete O.sendEncodingParameters[0].rtx,u._transceive(O,"sendrecv"===d||"recvonly"===d,"sendrecv"===d||"sendonly"===d),!I||"sendrecv"!==d&&"sendonly"!==d?delete O.rtpReceiver:(d=I.track,E?(p[E.stream]||(p[E.stream]=new e.MediaStream),r(d,p[E.stream]),l.push([d,I,p[E.stream]])):(p.default||(p.default=new e.MediaStream),r(d,p.default),l.push([d,I,p.default]))));else{var O=u.transceivers[s]||u._createTransceiver(f);if(O.mid=S,O.iceGatherer||(O.iceGatherer=u._createIceGatherer(s,y)),A.length&&"new"===O.iceTransport.state&&(!R||y&&0!==s?A.forEach((function(e){a(O.iceTransport,e)})):O.iceTransport.setRemoteCandidates(A)),o=e.RTCRtpReceiver.getCapabilities(f),15019>t&&(o.codecs=o.codecs.filter((function(e){return"rtx"!==e.name}))),g=O.sendEncodingParameters||[{ssrc:1001*(2*s+2)}],b=!1,"sendrecv"===d||"sendonly"===d){b=!O.rtpReceiver;var I=O.rtpReceiver||new e.RTCRtpReceiver(O.dtlsTransport,f);if(b){if(d=I.track,!E||"-"!==E.stream)if(E){p[E.stream]||(p[E.stream]=new e.MediaStream,Object.defineProperty(p[E.stream],"id",{get:function(){return E.stream}})),Object.defineProperty(d,"id",{get:function(){return E.track}});var P=p[E.stream]}else p.default||(p.default=new e.MediaStream),P=p.default;P&&(r(d,P),O.associatedRemoteMediaStreams.push(P)),l.push([d,I,P])}}else O.rtpReceiver&&O.rtpReceiver.track&&(O.associatedRemoteMediaStreams.forEach((function(t){var r=t.getTracks().find((function(e){return e.id===O.rtpReceiver.track.id}));r&&function(t,r){r.removeTrack(t),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(r,t)})),O.associatedRemoteMediaStreams=[]);O.localCapabilities=o,O.remoteCapabilities=_,O.rtpReceiver=I,O.rtcpParameters=C,O.sendEncodingParameters=g,O.recvEncodingParameters=v,u._transceive(u.transceivers[s],!1,b)}}})),void 0===u._dtlsRole&&(u._dtlsRole="offer"===n.type?"active":"passive"),u._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(p).forEach((function(t){var r=p[t];if(r.getTracks().length){if(-1===u.remoteStreams.indexOf(r)){u.remoteStreams.push(r);var n=new Event("addstream");n.stream=r,e.setTimeout((function(){u._dispatchEvent("addstream",n)}))}l.forEach((function(e){r.id===e[2].id&&d(u,e[0],e[1],[r])}))}})),l.forEach((function(e){e[2]||d(u,e[0],e[1],[])})),e.setTimeout((function(){u&&u.transceivers&&u.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(e){this.signalingState=e,e=new Event("signalingstatechange"),this._dispatchEvent("signalingstatechange",e)},u.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},u.prototype._updateIceConnectionState=function(){var e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach((function(t){t.iceTransport&&!t.rejected&&e[t.iceTransport.state]++}));var t="new";0<e.failed?t="failed":0<e.checking?t="checking":0<e.disconnected?t="disconnected":0<e.new?t="new":0<e.connected?t="connected":0<e.completed&&(t="completed"),t!==this.iceConnectionState&&(this.iceConnectionState=t,t=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",t))},u.prototype._updateConnectionState=function(){var e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach((function(t){t.iceTransport&&t.dtlsTransport&&!t.rejected&&(e[t.iceTransport.state]++,e[t.dtlsTransport.state]++)})),e.connected+=e.completed;var t="new";0<e.failed?t="failed":0<e.connecting?t="connecting":0<e.disconnected?t="disconnected":0<e.new?t="new":0<e.connected&&(t="connected"),t!==this.connectionState&&(this.connectionState=t,t=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",t))},u.prototype.createOffer=function(r){var i=this;if(i._isClosed)return Promise.reject(s("InvalidStateError","Can not call createOffer after close"));var o=i.transceivers.filter((function(e){return"audio"===e.kind})).length,a=i.transceivers.filter((function(e){return"video"===e.kind})).length;if(r){if(r.mandatory||r.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==r.offerToReceiveAudio&&(o=!0===r.offerToReceiveAudio?1:!1===r.offerToReceiveAudio?0:r.offerToReceiveAudio),void 0!==r.offerToReceiveVideo&&(a=!0===r.offerToReceiveVideo?1:!1===r.offerToReceiveVideo?0:r.offerToReceiveVideo)}for(i.transceivers.forEach((function(e){"audio"===e.kind?0>--o&&(e.wantReceive=!1):"video"===e.kind&&0>--a&&(e.wantReceive=!1)}));0<o||0<a;)0<o&&(i._createTransceiver("audio"),o--),0<a&&(i._createTransceiver("video"),a--);var d=c.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);return i.transceivers.forEach((function(r,n){var o=r.track,a=r.kind,s=r.mid||c.generateIdentifier();r.mid=s,r.iceGatherer||(r.iceGatherer=i._createIceGatherer(n,i.usingBundle)),s=e.RTCRtpSender.getCapabilities(a),15019>t&&(s.codecs=s.codecs.filter((function(e){return"rtx"!==e.name}))),s.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),s.headerExtensions.forEach((function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))})),n=r.sendEncodingParameters||[{ssrc:1001*(2*n+1)}],o&&15019<=t&&"video"===a&&!n[0].rtx&&(n[0].rtx={ssrc:n[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,a)),r.localCapabilities=s,r.sendEncodingParameters=n})),"max-compat"!==i._config.bundlePolicy&&(d+="a=group:BUNDLE "+i.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",i.transceivers.forEach((function(e,t){d+=n(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+c.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))})),r=new e.RTCSessionDescription({type:"offer",sdp:d}),Promise.resolve(r)},u.prototype.createAnswer=function(){var r=this;if(r._isClosed)return Promise.reject(s("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==r.signalingState&&"have-local-pranswer"!==r.signalingState)return Promise.reject(s("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState));var o=c.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.usingBundle&&(o+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n";var a=c.getMediaSections(r._remoteDescription.sdp).length;r.transceivers.forEach((function(e,s){if(!(s+1>a))if(e.rejected)"application"===e.kind?o="DTLS/SCTP"===e.protocol?o+"m=application 0 DTLS/SCTP 5000\r\n":o+"m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),o+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n";else{var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&15019<=t&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1})),!(s=i(e.localCapabilities,e.remoteCapabilities)).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,o+=n(e,s,"answer",e.stream,r._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(o+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(d)},u.prototype.addIceCandidate=function(e){var t,r=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(n,i){if(!r._remoteDescription)return i(s("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<r.transceivers.length;d++)if(r.transceivers[d].mid===e.sdpMid){o=d;break}var u=r.transceivers[o];if(!u)return i(s("OperationError","Can not add ICE candidate"));if(u.rejected)return n();if("tcp"===(d=0<Object.keys(e.candidate).length?c.parseCandidate(e.candidate):{}).protocol&&(0===d.port||9===d.port)||d.component&&1!==d.component)return n();if((0===o||0<o&&u.iceTransport!==r.transceivers[0].iceTransport)&&!a(u.iceTransport,d))return i(s("OperationError","Can not add ICE candidate"));0===(i=e.candidate.trim()).indexOf("a=")&&(i=i.substr(2)),(t=c.getMediaSections(r._remoteDescription.sdp))[o]+="a="+(d.type?i:"end-of-candidates")+"\r\n",r._remoteDescription.sdp=c.getDescription(r._remoteDescription.sdp)+t.join("")}else for(o=0;o<r.transceivers.length&&(r.transceivers[o].rejected||(r.transceivers[o].iceTransport.addRemoteCandidate({}),(t=c.getMediaSections(r._remoteDescription.sdp))[o]+="a=end-of-candidates\r\n",r._remoteDescription.sdp=c.getDescription(r._remoteDescription.sdp)+t.join(""),!r.usingBundle));o++);n()}))},u.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)})),!r)throw s("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&n.push(e[t].getStats())}))})),Promise.all(n).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){if((t=e[t])&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(r){var n=e[r];e[r].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[n.type]||n.type,t.set(r,e[r])})),t}))}}}));var p=["createOffer","createAnswer"];return p.forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(p=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),u}},{sdp:17}],17:[function(e,t,r){var n={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};n.localCName=n.generateIdentifier(),n.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},n.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"}))},n.getDescription=function(e){return(e=n.splitSections(e))&&e[0]},n.getMediaSections=function(e){return(e=n.splitSections(e)).shift(),e},n.matchPrefix=function(e,t){return n.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},n.parseCandidate=function(e){for(var t={foundation:(e=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},r=8;r<e.length;r+=2)switch(e[r]){case"raddr":t.relatedAddress=e[r+1];break;case"rport":t.relatedPort=parseInt(e[r+1],10);break;case"tcptype":t.tcpType=e[r+1];break;case"ufrag":t.ufrag=e[r+1],t.usernameFragment=e[r+1];break;default:t[e[r]]=e[r+1]}return t},n.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},n.parseIceOptions=function(e){return e.substr(14).split(" ")},n.parseRtpMap=function(e){e=e.substr(9).split(" ");var t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},n.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},n.parseExtmap=function(e){return e=e.substr(9).split(" "),{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1]}},n.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},n.parseFmtp=function(e){for(var t={},r=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<r.length;n++)t[(e=r[n].trim().split("="))[0].trim()]=e[1];return t},n.writeFmtp=function(e){var t="",r=e.payloadType;if(void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var n=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return t},n.parseRtcpFb=function(e){return{type:(e=e.substr(e.indexOf(" ")+1).split(" ")).shift(),parameter:e.join(" ")}},n.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},n.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return-1<n?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},n.parseSsrcGroup=function(e){return{semantics:(e=e.substr(13).split(" ")).shift(),ssrcs:e.map((function(e){return parseInt(e,10)}))}},n.getMid=function(e){if(e=n.matchPrefix(e,"a=mid:")[0])return e.substr(6)},n.parseFingerprint=function(e){return{algorithm:(e=e.substr(14).split(" "))[0].toLowerCase(),value:e[1]}},n.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:n.matchPrefix(e+t,"a=fingerprint:").map(n.parseFingerprint)}},n.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},n.parseCryptoLine=function(e){return e=e.substr(9).split(" "),{tag:parseInt(e[0],10),cryptoSuite:e[1],keyParams:e[2],sessionParams:e.slice(3)}},n.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?n.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},n.parseCryptoKeyParams=function(e){return 0!==e.indexOf("inline:")?null:{keyMethod:"inline",keySalt:(e=e.substr(7).split("|"))[0],lifeTime:e[1],mkiValue:e[2]?e[2].split(":")[0]:void 0,mkiLength:e[2]?e[2].split(":")[1]:void 0}},n.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},n.getCryptoParameters=function(e,t){return n.matchPrefix(e+t,"a=crypto:").map(n.parseCryptoLine)},n.getIceParameters=function(e,t){var r=n.matchPrefix(e+t,"a=ice-ufrag:")[0];return e=n.matchPrefix(e+t,"a=ice-pwd:")[0],r&&e?{usernameFragment:r.substr(12),password:e.substr(10)}:null},n.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},n.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=n.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i];if(a=n.matchPrefix(e,"a=rtpmap:"+o+" ")[0]){var a=n.parseRtpMap(a),s=n.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=s.length?n.parseFmtp(s[0]):{},a.rtcpFeedback=n.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(n.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return n.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(n.parseExtmap(e))})),t},n.writeRtpDescription=function(e,t){var r=(r=(r=(r=(r=(r=(r="")+"m="+e+" ")+(0<t.codecs.length?"9":"0"))+" UDP/TLS/RTP/SAVPF ")+t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n")+"c=IN IP4 0.0.0.0\r\n")+"a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach((function(e){r+=n.writeRtpMap(e),r+=n.writeFmtp(e),r+=n.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),0<i&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){r+=n.writeExtmap(e)})),r},n.parseRtpEncodingParameters=function(e){var t,r,i=[],o=n.parseRtpParameters(e),a=-1!==o.fecMechanisms.indexOf("RED"),s=-1!==o.fecMechanisms.indexOf("ULPFEC"),c=0<(r=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))).length&&r[0].ssrc;0<(r=n.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}))).length&&1<r[0].length&&r[0][0]===c&&(t=r[0][1]),o.codecs.forEach((function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)},c&&t&&(e.rtx={ssrc:t}),i.push(e),a&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},i.push(e)))})),0===i.length&&c&&i.push({ssrc:c});var d=n.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?950*parseInt(d[0].substr(5),10)-16e3:void 0,i.forEach((function(e){e.maxBitrate=d}))),i},n.parseRtcpParameters=function(e){var t={},r=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];return r&&(t.cname=r.value,t.ssrc=r.ssrc),r=n.matchPrefix(e,"a=rtcp-rsize"),t.reducedSize=0<r.length,t.compound=0===r.length,e=n.matchPrefix(e,"a=rtcp-mux"),t.mux=0<e.length,t},n.parseMsid=function(e){var t=n.matchPrefix(e,"a=msid:");return 1===t.length?{stream:(e=t[0].substr(7).split(" "))[0],track:e[1]}:0<(e=n.matchPrefix(e,"a=ssrc:").map((function(e){return n.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}))).length?{stream:(e=e[0].value.split(" "))[0],track:e[1]}:void 0},n.parseSctpDescription=function(e){var t,r=n.parseMLine(e),i=n.matchPrefix(e,"a=max-message-size:");return 0<i.length&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536),0<(i=n.matchPrefix(e,"a=sctp-port:")).length?{port:parseInt(i[0].substr(12),10),protocol:r.fmt,maxMessageSize:t}:0<n.matchPrefix(e,"a=sctpmap:").length?(e=n.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" "),{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:t}):void 0},n.writeSctpDescription=function(e,t){return e="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&e.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),e.join("")},n.generateSessionId=function(){return Math.random().toString().substr(2,21)},n.writeSessionBoilerplate=function(e,t,r){return t=void 0!==t?t:2,"v=0\r\no="+(r||"thisisadapterortc")+" "+(e=e||n.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},n.writeMediaSection=function(e,t,r,i){return t=n.writeRtpDescription(e.kind,t),t+=n.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=n.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),t+="a=mid:"+e.mid+"\r\n",t=e.direction?t+"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?t+"a=sendrecv\r\n":e.rtpSender?t+"a=sendonly\r\n":e.rtpReceiver?t+"a=recvonly\r\n":t+"a=inactive\r\n",e.rtpSender&&(t=t+"a="+(r="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+n.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+n.localCName+"\r\n"),t},n.getDirection=function(e,t){e=n.splitLines(e);for(var r=0;r<e.length;r++)switch(e[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return e[r].substr(2)}return t?n.getDirection(t):"sendrecv"},n.getKind=function(e){return n.splitLines(e)[0].split(" ")[0].substr(2)},n.isRejected=function(e){return"0"===e.split(" ",2)[1]},n.parseMLine=function(e){return{kind:(e=n.splitLines(e)[0].substr(2).split(" "))[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},n.parseOLine=function(e){return{username:(e=n.matchPrefix(e,"o=")[0].substr(2).split(" "))[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},n.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;e=n.splitLines(e);for(var t=0;t<e.length;t++)if(2>e[t].length||"="!==e[t].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=n)},{}]},{},[1])(1)}]).default}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./sdk/polyfills.js":function(e,t,r){"use strict";r.r(t);r("./node_modules/raf/polyfill.js");"undefined"==typeof Promise&&(r("./node_modules/promise/lib/rejection-tracking.js").enable(),window.Promise=r("./node_modules/promise/lib/es6-extensions.js")),r("./node_modules/whatwg-fetch/fetch.js"),Object.assign=r("./node_modules/object-assign/index.js")},0:function(e,t,r){r("./sdk/polyfills.js"),e.exports=r("./sdk/index.js")}});
//# sourceMappingURL=sdk.js.map